<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>æ–°çŸ¥ on è¡Œè¡Œé‡è¡Œè¡Œ</title>
    <link>http://youngspring1.github.io/categories/%E6%96%B0%E7%9F%A5/</link>
    <description>Recent content in æ–°çŸ¥ on è¡Œè¡Œé‡è¡Œè¡Œ</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <copyright>Copyright (c) 2016. All rights reserved.</copyright>
    <lastBuildDate>Tue, 24 May 2016 09:18:29 +0800</lastBuildDate>
    <atom:link href="http://youngspring1.github.io/categories/%E6%96%B0%E7%9F%A5/feed/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Rè¯­è¨€ç¬”è®°07</title>
      <link>http://youngspring1.github.io/post/2016/2016-05-24-R07/</link>
      <pubDate>Tue, 24 May 2016 09:18:29 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-05-24-R07/</guid>
      <description>

&lt;p&gt;MITè¯¾ç¨‹ &lt;a href=&#34;https://courses.edx.org/courses/course-v1:MITx+15.071x_3+1T2016/info&#34;&gt;15.071x&lt;/a&gt; ç¬¬ä¸ƒå•å…ƒçš„å­¦ä¹ è®°å½•ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;visualization:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;Visualization&lt;/h2&gt;

&lt;p&gt;ç¬¬ä¸ƒå•å…ƒçš„ä¸»é¢˜æ˜¯å¯è§†åŒ–ã€‚&lt;/p&gt;

&lt;h3 id=&#34;1-ç®€ä»‹:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;1.ç®€ä»‹&lt;/h3&gt;

&lt;p&gt;plotå’Œggplot2çš„æ¯”è¾ƒ&lt;br /&gt;
plotï¼šåªæœ‰ç®€å•çš„ç‚¹å’Œçº¿ï¼Œä¸å®¹æ˜“æ·»åŠ å…¶ä»–å…ƒç´ ã€‚&lt;br /&gt;
ggplot2ï¼šå¼•å…¥å›¾å±‚ï¼Œå¾ˆå®¹æ˜“æ·»åŠ å…¶ä»–å…ƒç´ &lt;/p&gt;

&lt;h4 id=&#34;ggplot2:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;ggplot2&lt;/h4&gt;

&lt;p&gt;ggplot2ä¸‰è¦ç´ ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Data&lt;br /&gt;
æ•°æ®ï¼Œä½¿ç”¨data.frameã€‚&lt;/li&gt;
&lt;li&gt;Aesthetic mapping&lt;br /&gt;
æŒ‡å®šå¦‚ä½•å°† data.frameé‡Œçš„å˜é‡æ˜ å°„åˆ°å›¾å½¢å±æ€§ä¸Šã€‚æ¯”å¦‚ï¼Œé¢œè‰²ï¼Œå½¢çŠ¶ï¼Œæ¯”ä¾‹ï¼Œxï¼yåæ ‡ï¼Œåˆ†ç»„ç­‰ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;Geometric objects&lt;br /&gt;
å†³å®šæ•°æ®ä»¥ä»€ä¹ˆæ ·çš„å½¢å¼æ˜¾ç¤ºã€‚æ¯”å¦‚ï¼Œç‚¹ï¼Œçº¿ï¼Œç®±çº¿å›¾ï¼Œæ¡å½¢å›¾ï¼Œå¤šè¾¹å½¢ç­‰ç­‰ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ç»“åˆä¸‹é¢è¿™æ¡å‘½ä»¤ï¼Œå‚æ•°WHOå°±æ˜¯æä¾›æ•°æ®çš„data.frameï¼Œå‚æ•°aes()å°±æ˜¯Aesthetic mappingï¼Œåé¢ç”¨åŠ å·è¿ç»“çš„ç±»ä¼¼geom_point()å°±æ˜¯Geometric objectsã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# å½¢å¼
# ggplot(data = NULL, mapping = aes(), ..., environment = parent.frame())
# ä¾‹å­
ggplot(WHO, aes(x = GNI, y = FertilityRate, color = Region)) + geom_point()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ase()å³å¯ä»¥ä½œä¸ºggplot()çš„å‚æ•°ï¼Œåˆå¯ä»¥ä½œä¸ºgeom_XXXX()çš„å‚æ•°&lt;/p&gt;

&lt;h4 id=&#34;aesthetic-mapping:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;Aesthetic mapping&lt;/h4&gt;

&lt;p&gt;åæ ‡ç›¸å…³&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aes(x, y, xmin, xmax, ymin, ymax, xend, yend)
# å½“ç„¶å°±æ˜¯xï¼Œyåæ ‡åˆ†åˆ«æŒ‡å®šdata.frameçš„æŸä¸€åˆ—
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨ï¼šåæ ‡ç›¸å…³çš„ï¼Œä¸€èˆ¬ä½œä¸ºggplot()çš„å‚æ•°ï¼Œå…¶ä»–çš„éƒ½å¯ä»¥ä½œä¸ºgeom()çš„å‚æ•°ã€‚&lt;/p&gt;

&lt;h4 id=&#34;geometric-objects:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;Geometric objects&lt;/h4&gt;

&lt;p&gt;é¢œè‰²ç›¸å…³&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aes(colour, fill, alpha)
# colour é¢œè‰²
# fill   å¡«å……æŒ‡æ ‡ï¼Œdata.frameçš„æŸä¸€åˆ—ã€‚ä¹Ÿç±»ä¼¼äºåˆ†ç±»ï¼Œæ¯”å¦‚è¯¥åˆ—æœ‰ä¸¤ä¸ªå› å­ï¼Œé‚£ä¹ˆä¼šç”¨ä¸¤ç§ä¸åŒçš„é¢œè‰²å¡«å……
# alpha  é€æ˜åº¦ï¼Œ0åˆ°1ä¹‹é—´çš„å°æ•°
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åˆ†ç»„ç›¸å…³&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aes(group)
# group åˆ†ç»„æŒ‡æ ‡ï¼Œå¯ä»¥æŒ‡å®šä¸º1ï¼Œé‚£æ‰€æœ‰æ•°æ®éƒ½åœ¨1ç»„ã€‚ä¹Ÿå¯ä»¥æŒ‡å®šdata.frameçš„æŸä¸€åˆ—
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å½¢æ€ç›¸å…³&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aes(linetype, size, shape)
# linetype å³ltyï¼Œçº¿æ®µçš„ç±»å‹
# size     ç‚¹çš„å¤§å°ï¼Œçº¿çš„ç²—ç»†ã€‚æŒ‡å®šæ•´æ•°æ•°å€¼ã€‚
# shape    å›¾å½¢çš„ç±»å‹
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å›¾å½¢çš„ç±»å‹ï¼Œå³geom_point(shape = n)ä¸­nçš„å–å€¼&lt;br /&gt;
&lt;img src=&#34;http://7xrjai.com1.z0.glb.clouddn.com/20160524-shapes.png&#34; alt=&#34;shapes&#34; /&gt;&lt;/p&gt;

&lt;p&gt;çº¿æ®µçš„ç±»å‹ï¼Œå³geom_point(lty = n)ä¸­nçš„å–å€¼&lt;br /&gt;
&lt;img src=&#34;http://7xrjai.com1.z0.glb.clouddn.com/20160524-line-types.png&#34; alt=&#34;line-types&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æç»˜å½¢çŠ¶&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;geom_point()  ç‚¹
geom_line()   çº¿
geom_tile()   æ¡å½¢å›¾
geom_bar()    ç›´æ–¹å›¾
geom_ploygen()å¤šè¾¹å½¢
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨ï¼š&lt;br /&gt;
binwidth = 5 :ç²’åº¦ï¼Ÿ&lt;br /&gt;
geom_bar(stat=&amp;ldquo;identity&amp;rdquo;) :use the value of the y variable as is&lt;br /&gt;
geom_histogram(position = &amp;ldquo;identity&amp;rdquo;) :not to stack the histograms&lt;/p&gt;

&lt;h3 id=&#34;2-å®æˆ˜:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;2.å®æˆ˜&lt;/h3&gt;

&lt;h4 id=&#34;ç»˜å›¾:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;ç»˜å›¾&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# Read in data
WHO = read.csv(&amp;quot;WHO.csv&amp;quot;)
str(WHO)

# Plot from Week 1
plot(WHO$GNI, WHO$FertilityRate)

# Let&#39;s redo this using ggplot 
# Install and load the ggplot2 library:
install.packages(&amp;quot;ggplot2&amp;quot;)
library(ggplot2)

# Create the ggplot object with the data and the aesthetic mapping:
scatterplot = ggplot(WHO, aes(x = GNI, y = FertilityRate))

# Add the geom_point geometry
scatterplot + geom_point()

# Make a line graph instead:
scatterplot + geom_line()

# Switch back to our points:
scatterplot + geom_point()

# Redo the plot with blue triangles instead of circles:
scatterplot + geom_point(color = &amp;quot;blue&amp;quot;, size = 3, shape = 17) 

# Another option:
scatterplot + geom_point(color = &amp;quot;darkred&amp;quot;, size = 3, shape = 8) 

# Add a title to the plot:
scatterplot + geom_point(colour = &amp;quot;blue&amp;quot;, size = 3, shape = 17) + ggtitle(&amp;quot;Fertility Rate vs. Gross National Income&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;åˆ†ç»„:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;åˆ†ç»„&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# å› å­ï¼Œä»¥é¢œè‰²åŒºåˆ†  
# Color the points by region: 
ggplot(WHO, aes(x = GNI, y = FertilityRate, color = Region)) + geom_point()

# æ•°å€¼ï¼Œä»¥é¢œè‰²æ·±æµ…åŒºåˆ†
# Color the points according to life expectancy:
ggplot(WHO, aes(x = GNI, y = FertilityRate, color = LifeExpectancy)) + geom_point()
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;æ‹Ÿåˆ:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;æ‹Ÿåˆ&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# Is the fertility rate of a country was a good predictor of the percentage of the population under 15?
ggplot(WHO, aes(x = FertilityRate, y = Under15)) + geom_point()

# Let&#39;s try a log transformation:
ggplot(WHO, aes(x = log(FertilityRate), y = Under15)) + geom_point()

# Simple linear regression model to predict the percentage of the population under 15, using the log of the fertility rate:
mod = lm(Under15 ~ log(FertilityRate), data = WHO)
summary(mod)

# Add this regression line to our plot:
ggplot(WHO, aes(x = log(FertilityRate), y = Under15)) + geom_point() +  stat_smooth(method = &amp;quot;lm&amp;quot;)

# 99% confidence interval
ggplot(WHO, aes(x = log(FertilityRate), y = Under15)) + geom_point() + stat_smooth(method = &amp;quot;lm&amp;quot;, level = 0.99)

# No confidence interval in the plot
ggplot(WHO, aes(x = log(FertilityRate), y = Under15)) + geom_point() + stat_smooth(method = &amp;quot;lm&amp;quot;, se = FALSE)

# Change the color of the regression line:
ggplot(WHO, aes(x = log(FertilityRate), y = Under15)) + geom_point() + stat_smooth(method = &amp;quot;lm&amp;quot;, colour = &amp;quot;orange&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;çƒ­åŠ›å›¾:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;çƒ­åŠ›å›¾&lt;/h4&gt;

&lt;p&gt;çƒ­åŠ›å›¾ï¼ˆæ•°æ®è¶Šå¤šé¢œè‰²è¶Šæ·±ï¼‰çš„æ•ˆæœï¼Œä¾é scale_fill_gradient()æ¥å®ç°ï¼Œå¯ä»¥é€šè¿‡lowå’ŒhighæŒ‡å®šæ·±æµ…åŒºåŸŸçš„é¢œè‰²ï¼Œç„¶åè‡ªåŠ¨å½¢æˆæ¸å˜æ•ˆæœã€‚æ—è¾¹çš„å›¾ä¾‹é€šè¿‡å‚æ•°guide = &amp;ldquo;legend&amp;rdquo;æ¥æŒ‡å®šã€‚&lt;br /&gt;
æœ€ç»ˆçš„å‘½ä»¤å¦‚ä¸‹ï¼Œå¦‚ä½•ç”Ÿæˆæ•°æ®çš„ï¼Œå°±ä¸å•°å—¦äº†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Change the color scheme
ggplot(DayHourCounts, aes(x = Hour, y = Var1)) + geom_tile(aes(fill = Freq)) + scale_fill_gradient(name=&amp;quot;Total MV Thefts&amp;quot;, low=&amp;quot;white&amp;quot;, high=&amp;quot;red&amp;quot;) + theme(axis.title.y = element_blank())
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;åœ°ç†çƒ­åŠ›å›¾:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;åœ°ç†çƒ­åŠ›å›¾&lt;/h4&gt;

&lt;p&gt;é¡¾åæ€ä¹‰ï¼Œåœ°ç†çƒ­åŠ›å›¾å°±æ˜¯åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºçƒ­åŠ›å›¾ã€‚&lt;br /&gt;
åŒ…mapå†…ç½®äº†ç¾å›½åœ°å›¾ã€ä¸–ç•Œåœ°å›¾ã€æ³•å›½åœ°å›¾ã€æ„å¤§åˆ©åœ°å›¾ç­‰ã€‚åœ°å›¾çš„åŸç†è·Ÿå›¾ç‰‡ç±»ä¼¼ï¼Œå›¾ç‰‡å°±æ˜¯æŒ‰ç…§æŸä¸ªç²’åº¦åˆ†æˆå¾ˆå¤šä¸ªåƒç´ ç‚¹ï¼Œç„¶åä¿å­˜åƒç´ ç‚¹çš„é¢œè‰²ä¿¡æ¯ï¼›åœ°å›¾å°±æ˜¯æŒ‰ç…§ç»çº¬åº¦åˆ†æˆå¾ˆå¤šç‚¹ï¼Œä¿å­˜æ¯ä¸ªç‚¹çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚è¿™ä¸ªç‚¹ä½äºå“ªä¸ªå·ï¼Œè¿™æ ·å°±å½¢æˆä¸€ä¸ªç¾å›½åœ°å›¾ï¼‰ã€‚
å¯¹æ¯”åˆšæ‰çš„ ggplot() + geom_tile() + scale_fill_gradient()&lt;br /&gt;
æˆ‘ä»¬ç°åœ¨ä½¿ç”¨ ggmap() + geom_point() + scale_fill_gradient()&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Install and load two new packages:
install.packages(&amp;quot;maps&amp;quot;)
install.packages(&amp;quot;ggmap&amp;quot;)
library(maps)
library(ggmap)

# Load a map of Chicago into R:
chicago = get_map(location = &amp;quot;chicago&amp;quot;, zoom = 11)

# Look at the map
ggmap(chicago)

# Plot the first 100 motor vehicle thefts:
ggmap(chicago) + geom_point(data = mvt[1:100,], aes(x = Longitude, y = Latitude))

# Round our latitude and longitude to 2 digits of accuracy, and create a crime counts data frame for each area:
LatLonCounts = as.data.frame(table(round(mvt$Longitude,2), round(mvt$Latitude,2)))

str(LatLonCounts)

# Convert our Longitude and Latitude variable to numbers:
LatLonCounts$Long = as.numeric(as.character(LatLonCounts$Var1))
LatLonCounts$Lat = as.numeric(as.character(LatLonCounts$Var2))

# Plot these points on our map:
ggmap(chicago) + geom_point(data = LatLonCounts, aes(x = Long, y = Lat, color = Freq, size=Freq))

# Change the color scheme:
ggmap(chicago) + geom_point(data = LatLonCounts, aes(x = Long, y = Lat, color = Freq, size=Freq)) + scale_colour_gradient(low=&amp;quot;yellow&amp;quot;, high=&amp;quot;red&amp;quot;)

# We can also use the geom_tile geometry
ggmap(chicago) + geom_tile(data = LatLonCounts, aes(x = Long, y = Lat, alpha = Freq), fill=&amp;quot;red&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;äº‘å›¾:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;äº‘å›¾&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# å…ˆå‡†å¤‡ä¸‹æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å¾ˆå¤šå•è¯ã€‚
# è·Ÿæ–‡æœ¬å¤„ç†ç±»ä¼¼ï¼Œä¾æ—§ä½¿ç”¨tweetsæ¨æ–‡ï¼Œåªæ˜¯æˆ‘ä»¬è¿™æ¬¡ä¸æŠ½å–è¯å¹²ã€‚
library(tm)
tweets = read.csv(&amp;quot;tweets.csv&amp;quot;, stringsAsFactors=FALSE)
corpus = Corpus(VectorSource(tweets$Tweet))
corpus = tm_map(corpus, tolower)
corpus = tm_map(corpus, PlainTextDocument)
corpus = tm_map(corpus, removePunctuation)
corpus = tm_map(corpus, removeWords, stopwords(&amp;quot;english&amp;quot;))
frequencies = DocumentTermMatrix(corpus)
allTweets = as.data.frame(as.matrix(frequencies))

# æˆ‘ä»¬éœ€è¦çš„å•è¯å°±æ˜¯åˆ—å
colnames(allTweets)
# æˆ‘ä»¬éœ€è¦çš„å¦ä¸€ä¸ªæŒ‡æ ‡æ˜¯å•è¯çš„é¢‘ç‡
colSums(allTweets)

# ç°åœ¨åŠ è½½wordcloudè¿™ä¸ªåŒ…
library(wordcloud)
wordcloud(colnames(allTweets), colSums(allTweets), scale=c(2, .25))

# å‚æ•° scale æŒ‡å®šäº†æ–‡å­—çš„å¤§å°
# scale=c(2, .25) è¡¨ç¤ºå‡ºç°é¢‘ç‡æœ€é«˜çš„å•è¯ï¼Œæ˜¾ç¤ºçš„å­—å·ä¸º2ï¼Œå‡ºç°é¢‘ç‡æœ€å°çš„å•è¯ï¼Œæ˜¾ç¤ºçš„å­—å·ä¸º0.25
wordcloud(colnames(allTweets), colSums(allTweets))
# ç­‰æ•ˆäº
wordcloud(colnames(allTweets), colSums(allTweets), scale=c(4, 0.5))

# min.freq
# åªæ˜¾ç¤ºå‡ºç°é¢‘ç‡å¤§äºæŒ‡å®šå€¼çš„å•è¯

# max.words
# æœ€å¤šåªæ˜¾ç¤ºæŒ‡å®šæ•°ç›®çš„å•è¯

# random.order == FALSE
# æœ€å…ˆæ˜¾ç¤ºå‡ºç°é¢‘ç‡æœ€é«˜çš„å•è¯

# rot.per = 0.5
# æœ‰ä¸€åŠçš„å•è¯å‚ç›´æ˜¾ç¤ºã€‚é»˜è®¤å€¼æ˜¯0.1ã€‚

# random.color == TRUE
# ä½¿ç”¨éšæœºé¢œè‰²
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é¢œè‰²&lt;br /&gt;
åŒ…RColorBreweræ”¯æŒä¸‹é¢è¿™äº›è°ƒè‰²æ¿ï¼Œå¯ä»¥è¾“å…¥ display.brewer.all() çœ‹åˆ°ä¸‹é¢è¿™å¼ å›¾ã€‚&lt;br /&gt;
&lt;img src=&#34;http://7xrjai.com1.z0.glb.clouddn.com/20160606-brewer.all.png&#34; alt=&#34;brewer.all&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ibrary(RColorBrewer)
display.brewer.all()

# åƒè¿™æ ·ä½¿ç”¨
colors=brewer.pal(9, &amp;quot;Blues&amp;quot;)[5:9]
wordcloud(colnames(allTweets), colSums(allTweets), colors)
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;ä¿å­˜:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;ä¿å­˜&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# Save our plot:
fertilityGNIplot = scatterplot + geom_point(colour = &amp;quot;blue&amp;quot;, size = 3, shape = 17) + ggtitle(&amp;quot;Fertility Rate vs. Gross National Income&amp;quot;)
pdf(&amp;quot;MyPlot.pdf&amp;quot;)
print(fertilityGNIplot)
dev.off()
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;é™„å½•:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;é™„å½•&lt;/h3&gt;

&lt;h6 id=&#34;rä¸­æ˜ŸæœŸçš„æ˜¾ç¤º:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;Rä¸­æ˜ŸæœŸçš„æ˜¾ç¤º&lt;/h6&gt;

&lt;p&gt;åœ¨ä¸­æ–‡ç³»ç»Ÿä¸Šï¼Œweekdays()è¿”å›çš„ç»“æœæ˜¯ â€œæ˜ŸæœŸäºŒ æ˜ŸæœŸå…­ æ˜ŸæœŸæ—¥ æ˜ŸæœŸä¸‰ æ˜ŸæœŸå›› æ˜ŸæœŸäº” æ˜ŸæœŸä¸€â€ï¼Œå¦‚æœå¸Œæœ›è¾“å‡ºçš„ç»“æœæ˜¯â€œFriday    Monday  Saturday    Sunday  Thursday   Tuesday Wednesdayâ€ï¼Œåº”è¯¥æ€ä¹ˆåšï¼Ÿ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Convert the Date variable to a format that R will recognize:
mvt$Date = strptime(mvt$Date, format=&amp;quot;%m/%d/%y %H:%M&amp;quot;)
mvt$Weekday = weekdays(mvt$Date)

table(mvt$Weekday)
æ˜ŸæœŸäºŒ æ˜ŸæœŸå…­ æ˜ŸæœŸæ—¥ æ˜ŸæœŸä¸‰ æ˜ŸæœŸå›› æ˜ŸæœŸäº” æ˜ŸæœŸä¸€ 
26791  27118  26316  27416  27319  29284  27397 

Sys.getlocale()
&amp;quot;zh_CN.UTF-8/zh_CN.UTF-8/zh_CN.UTF-8/C/zh_CN.UTF-8/zh_CN.UTF-8&amp;quot;
Sys.setlocale(&amp;quot;LC_TIME&amp;quot;, &amp;quot;en_US.UTF-8&amp;quot;)
&amp;quot;en_US&amp;quot;
Sys.getlocale()
&amp;quot;zh_CN.UTF-8/zh_CN.UTF-8/zh_CN.UTF-8/C/en_US.UTF-8/zh_CN.UTF-8&amp;quot;

table(mvt$Weekday)
Friday    Monday  Saturday    Sunday  Thursday   Tuesday Wednesday 
29284     27397     27118     26316     27319     26791     27416
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦å¤–æ³¨æ„åˆ°ï¼Œä¸ç®¡æ˜¯ä¸­æ–‡è¿˜æ˜¯è‹±æ–‡ï¼Œéƒ½æ˜¯æŒ‰ç…§å­—æ¯è¡¨é¡ºåºæ’åˆ—çš„ï¼Œä¸æ˜¯æŒ‰ç…§å®é™…ä¸­æœ‰æ„ä¹‰çš„é¡ºåºæ’åˆ—çš„ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;WeekdayCounts = as.data.frame(table(mvt$Weekday))
WeekdayCounts$Var1 = factor(WeekdayCounts$Var1, ordered=TRUE, levels=c(&amp;quot;Sunday&amp;quot;, &amp;quot;Monday&amp;quot;, &amp;quot;Tuesday&amp;quot;, &amp;quot;Wednesday&amp;quot;, &amp;quot;Thursday&amp;quot;, &amp;quot;Friday&amp;quot;,&amp;quot;Saturday&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;

&lt;h6 id=&#34;factorè½¬æ•°å­—:8f9383a8559e56d2b013b78edf4886b3&#34;&gt;factorè½¬æ•°å­—&lt;/h6&gt;

&lt;p&gt;å…ˆæŠŠfactorè½¬æˆcharacterï¼Œå†è½¬æˆæ•°å­—&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Convert the second variable, Var2, to numbers and call it Hour:
DayHourCounts$Hour = as.numeric(as.character(DayHourCounts$Var2))
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;p&gt;å‚è€ƒï¼š&lt;br /&gt;
&lt;a href=&#34;http://www.cookbook-r.com/Graphs/Shapes_and_line_types/&#34;&gt;å½¢çŠ¶å’Œçº¿æ®µçš„ç±»å‹&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;http://www.cookbook-r.com/Graphs/Colors_(ggplot2)&#34;&gt;é¢œè‰²&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Rè¯­è¨€ç¬”è®°06</title>
      <link>http://youngspring1.github.io/post/2016/2016-05-18-R06/</link>
      <pubDate>Wed, 18 May 2016 16:40:09 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-05-18-R06/</guid>
      <description>

&lt;p&gt;MITè¯¾ç¨‹ &lt;a href=&#34;https://courses.edx.org/courses/course-v1:MITx+15.071x_3+1T2016/info&#34;&gt;15.071x&lt;/a&gt; ç¬¬å…­å•å…ƒçš„å­¦ä¹ è®°å½•ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;clustering:98d5e9e5464c079d1b4ca9841cba7675&#34;&gt;Clustering&lt;/h2&gt;

&lt;p&gt;ç¬¬å…­å•å…ƒçš„ä¸»é¢˜æ˜¯é›†ç¾¤ã€‚å®ƒç”¨æ¥æ‰¾åˆ°æ•°æ®å†…çš„ç›¸ä¼¼æ€§ã€‚&lt;/p&gt;

&lt;h3 id=&#34;1-ç†è®º:98d5e9e5464c079d1b4ca9841cba7675&#34;&gt;1.ç†è®º&lt;/h3&gt;

&lt;h4 id=&#34;recommendation-systems:98d5e9e5464c079d1b4ca9841cba7675&#34;&gt;Recommendation Systems&lt;/h4&gt;

&lt;p&gt;Collaborative filtering:&lt;br /&gt;
è¿‡æ»¤å‡ºç”¨æˆ·é—´çš„å…±åŒç‰¹å¾ï¼ç›¸ä¼¼æ€§ã€‚åªä½¿ç”¨äº†ç”¨æˆ·ä¿¡æ¯ï¼Œè·Ÿç”µå½±å†…å®¹æœ¬èº«æ— å…³ã€‚&lt;/p&gt;

&lt;p&gt;Content filtering:&lt;br /&gt;
åˆ©ç”¨ç”µå½±æœ¬èº«çš„ä¿¡æ¯ï¼Œè¿‡æ»¤å‡ºæœ‰å…±åŒå¯¼æ¼”ï¼æ¼”å‘˜ï¼ç±»åˆ«çš„ç”µå½±ã€‚è·Ÿå…¶ä»–ç”¨æˆ·æ— å…³ã€‚&lt;/p&gt;

&lt;h4 id=&#34;clustering-1:98d5e9e5464c079d1b4ca9841cba7675&#34;&gt;clustering&lt;/h4&gt;

&lt;p&gt;clustering é›†ç¾¤æ˜¯ä¸€ç§éç›‘ç£å­¦ä¹ ï¼Œ&amp;rdquo;unsupervised learning&amp;rdquo;ï¼Œå°†æœ‰å…±åŒç‰¹å¾çš„æ•°æ®åˆ†åœ¨åŒä¸€ç»„ã€‚&lt;/p&gt;

&lt;h6 id=&#34;hierarchical-clustering:98d5e9e5464c079d1b4ca9841cba7675&#34;&gt;Hierarchical clustering&lt;/h6&gt;

&lt;p&gt;Hierarchical clusteringçš„æ­¥éª¤ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;è®¡ç®—è·ç¦»&lt;/li&gt;
&lt;li&gt;ç”Ÿæˆé›†ç¾¤&lt;/li&gt;
&lt;li&gt;ç”Ÿæˆcutree&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ³¨æ„1:è®¡ç®—è·ç¦»æ—¶ï¼Œæœ‰å¯èƒ½é€ æˆå†…å­˜æº¢å‡ºã€‚è®¡ç®—æ¯ä¸¤ç‚¹é—´çš„è·ç¦»ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯n*(n-1)/2ä¸ªï¼Œæˆ‘ä»¬éœ€è¦ä¿å­˜è¿™ä¸ªç»“æœï¼Œå¦‚æœnå¾ˆå¤§ï¼Œä¿å­˜ç»“æœçš„çŸ©é˜µä¹Ÿå¾ˆå¤§ï¼Œå¯èƒ½ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚&lt;br /&gt;
æ³¨æ„2:è®¡ç®—è·ç¦»çš„ä¸‰ç§æ–¹æ³•ï¼š&lt;br /&gt;
Euclidean distanceï¼šç‚¹ä¸ç‚¹ä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦»&lt;br /&gt;
Manhattan Distanceï¼šç»å¯¹å€¼ä¹‹å’Œ&lt;br /&gt;
Maximum Coordinateï¼šåç¦»æœ€ä¸¥é‡çš„ç‚¹&lt;/p&gt;

&lt;h6 id=&#34;k-means-clustering:98d5e9e5464c079d1b4ca9841cba7675&#34;&gt;K-means clustering&lt;/h6&gt;

&lt;p&gt;K-means clusteringçš„æ­¥éª¤ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æŒ‡å®šé›†ç¾¤æ•°ç›®k&lt;/li&gt;
&lt;li&gt;éšæœºåˆ†é…æ‰€æœ‰çš„ç‚¹&lt;/li&gt;
&lt;li&gt;è®¡ç®—æ¯ä¸ªé›†ç¾¤çš„ä¸­å¿ƒç‚¹&lt;/li&gt;
&lt;li&gt;è®¡ç®—æ¯ä¸ªç‚¹åˆ°è¿™äº›ä¸­å¿ƒç‚¹çš„è·ç¦»ï¼Œé€‰æ‹©æœ€è¿‘çš„ï¼Œé‡æ–°åˆ†é…ç‚¹åˆ°ç¦»ä»–æœ€è¿‘çš„é›†ç¾¤&lt;/li&gt;
&lt;li&gt;é‡æ–°è®¡ç®—æ¯ä¸ªé›†ç¾¤çš„ä¸­å¿ƒç‚¹&lt;/li&gt;
&lt;li&gt;é‡å¤4å’Œ5å¤šæ¬¡ï¼Œç›´åˆ°æ²¡æœ‰æå‡&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ³¨æ„ï¼šcentroid distance é›†ç¾¤ä¸­æ‰€æœ‰ç‚¹çš„å¹³å‡å€¼é—´çš„è·ç¦»ã€‚&lt;/p&gt;

&lt;h4 id=&#34;normalize:98d5e9e5464c079d1b4ca9841cba7675&#34;&gt;normalize&lt;/h4&gt;

&lt;p&gt;å¦‚æœä¸åŒåˆ—çš„æ•°å€¼ä¸æ˜¯åŒæ ·çš„æ•°é‡çº§ï¼Œé‚£ä¹ˆè¿ç®—åè¾ƒå°çš„å€¼å¯èƒ½ä¼šè¢«å¿½ç•¥ï¼Œæ‰€ä»¥éœ€è¦è°ƒæ•´åˆ°åŒæ ·çš„æ•°é‡çº§ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(caret)
preproc = preProcess(airlines)
airlinesNorm = predict(preproc, airlines)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ•ˆæœå°±æ˜¯ï¼Œæ‰€æœ‰åˆ—çš„å¹³å‡å€¼éƒ½æ˜¯0ã€‚&lt;/p&gt;

&lt;h3 id=&#34;2-å»ºæ¨¡å’Œè¯„ä¼°:98d5e9e5464c079d1b4ca9841cba7675&#34;&gt;2.å»ºæ¨¡å’Œè¯„ä¼°&lt;/h3&gt;

&lt;h4 id=&#34;hierarchical-clustering-1:98d5e9e5464c079d1b4ca9841cba7675&#34;&gt;Hierarchical clustering&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# After following the steps in the video, load the data into R
movies = read.table(&amp;quot;movieLens.txt&amp;quot;, header=FALSE, sep=&amp;quot;|&amp;quot;,quote=&amp;quot;\&amp;quot;&amp;quot;)
# Add column names
colnames(movies) = c(&amp;quot;ID&amp;quot;, &amp;quot;Title&amp;quot;, &amp;quot;ReleaseDate&amp;quot;, &amp;quot;VideoReleaseDate&amp;quot;, &amp;quot;IMDB&amp;quot;, &amp;quot;Unknown&amp;quot;, &amp;quot;Action&amp;quot;, &amp;quot;Adventure&amp;quot;, &amp;quot;Animation&amp;quot;, &amp;quot;Childrens&amp;quot;, &amp;quot;Comedy&amp;quot;, &amp;quot;Crime&amp;quot;, &amp;quot;Documentary&amp;quot;, &amp;quot;Drama&amp;quot;, &amp;quot;Fantasy&amp;quot;, &amp;quot;FilmNoir&amp;quot;, &amp;quot;Horror&amp;quot;, &amp;quot;Musical&amp;quot;, &amp;quot;Mystery&amp;quot;, &amp;quot;Romance&amp;quot;, &amp;quot;SciFi&amp;quot;, &amp;quot;Thriller&amp;quot;, &amp;quot;War&amp;quot;, &amp;quot;Western&amp;quot;)
# Remove unnecessary variables
movies$ID = NULL
movies$ReleaseDate = NULL
movies$VideoReleaseDate = NULL
movies$IMDB = NULL
# Remove duplicates
movies = unique(movies)

# Compute distances
distances = dist(movies[2:20], method = &amp;quot;euclidean&amp;quot;)

# Hierarchical clustering
# clusterMovies = hclust(distances, method = &amp;quot;ward&amp;quot;) 
clusterMovies = hclust(distances, method = &amp;quot;ward.D&amp;quot;)

# Plot the dendrogram
plot(clusterMovies)

# Assign points to clusters
clusterGroups = cutree(clusterMovies, k = 10)
# Create a new data set with just the movies from cluster 2
cluster2 = subset(movies, clusterGroups==2)
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;k-means-clustering-1:98d5e9e5464c079d1b4ca9841cba7675&#34;&gt;K-means clustering&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;healthy = read.csv(&amp;quot;healthy.csv&amp;quot;, header=FALSE)
# æ³¨æ„
# data.frame-&amp;gt;matrix-&amp;gt;vector å˜æˆä¸€ä¸ª2500çš„vector
# data.frame-&amp;gt;vector è¿˜æ˜¯ä¸€ä¸ª50*50çš„data.frame
healthyMatrix = as.matrix(healthy)
healthyVector = as.vector(healthyMatrix)

# Specify number of clusters
k = 5
# Run k-means
set.seed(1)
KMC = kmeans(healthyVector, centers = k, iter.max = 1000)

# Extract clusters
healthyClusters = KMC$cluster

# Plot the image with the clusters
dim(healthyClusters) = c(nrow(healthyMatrix), ncol(healthyMatrix))

image(healthyClusters, axes = FALSE, col=rainbow(k))

# Apply to a test image
tumor = read.csv(&amp;quot;tumor.csv&amp;quot;, header=FALSE)
tumorMatrix = as.matrix(tumor)
tumorVector = as.vector(tumorMatrix)

# Apply clusters from before to new image, using the flexclust package
# kcca K-Centroids Cluster Analysis
install.packages(&amp;quot;flexclust&amp;quot;)
library(flexclust)
KMC.kcca = as.kcca(KMC, healthyVector)
tumorClusters = predict(KMC.kcca, newdata = tumorVector)

# Visualize the clusters
dim(tumorClusters) = c(nrow(tumorMatrix), ncol(tumorMatrix))
image(tumorClusters, axes = FALSE, col=rainbow(k))
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Rè¯­è¨€ç¬”è®°05</title>
      <link>http://youngspring1.github.io/post/2016/2016-05-10-R05/</link>
      <pubDate>Sat, 14 May 2016 23:19:28 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-05-10-R05/</guid>
      <description>

&lt;p&gt;MITè¯¾ç¨‹ &lt;a href=&#34;https://courses.edx.org/courses/course-v1:MITx+15.071x_3+1T2016/info&#34;&gt;15.071x&lt;/a&gt; ç¬¬äº”å•å…ƒçš„å­¦ä¹ è®°å½•ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;text-analytics:d5c69e163a15a2e5f9829d2828e73190&#34;&gt;Text Analytics&lt;/h2&gt;

&lt;p&gt;ç¬¬äº”å•å…ƒçš„ä¸»é¢˜æ˜¯æ–‡æœ¬åˆ†æã€‚&lt;/p&gt;

&lt;h3 id=&#34;1-ç†è®º:d5c69e163a15a2e5f9829d2828e73190&#34;&gt;1.ç†è®º&lt;/h3&gt;

&lt;h4 id=&#34;bag-of-words:d5c69e163a15a2e5f9829d2828e73190&#34;&gt;Bag of Words&lt;/h4&gt;

&lt;p&gt;ä¸€æ®µæ–‡æœ¬ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å¤šä¸ªå•è¯çš„é›†åˆã€‚&lt;br /&gt;
ç»Ÿè®¡è¿™äº›å•è¯çš„ç‰¹å¾ï¼Œå¯ä»¥å½’çº³æ–‡æœ¬çš„å€¾å‘ã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ–‡æœ¬è¿›è¡Œä¸‹é¢è¿™å‡ æ­¥é¢„å¤„ç†ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;clean up irregularities(ç»Ÿä¸€å¤§å°å†™)&lt;/li&gt;
&lt;li&gt;remove punctuations(å»æ‰æ ‡ç‚¹æˆ–è€…ç‰¹æ®Šç¬¦å·)&lt;/li&gt;
&lt;li&gt;remove stop words(å»æ‰theï¼whoï¼isï¼doè¿™äº›å•è¯)&lt;/li&gt;
&lt;li&gt;stemming(è·å–è¯å¹²ï¼Œä¹Ÿå°±æ˜¯å»é™¤åŠ¨è¯å˜å½¢ï¼Œæ¯”å¦‚agruedï¼Œagruesï¼Œagruingï¼Œéƒ½å˜æˆagru)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬ç»Ÿè®¡æ–‡æœ¬ä¸­å‰©ä¸‹è¿™äº›å•è¯çš„å‡ºç°æ¬¡æ•°ï¼Œç”Ÿæˆä¸€ä¸ªçŸ©é˜µï¼Œç±»ä¼¼è¿™æ ·çš„æ ¼å¼ï¼š&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;text num&lt;/th&gt;
&lt;th&gt;word1&lt;/th&gt;
&lt;th&gt;word2&lt;/th&gt;
&lt;th&gt;word3&lt;/th&gt;
&lt;th&gt;&amp;hellip;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;text1&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;&amp;hellip;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;text2&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;&amp;hellip;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&amp;hellip;&lt;/td&gt;
&lt;td&gt;&amp;hellip;&lt;/td&gt;
&lt;td&gt;&amp;hellip;&lt;/td&gt;
&lt;td&gt;&amp;hellip;&lt;/td&gt;
&lt;td&gt;&amp;hellip;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;åœ¨å®é™…ä¸­ï¼Œç”Ÿæˆçš„çŸ©é˜µæ˜¯ä¸ªç¨€ç–çŸ©é˜µï¼ˆæœ‰å¾ˆå¤š0ï¼‰ï¼Œæˆ‘ä»¬åªé€‰å–å‡ºç°æ¬¡æ•°æ¯”è¾ƒå¤šçš„ï¼Œå¿½ç•¥é‚£äº›ä¸å¸¸è§çš„å•è¯ã€‚&lt;br /&gt;
æ¯”å¦‚é€‰å–è‡³å°‘å‡ºç°è¿‡20æ¬¡çš„å•è¯ï¼Œå…¶ä»–çš„å¿½ç•¥ã€‚&lt;br /&gt;
è¿™æ ·çš„çŸ©é˜µï¼Œæ¯åˆ—çš„åˆ—åå°±æ˜¯è‡ªå˜é‡ï¼ŒçŸ©é˜µçš„å€¼å°±ç”¨åšè‡ªå˜é‡çš„å–å€¼ã€‚&lt;/p&gt;

&lt;p&gt;æœ€åï¼Œæ‰‹åŠ¨æ·»åŠ ä¸€åˆ—ï¼Œä½œä¸ºå› å˜é‡ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®è¿™äº›å•è¯çš„å‡ºç°æ¬¡æ•°ï¼Œé¢„æµ‹å› å˜é‡çš„å–å€¼äº†ã€‚&lt;br /&gt;
æ‰€ä»¥ï¼Œè¿™ä¸€åˆ—å› å˜é‡çš„æ•°å€¼å¦‚ä½•å®šä¹‰ï¼Œå®ƒçš„å®é™…æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Œå…¶å®æ˜¯æ¯”è¾ƒå¤æ‚çš„ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨è¯¾ç¨‹çš„ä¾‹å­ä¸­ï¼Œå®ƒå®šä¹‰äº†&amp;rdquo;å¥½æ„Ÿåº¦&amp;rdquo;ï¼Œå¹¶ä¸”åªæœ‰ä¸‹é¢äº”ç§å–å€¼ï¼Œ{-2,-1,0,1,2}ï¼Œæœ€ç»ˆè¦å»ºç«‹æ¨¡å‹é¢„æµ‹å“ªäº›æ–‡æœ¬æš—ç¤ºå‘æ¨çš„äººå¯¹è‹¹æœå…¬å¸å¾ˆæ²¡æœ‰å¥½æ„Ÿï¼ˆå¥½æ„Ÿåº¦æ˜¯ï¼2ï¼‰ã€‚æœ€ç»ˆå‘ç°ï¼Œæ–‡æœ¬ä¸­å«æœ‰&amp;rdquo;hate&amp;rdquo;,&amp;ldquo;wtf&amp;rdquo;çš„æƒ…å†µï¼Œæ¨ä¸»å¯¹è‹¹æœå…¬å¸å¾ˆæ²¡æœ‰å¥½æ„Ÿã€‚ğŸ˜„&lt;/p&gt;

&lt;h4 id=&#34;ibm-watson:d5c69e163a15a2e5f9829d2828e73190&#34;&gt;IBM Watson&lt;/h4&gt;

&lt;p&gt;Watsonçš„å·¥ä½œæ­¥éª¤æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Find LAT&lt;br /&gt;
é¦–å…ˆå¾—ææ˜ç™½é—®é¢˜æ˜¯ä»€ä¹ˆï¼Œä¹Ÿå°±æ˜¯è¦æ‰¾åˆ°é—®é¢˜çš„LAT(Lexial Answer Type)ã€‚
é—®é¢˜&amp;rdquo;Mozart&amp;rsquo;s last and perhaps most powerful symphony shares its name with this planet.&amp;ldquo;çš„LATæ˜¯&amp;rdquo;this planet&amp;rdquo;ï¼Œå› ä¸ºæŠŠç­”æ¡ˆ&amp;rdquo;Jupiter&amp;rdquo;æ›¿æ¢è¿›åŸæ¥çš„å¥å­ï¼Œ
&amp;ldquo;Mozart&amp;rsquo;s last and perhaps most powerful symphony shares its name with Jupiter&amp;rdquo;
ä»ç„¶æ˜¯è¯´å¾—é€šçš„ã€‚&lt;/li&gt;
&lt;li&gt;Generate Hypothesis&lt;br /&gt;
åœ¨æ•°æ®åº“ä¸­æœç´¢ä¸Šç™¾ä¸ªå€™é€‰ç­”æ¡ˆï¼Œæ›¿æ¢æ‰LATï¼Œç”Ÿæˆå¾ˆå¤šå‡è¯´ã€‚&lt;/li&gt;
&lt;li&gt;Score Hypothesis&lt;br /&gt;
å¯¹æ¯ä¸ªå‡è¯´ï¼Œè¿›è¡Œæ–‡æœ¬æœç´¢ï¼Œå¯ä»¥å°†æœç´¢çš„åˆ°çš„ç»“æœæ•°ç›®ä½œä¸ºè¯„åˆ†ã€‚&lt;/li&gt;
&lt;li&gt;Rank Hypothesis&lt;br /&gt;
å¯¹è¯„åˆ†è¿›è¡Œæ’åºï¼Œé€‰å–è¯„åˆ†æœ€é«˜çš„é‚£ä¸ªä½œä¸ºç­”æ¡ˆã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;2-å»ºæ¨¡å’Œè¯„ä¼°:d5c69e163a15a2e5f9829d2828e73190&#34;&gt;2.å»ºæ¨¡å’Œè¯„ä¼°&lt;/h3&gt;

&lt;p&gt;é¢„å¤„ç†&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Read in the data
# ä¸è¦æŠŠæ–‡æœ¬è½¬åŒ–ä¸ºå› å­
tweets = read.csv(&amp;quot;tweets.csv&amp;quot;, stringsAsFactors=FALSE)

# Create dependent variable
tweets$Negative = as.factor(tweets$Avg &amp;lt;= -1)

# Install new packages
install.packages(&amp;quot;tm&amp;quot;)
library(tm)
install.packages(&amp;quot;SnowballC&amp;quot;)
library(SnowballC)

# Create corpus
corpus = Corpus(VectorSource(tweets$Tweet))

# Convert to lower-case
corpus = tm_map(corpus, tolower)
corpus = tm_map(corpus, PlainTextDocument)

# Remove punctuation
corpus = tm_map(corpus, removePunctuation)

# Remove stopwords and apple
corpus = tm_map(corpus, removeWords, c(&amp;quot;apple&amp;quot;, stopwords(&amp;quot;english&amp;quot;)))

# Stem document 
corpus = tm_map(corpus, stemDocument)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç»Ÿè®¡ï¼Œç”Ÿæˆå•è¯å‡ºç°æ¬¡æ•°çš„çŸ©é˜µ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Create matrix
frequencies = DocumentTermMatrix(corpus)

# Look at matrix 
inspect(frequencies[1000:1005,505:515])

# Check for sparsity
# æ‰¾å‡ºå‡ºç°æ¬¡æ•°è‡³å°‘æœ‰20æ¬¡çš„å•è¯
findFreqTerms(frequencies, lowfreq=20)

# å¿½ç•¥99.5%çš„ç¨€ç–æ•°æ®ï¼Œåªé€‰å–0.5%ä½œä¸ºæœ‰æ•ˆæ•°æ®
# Remove sparse terms 
sparse = removeSparseTerms(frequencies, 0.995)

# Convert to a data frame
tweetsSparse = as.data.frame(as.matrix(sparse))
# Make all variable names R-friendly
colnames(tweetsSparse) = make.names(colnames(tweetsSparse))

# Add dependent variable
tweetsSparse$Negative = tweets$Negative
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å»ºæ¨¡å’Œè¯„ä¼°&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Split the data
library(caTools)
set.seed(123)
split = sample.split(tweetsSparse$Negative, SplitRatio = 0.7)
trainSparse = subset(tweetsSparse, split==TRUE)
testSparse = subset(tweetsSparse, split==FALSE)

# Build a CART model
library(rpart)
library(rpart.plot)
tweetCART = rpart(Negative ~ ., data=trainSparse, method=&amp;quot;class&amp;quot;)
# Evaluate the performance of the model
predictCART = predict(tweetCART, newdata=testSparse, type=&amp;quot;class&amp;quot;)
table(testSparse$Negative, predictCART)


# Random forest model
library(randomForest)
set.seed(123)
tweetRF = randomForest(Negative ~ ., data=trainSparse)
# Make predictions:
predictRF = predict(tweetRF, newdata=testSparse)
table(testSparse$Negative, predictRF)
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Rè¯­è¨€ç¬”è®°04</title>
      <link>http://youngspring1.github.io/post/2016/2016-05-10-R04/</link>
      <pubDate>Tue, 10 May 2016 19:44:08 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-05-10-R04/</guid>
      <description>

&lt;p&gt;MITè¯¾ç¨‹ &lt;a href=&#34;https://courses.edx.org/courses/course-v1:MITx+15.071x_3+1T2016/info&#34;&gt;15.071x&lt;/a&gt; ç¬¬å››å•å…ƒçš„å­¦ä¹ è®°å½•ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;trees:0257109cd77173fde404dfe977de0c33&#34;&gt;Trees&lt;/h2&gt;

&lt;p&gt;ç¬¬å››å•å…ƒçš„ä¸»é¢˜æ˜¯å†³ç­–æ ‘ã€‚&lt;/p&gt;

&lt;h3 id=&#34;1-ç†è®º:0257109cd77173fde404dfe977de0c33&#34;&gt;1.ç†è®º&lt;/h3&gt;

&lt;h4 id=&#34;cart-classification-and-regression-trees:0257109cd77173fde404dfe977de0c33&#34;&gt;CART(classification and regression trees)&lt;/h4&gt;

&lt;h6 id=&#34;å†³ç­–æ ‘:0257109cd77173fde404dfe977de0c33&#34;&gt;å†³ç­–æ ‘&lt;/h6&gt;

&lt;p&gt;è‡ªå˜é‡æ˜¯å†³ç­–æ ‘ä¸Šçš„èŠ‚ç‚¹(splits)ã€‚ä½†æ˜¯æ³¨æ„ï¼Œä¸æ˜¯æ¯ä¸ªè‡ªå˜é‡éƒ½æœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰çš„è‡ªå˜é‡æœ‰å¤šä¸ªèŠ‚ç‚¹(éšç€å–å€¼çš„ä¸åŒï¼Œå¯¼è‡´å› å˜é‡çš„ç»“æœä¹Ÿä¸åŒ)ï¼Œæœ‰çš„è‡ªå˜é‡æ²¡æœ‰èŠ‚ç‚¹(å¯¹å› å˜é‡å½±å“å¾ˆå°)ã€‚&lt;br /&gt;
å› å˜é‡æ˜¯å†³ç­–æ ‘ä¸Šçš„å¶å­/ç»ˆç«¯(leaves/nodes)ã€‚æ­¤å›¾ä¸Šçš„å› å˜é‡çš„å–å€¼æ˜¯0æˆ–è€…1ã€‚&lt;br /&gt;
åœ¨å„ä¸ªèŠ‚ç‚¹ï¼Œæ ¹æ®å„ä¸ªè‡ªå˜é‡çš„å–å€¼ï¼Œæœ€ç»ˆåˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œä¹Ÿå°±å¾—åˆ°äº†å› å˜é‡çš„å–å€¼ã€‚&lt;br /&gt;
æ³¨æ„ï¼Œå†³ç­–æ ‘çš„å·¦è¾¹ï¼ŒèŠ‚ç‚¹çš„åˆ¤æ–­è¯­å¥æ€»æ˜¯ä¸ºTrueï¼Yesï¼Œå³è¾¹èŠ‚ç‚¹çš„åˆ¤æ–­è¯­å¥æ€»æ˜¯ä¸ºFalseï¼Noã€‚&lt;br /&gt;
&lt;img src=&#34;http://7xrjai.com1.z0.glb.clouddn.com/20160517-tree-Rplot.png&#34; alt=&#34;tree&#34; /&gt;&lt;br /&gt;
æœ€å·¦çš„åˆ†æ”¯è¡¨ç¤ºï¼Œå¦‚æœ LowerCou=lbr ä¸” Responde=CRI ä¸” Petition=CITï¼Œé‚£ä¹ˆå› å˜é‡çš„å–å€¼ä¸º0ã€‚&lt;br /&gt;
æœ€å³çš„åˆ†æ”¯è¡¨ç¤ºï¼Œå¦‚æœ LowerCou!=lbr ä¸” Responde=STAï¼Œé‚£ä¹ˆå› å˜é‡çš„å–å€¼ä¸º1ã€‚&lt;/p&gt;

&lt;h6 id=&#34;å†³ç­–æ ‘çš„å¤§å°:0257109cd77173fde404dfe977de0c33&#34;&gt;å†³ç­–æ ‘çš„å¤§å°&lt;/h6&gt;

&lt;p&gt;minbucketå¯ä»¥ç†è§£ä¸ºï¼Œå†³ç­–æ ‘è¢«èŠ‚ç‚¹åˆ†å‰²åï¼Œæ¯ä¸ªbucketæ•°æ®çš„æ•°é‡ã€‚&lt;br /&gt;
minbucketè¶Šå¤§ï¼Œåˆ†ç»„è¶Šå°‘ï¼Œsplitè¶Šå°‘ã€‚&lt;br /&gt;
minbucketè¶Šå°ï¼Œåˆ†ç»„è¶Šå¤šï¼Œsplitè¶Šå¤šã€‚&lt;/p&gt;

&lt;h6 id=&#34;classification-tree-å’Œ-regression-tree:0257109cd77173fde404dfe977de0c33&#34;&gt;Classification tree å’Œ Regression tree&lt;/h6&gt;

&lt;ul&gt;
&lt;li&gt;Classification tree analysis is when the predicted outcome is the class to which the data belongs.ï¼ˆç®€å•çš„è®²ï¼Œé¢„æµ‹å€¼æ˜¯0å’Œ1ï¼Œæ¯”å¦‚æ”¯æŒè¿˜æ˜¯åå¯¹ï¼‰&lt;/li&gt;
&lt;li&gt;Regression tree analysis is when the predicted outcome can be considered a real number.ï¼ˆç®€å•çš„è®²ï¼Œé¢„æµ‹å€¼æ˜¯å¯å˜çš„ï¼Œæ¯”å¦‚æˆ¿ä»·ç­‰ç­‰ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä½“ç°åœ¨ä»£ç ä¸­çš„è¯ï¼Œ
å¦‚æœæŒ‡å®šäº†type = &amp;ldquo;class&amp;rdquo;ï¼Œé‚£ä¹ˆæ˜¯ Classification treeã€‚&lt;br /&gt;
å¦‚æœæ²¡æœ‰æŒ‡å®štype = &amp;ldquo;class&amp;rdquo;ï¼Œé‚£ä¹ˆæ˜¯ Regression treeã€‚&lt;/p&gt;

&lt;h4 id=&#34;random-forest:0257109cd77173fde404dfe977de0c33&#34;&gt;Random Forest&lt;/h4&gt;

&lt;p&gt;éšæœºæ£®æ—ï¼Œè¢«è®¾è®¡å‡ºæ¥ç”¨äºæé«˜CARTçš„ç²¾åº¦ã€‚&lt;br /&gt;
å’Œå­—é¢æ„æ€ç±»ä¼¼ï¼Œå¦‚æœå†³ç­–æ ‘åªæœ‰ä¸€æ£µæ ‘ï¼Œé‚£ä¹ˆéšæœºæ£®æ—ä¼šåˆ›å»ºå¤šä¸ªå†³ç­–æ ‘ï¼Œç„¶åæ‰¾åˆ°æ•ˆæœæœ€å¥½çš„é‚£ä¸€ä¸ªã€‚&lt;br /&gt;
é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•åˆ›å»ºå¤šä¸ªå†³ç­–æ ‘çš„å‘¢ï¼Œæœ‰ç‚¹å¤æ‚ã€‚&lt;br /&gt;
å®ƒå¹¶ä¸æ˜¯å¤šæ¬¡è°ƒç”¨rpart()ï¼Œç®€å•çš„è°ƒæ•´å‡ ä¸ªå‚æ•°è€Œå·²ã€‚&lt;br /&gt;
æ¯ä¸ªå†³ç­–æ ‘æ‰€ç”¨çš„æ•°æ®ï¼Œéƒ½åªæ˜¯åŸæ•°æ®çš„éšæœºsubsetæˆ–è€…è¯´éšæœºå­é›†ã€‚&lt;br /&gt;
å¦‚æœè®­ç»ƒé›†è¢«åˆ†æˆ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5 è¿™äº”ä¸ªå­é›†ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡å¯èƒ½é€‰å–2ï¼Œ4ï¼Œ5ï¼Œ2ï¼Œ1ï¼Œç¬¬äºŒæ¬¡å¯èƒ½é€‰å–3ï¼Œ5ï¼Œ1ï¼Œ5ï¼Œ2ã€‚&lt;/p&gt;

&lt;p&gt;å‚æ•°nodesize&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ç±»ä¼¼äºminbucketï¼Œæ¯ä¸ªå­é›†çš„æœ€å°æ•°ç›®ã€‚å®ƒè¶Šå°ï¼Œç”Ÿæˆçš„å†³ç­–æ ‘è¶Šå¤§ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å‚æ•°ntree&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ç”Ÿæˆå¤šå°‘ä¸ªå†³ç­–æ ‘ã€‚ä¸€èˆ¬å‡ ç™¾ä¸ªå°±å¤Ÿäº†ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¥½æ¶ˆæ¯æ˜¯ï¼Œå‚æ•°çš„é€‰å–ï¼Œç›¸æ¯”CARTè€Œè¨€ï¼Œå¯¹ç»“æœçš„å½±å“æ²¡æœ‰é‚£ä¹ˆå¤§ã€‚&lt;/p&gt;

&lt;h4 id=&#34;cross-validation:0257109cd77173fde404dfe977de0c33&#34;&gt;Cross Validation&lt;/h4&gt;

&lt;p&gt;minbucketåº”è¯¥é€‰å–ä»€ä¹ˆæ ·çš„å€¼ï¼Œæ¥å¤§é“æœ€å¥½æ•ˆæœå‘¢ï¼Ÿ&lt;br /&gt;
æˆ‘ä»¬é‡‡ç”¨ k-fold cross validation çš„æ–¹æ³•ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬å°†è®­ç»ƒé›†trainåˆ†æˆkä»½ï¼Œæ¯”å¦‚ k=5 çš„æ—¶å€™ï¼Œ
æˆ‘ä»¬å…ˆç”¨1ï¼Œ2ï¼Œ3ï¼Œ4æ¥è®­ç»ƒï¼Œ5ç”¨æ¥éªŒè¯ï¼›&lt;br /&gt;
å†ç”¨1ï¼Œ2ï¼Œ3ï¼Œ5æ¥è®­ç»ƒï¼Œ4ç”¨æ¥éªŒè¯ï¼›
å†ç”¨1ï¼Œ2ï¼Œ4ï¼Œ5æ¥è®­ç»ƒï¼Œ3ç”¨æ¥éªŒè¯ã€‚ã€‚ã€‚
æ‰€ä»¥æ¨¡å‹ä¸­åˆ›å»ºäº†å¾ˆå¤šå†³ç­–æ ‘ã€‚
æˆ‘ä»¬æµ‹è¯•æ¯ä¸ªåˆ†å‰²æ–¹æ³•ä¸‹ï¼Œå‚æ•°æ¯ä¸€ä¸ªå¯èƒ½çš„å–å€¼ï¼Œè®¡ç®—è¿™ä¸ªå–å€¼å¯¹åº”çš„é¢„æµ‹ç²¾åº¦ï¼Œç»˜åˆ¶æ›²çº¿ã€‚&lt;br /&gt;
æ›²çº¿çš„Xè½´æ˜¯å‚æ•°çš„å–å€¼ï¼ŒYè½´æ˜¯é¢„æµ‹ç²¾åº¦ï¼Œè¿™æ ·å¯ä»¥å¾ˆå®¹æ˜“æ‰¾åˆ°å‚æ•°çš„æœ€ä½³å–å€¼ã€‚&lt;/p&gt;

&lt;h6 id=&#34;cp:0257109cd77173fde404dfe977de0c33&#34;&gt;CP&lt;/h6&gt;

&lt;p&gt;åƒRå¹³æ–¹ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå®šä¹‰äº†ä¸€ä¸ªæ¦‚å¿µ cp(complexity parameter) ç”¨æ¥è§‚æµ‹æ•ˆæœã€‚&lt;br /&gt;
cpè¶Šå°ï¼Œå†³ç­–æ ‘è¶Šå¤§(over fitting)ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?s = splits&#34; alt=&#34;formula&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;http://latex.codecogs.com/svg.latex?lambda = penalty\;error&#34; alt=&#34;formula&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;http://latex.codecogs.com/svg.latex?\sum_{leaves}(RSS\;at\;each\;leaf) + lambda*s&#34; alt=&#34;formula&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;http://latex.codecogs.com/svg.latex?cp = \frac{lambda}{RSS(no\;splits)}&#34; alt=&#34;formula&#34; /&gt;&lt;br /&gt;
cpè¶Šå¤§ï¼Œåˆ†æ¯è¶Šå°ï¼Œtreeè¶Šå°ã€‚&lt;br /&gt;
cpè¶Šå°ï¼Œåˆ†æ¯è¶Šå¤§ï¼Œtreeè¶Šå¤§ã€‚&lt;/p&gt;

&lt;h3 id=&#34;2-å»ºæ¨¡å’Œè¯„ä¼°:0257109cd77173fde404dfe977de0c33&#34;&gt;2.å»ºæ¨¡å’Œè¯„ä¼°&lt;/h3&gt;

&lt;h4 id=&#34;cart:0257109cd77173fde404dfe977de0c33&#34;&gt;CART&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# Install rpart library
install.packages(&amp;quot;rpart&amp;quot;)
library(rpart)
install.packages(&amp;quot;rpart.plot&amp;quot;)
library(rpart.plot)

# CART model
# method=&amp;quot;class&amp;quot; è¡¨ç¤ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª classification tree
StevensTree = rpart(Reverse ~ Circuit + Issue + Petitioner + Respondent + LowerCourt + Unconst, data = Train, method=&amp;quot;class&amp;quot;, minbucket=25)

# plot tree
prp(StevensTree)

# Make predictions
# è®°å¾—æŒ‡å®š type = &amp;quot;class&amp;quot;
PredictCART = predict(StevensTree, newdata = Test, type = &amp;quot;class&amp;quot;)
table(Test$Reverse, PredictCART)

# ROC curve
library(ROCR)

PredictROC = predict(StevensTree, newdata = Test)
# æ³¨æ„è¿™é‡Œæ²¡æœ‰æŒ‡å®š type = &amp;quot;class&amp;quot;
# ä¹Ÿå°±æ˜¯è¯´ï¼Œå­¦ä¹ å¾—åˆ° classification tree çš„æ¨¡å‹ï¼Œä½†æ˜¯è¯„ä¼°ä½¿ç”¨ regression tree
# çœŸæ˜¯å¤©æ€çš„ã€‚ã€‚ã€‚
# è¿™ä¸ªPredictROC æœ‰ä¸¤åˆ—
# ç¬¬ä¸€åˆ—æ˜¯é¢„æµ‹y=0çš„æ¦‚ç‡
# ç¬¬äºŒåˆ—æ˜¯é¢„æµ‹y=1çš„æ¦‚ç‡
# å¦‚æœæ¯”è¾ƒä¸€ä¸‹ PredictROC æ¯è¡Œçš„æ•°æ®ï¼Œå¯ä»¥å‘ç°è¿™ä¸¤ä¸ªæ¦‚ç‡å’Œä¸º1ï¼é‚£æ˜¯å½“ç„¶ï¼
# å¦‚æœæ‹¿ PredictROC å’Œ PredictCARTç›¸æ¯”
# å¦‚æœ PredictROC[n,2]&amp;gt;0.5ï¼Œé‚£ä¹ˆPredictCART[n]=1ã€‚
# å¦‚æœ PredictROC[n,2]&amp;lt;0.5ï¼Œé‚£ä¹ˆPredictCART[n]=0ã€‚
# æ‰€ä»¥ä¸‹é¢æˆ‘ä»¬åªä½¿ç”¨ç¬¬äºŒåˆ—

pred = prediction(PredictROC[,2], Test$Reverse)
perf = performance(pred, &amp;quot;tpr&amp;quot;, &amp;quot;fpr&amp;quot;)
plot(perf)

# AUC
as.numeric(performance(pred, &amp;quot;auc&amp;quot;)@y.values)
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;random-forest-1:0257109cd77173fde404dfe977de0c33&#34;&gt;Random Forest&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;install.packages(&amp;quot;randomForest&amp;quot;)
library(randomForest)

# Build random forest model
StevensForest = randomForest(Reverse ~ Circuit + Issue + Petitioner + Respondent + LowerCourt + Unconst, data = Train, ntree=200, nodesize=25 )
# Warning message:
# In randomForest.default(m, y, ...) :
#   The response has five or fewer unique values.  Are you sure you want to do regression?

# å¦‚ä¸Šé¢çš„æç¤ºæ¶ˆæ¯æ‰€ç¤º
# randomForestè®¤ä¸ºå› å˜é‡çš„å–å€¼å¾ˆå°‘ï¼Œä¸åº”è¯¥ç”¨regression
# ä½†æ˜¯ random forest æ²¡æœ‰ type = &amp;quot;class&amp;quot; è¿™æ ·çš„å‚æ•°
# æ‰€ä»¥æˆ‘ä»¬å¿…é¡»ç¡®ä¿å› å˜é‡è¿™ä¸€åˆ—çš„å–å€¼éƒ½æ˜¯å› å­
# Convert outcome to factor
Train$Reverse = as.factor(Train$Reverse)
Test$Reverse = as.factor(Test$Reverse)

# Try again
StevensForest = randomForest(Reverse ~ Circuit + Issue + Petitioner + Respondent + LowerCourt + Unconst, data = Train, ntree=200, nodesize=25 )

# Make predictions
PredictForest = predict(StevensForest, newdata = Test)
table(Test$Reverse, PredictForest)
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;cross-validation-1:0257109cd77173fde404dfe977de0c33&#34;&gt;Cross Validation&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# Install cross-validation packages
install.packages(&amp;quot;caret&amp;quot;)
library(caret)
install.packages(&amp;quot;e1071&amp;quot;)
library(e1071)

# Define cross-validation experiment
numFolds = trainControl( method = &amp;quot;cv&amp;quot;, number = 10 )
cpGrid = expand.grid( .cp = seq(0.01,0.5,0.01)) 

# Perform the cross validation
train(Reverse ~ Circuit + Issue + Petitioner + Respondent + LowerCourt + Unconst, data = Train, method = &amp;quot;rpart&amp;quot;, trControl = numFolds, tuneGrid = cpGrid )

# Create a new CART model
StevensTreeCV = rpart(Reverse ~ Circuit + Issue + Petitioner + Respondent + LowerCourt + Unconst, data = Train, method=&amp;quot;class&amp;quot;, cp = 0.18)

# Make predictions
PredictCV = predict(StevensTreeCV, newdata = Test, type = &amp;quot;class&amp;quot;)
table(Test$Reverse, PredictCV)
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;å‚æ•°cpå’Œlossçš„ä½¿ç”¨:0257109cd77173fde404dfe977de0c33&#34;&gt;å‚æ•°cpå’Œlossçš„ä½¿ç”¨&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# Penalty Matrix
PenaltyMatrix = matrix(c(0,1,2,3,4,2,0,1,2,3,4,2,0,1,2,6,4,2,0,1,8,6,4,2,0), byrow=TRUE, nrow=5)

# CART model
ClaimsTree = rpart(bucket2009 ~ age + alzheimers + arthritis + cancer + copd + depression + diabetes + heart.failure + ihd + kidney + osteoporosis + stroke + bucket2008 + reimbursement2008, data=ClaimsTrain, method=&amp;quot;class&amp;quot;, cp=0.00005)

prp(ClaimsTree)

# Make predictions
PredictTest = predict(ClaimsTree, newdata = ClaimsTest, type = &amp;quot;class&amp;quot;)
# New CART model with loss matrix
ClaimsTree = rpart(bucket2009 ~ age + alzheimers + arthritis + cancer + copd + depression + diabetes + heart.failure + ihd + kidney + osteoporosis + stroke + bucket2008 + reimbursement2008, data=ClaimsTrain, method=&amp;quot;class&amp;quot;, cp=0.00005, parms=list(loss=PenaltyMatrix))

# Redo predictions and penalty error
PredictTest = predict(ClaimsTree, newdata = ClaimsTest, type = &amp;quot;class&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Rè¯­è¨€ç¬”è®°03</title>
      <link>http://youngspring1.github.io/post/2016/2016-04-26-R03/</link>
      <pubDate>Tue, 26 Apr 2016 11:52:13 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-04-26-R03/</guid>
      <description>

&lt;p&gt;MITè¯¾ç¨‹ &lt;a href=&#34;https://courses.edx.org/courses/course-v1:MITx+15.071x_3+1T2016/info&#34;&gt;15.071x&lt;/a&gt; ç¬¬ä¸‰å•å…ƒçš„å­¦ä¹ è®°å½•ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;logistic-regression:2842374fb15231f36230fc5afd744bb4&#34;&gt;Logistic Regression&lt;/h2&gt;

&lt;p&gt;ç¬¬ä¸‰å•å…ƒçš„ä¸»é¢˜æ˜¯æŒ‡æ•°å›å½’ã€‚&lt;/p&gt;

&lt;h3 id=&#34;1-ç†è®º:2842374fb15231f36230fc5afd744bb4&#34;&gt;1.ç†è®º&lt;/h3&gt;

&lt;h4 id=&#34;æŒ‡æ•°å›å½’:2842374fb15231f36230fc5afd744bb4&#34;&gt;æŒ‡æ•°å›å½’&lt;/h4&gt;

&lt;p&gt;æŒ‡æ•°å›å½’ç”¨äºå› å˜é‡yæ˜¯äºŒè¿›åˆ¶çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œyçš„å–å€¼åªæœ‰1æˆ–è€…0ã€‚&lt;br /&gt;
y=1çš„æ¦‚ç‡ï¼š&lt;br /&gt;
&lt;img src=&#34;http://latex.codecogs.com/svg.latex?P(y=1)=\frac{1}{1+e^{-{(\beta_0 +\beta_1x_1+\beta_2x_2+\ldots+\beta_nx_n+\epsilon)}}}&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;p&gt;y=1çš„æ¦‚ç‡ä¸yï¼0çš„æ¦‚ç‡çš„æ¯”å€¼ï¼š&lt;br /&gt;
&lt;img src=&#34;http://latex.codecogs.com/svg.latex?Odds=\frac{P(y=1)}{P(y=0)}&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?Odds=\frac{P(y=1)}{1-P(y=1)}&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?Odds=e^{\beta_0 +\beta_1x_1+\beta_2x_2+\ldots+\beta_nx_n+\epsilon}&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;æ··æ·†çŸ©é˜µ-confusion-matrix:2842374fb15231f36230fc5afd744bb4&#34;&gt;æ··æ·†çŸ©é˜µï¼ˆconfusion matrixï¼‰&lt;/h4&gt;

&lt;p&gt;æœ‰é˜ˆå€¼tï¼Œ&lt;br /&gt;
å¦‚æœP(y=1) &amp;gt;=tï¼Œåˆ™é¢„æµ‹y=1ã€‚&lt;br /&gt;
å¦‚æœP(y=1) &amp;lt; tï¼Œåˆ™é¢„æµ‹y=0ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºé¢„æµ‹ç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°çŸ©é˜µ&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;predict y=0&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;predict y=1&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;actual y=0&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TN (True  Nagative)&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FP (False Positive)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;actual y=1&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FN (False Nagative)&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TP (True  Positive)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;æ ¹æ®çŸ©é˜µä¸­çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æŒ‡æ•°å›å½’çš„ä¸€äº›æŒ‡æ ‡ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?accuracy=\frac{TN+TP}{N}&#34; alt=&#34;formula&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;http://latex.codecogs.com/svg.latex?specificity=\frac{TN}{TN+FP}&#34; alt=&#34;formula&#34; /&gt;&lt;br /&gt;
&lt;img src=&#34;http://latex.codecogs.com/svg.latex?sensitivity=\frac{TP}{FN+TP}&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è¡¥å……æ¦‚å¿µï¼š&lt;br /&gt;
é€‚åˆç‡&lt;br /&gt;
&lt;img src=&#34;http://latex.codecogs.com/svg.latex?precision=\frac{TP}{FP+TP}&#34; alt=&#34;formula&#34; /&gt;&lt;br /&gt;
å†ç°ç‡&lt;br /&gt;
&lt;img src=&#34;http://latex.codecogs.com/svg.latex?recall=tpr=\frac{TP}{FN+TP}&#34; alt=&#34;formula&#34; /&gt;&lt;br /&gt;
Få€¼ï¼ˆF-measureï¼‰&lt;br /&gt;
&lt;img src=&#34;http://latex.codecogs.com/svg.latex?F-measure=\frac{2*precision*recall}{precision+recall}&#34; alt=&#34;formula&#34; /&gt;&lt;br /&gt;
Få€¼è¶Šé«˜ï¼Œæ€§èƒ½è¶Šå¥½&lt;/p&gt;

&lt;h4 id=&#34;rocæ›²çº¿:2842374fb15231f36230fc5afd744bb4&#34;&gt;ROCæ›²çº¿&lt;/h4&gt;

&lt;p&gt;ROCæ›²çº¿ (Receiver Operator Characteristic curve)å¯ä»¥æŒ‡å¯¼æˆ‘ä»¬å¦‚ä½•é€‰å–é˜ˆå€¼tã€‚
yè½´çš„æŒ‡æ ‡æ˜¯ sensitivityï¼Œæ‰€ä»¥ä¹Ÿå« True positive rateã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?sensitivity=\frac{TP}{FN+TP}&#34; alt=&#34;formula&#34; /&gt;&lt;br /&gt;
xè½´çš„æŒ‡æ ‡æ˜¯ 1-specificityï¼Œæ‰€ä»¥ä¹Ÿå« False positive rateã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?1-sensitivity=\frac{FP}{TN+FP}&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æ¯å–ä¸€ä¸ªé˜ˆå€¼tï¼Œåˆ™è®¡ç®—ç›¸å¯¹åº”çš„ TPR å’Œ FPRï¼Œåœ¨åæ ‡é‡Œæ ‡å‡ºè¿™ä¸ªç‚¹ï¼Œå°±å½¢æˆROCæ›²çº¿ã€‚&lt;br /&gt;
&lt;img src=&#34;http://7xrjai.com1.z0.glb.clouddn.com/20160509-ROC.png&#34; alt=&#34;ROC Curve&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å¦‚å›¾æ‰€ç¤ºï¼Œ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;t=0æ—¶ï¼Œæˆ‘ä»¬é¢„æµ‹æ‰€æœ‰çš„y=1ï¼Œå³TPR=1ï¼ŒFPR=1ï¼Œå¯¹åº”çš„åæ ‡æ˜¯(1,1)   
t=1æ—¶ï¼Œæˆ‘ä»¬é¢„æµ‹æ‰€æœ‰çš„y=0ï¼Œå³TPR=0ï¼ŒFPR=0ï¼Œå¯¹åº”çš„åæ ‡æ˜¯(0,0)   
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™å°±æ˜¯æ›²çº¿çš„ä¸¤ä¸ªç«¯ç‚¹ã€‚&lt;/p&gt;

&lt;h4 id=&#34;aucå€¼:2842374fb15231f36230fc5afd744bb4&#34;&gt;AUCå€¼&lt;/h4&gt;

&lt;p&gt;AUCï¼ˆArea Under Curveï¼‰è¢«å®šä¹‰ä¸ºROCæ›²çº¿ä¸‹çš„é¢ç§¯ï¼Œæ˜¾ç„¶è¿™ä¸ªé¢ç§¯çš„æ•°å€¼ä¸ä¼šå¤§äº1ã€‚åˆç”±äºROCæ›²çº¿ä¸€èˆ¬éƒ½å¤„äºy=xè¿™æ¡ç›´çº¿çš„ä¸Šæ–¹ï¼Œæ‰€ä»¥AUCçš„å–å€¼èŒƒå›´åœ¨0.5å’Œ1ä¹‹é—´ã€‚&lt;/p&gt;

&lt;h3 id=&#34;2-å»ºç«‹å›å½’æ¨¡å‹:2842374fb15231f36230fc5afd744bb4&#34;&gt;2.å»ºç«‹å›å½’æ¨¡å‹&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;# å»ºç«‹æ¨¡å‹
# Top10ä½œä¸ºå› å˜é‡ï¼Œå…¶ä»–æ‰€æœ‰çš„åˆ—éƒ½ä½œä¸ºè‡ªå˜é‡
SongsLog1 = glm(Top10 ~ ., data=SongsTrain, family=binomial)

# Top10ä½œä¸ºå› å˜é‡ï¼Œé™¤äº†loudnessä»¥å¤–çš„æ‰€æœ‰åˆ—éƒ½ä½œä¸ºè‡ªå˜é‡
SongsLog2 = glm(Top10 ~ . - loudness, data=SongsTrain, family=binomial)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;3-è¯„ä¼°:2842374fb15231f36230fc5afd744bb4&#34;&gt;3.è¯„ä¼°&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;# é¢„æµ‹
testPredict = predict(SongsLog3, newdata=SongsTest, type=&amp;quot;response&amp;quot;)

# ç”Ÿæˆæ··æ·†çŸ©é˜µ
table(SongsTest$Top10, testPredict &amp;gt;= 0.45)

# ç”ŸæˆROCæ›²çº¿
library(ROCR)
pred = prediction(testPredict, test$violator)
perf = performance(pred, &amp;quot;tpr&amp;quot;, &amp;quot;fpr&amp;quot;)
plot(perf)

# åŠ ç‚¹é¢œè‰²å’Œåæ ‡ç‚¹
plot(perf, colorize=TRUE, print.cutoffs.at=seq(0,1,0.1), text.adj=c(-0.2,1.7))

# è®¡ç®—AUCå€¼
as.numeric(performance(pred, &amp;quot;auc&amp;quot;)@y.values)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;é™„å½•a-åˆ†å‰²trainå’Œtestçš„æ–¹æ³•ä¸€:2842374fb15231f36230fc5afd744bb4&#34;&gt;é™„å½•A åˆ†å‰²trainå’Œtestçš„æ–¹æ³•ä¸€&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;library(caTools)
set.seed(144)

split = sample.split(parole$violator, SplitRatio = 0.7)
train = subset(parole, split == TRUE)
test = subset(parole, split == FALSE)
# ç‰¹åˆ«æ³¨æ„ï¼šæ¯æ¬¡è¿è¡Œå‡ºæ¥çš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹Ÿå¯ä»¥è¿™æ ·åšï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(caTools)
set.seed(144)

split = sample(1:nrow(data), size=0.7 * nrow(data))
train = data[split,]
test = data[-split,]
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;é™„å½•b-è¡¥å……ç¼ºå¤±æ•°æ®:2842374fb15231f36230fc5afd744bb4&#34;&gt;é™„å½•B è¡¥å……ç¼ºå¤±æ•°æ®&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;library(mice)
set.seed(144)
vars.for.imputation = setdiff(names(loans), &amp;quot;not.fully.paid&amp;quot;)
imputed = complete(mice(loans[vars.for.imputation]))
loans[vars.for.imputation] = imputed
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Rè¯­è¨€ç¬”è®°02</title>
      <link>http://youngspring1.github.io/post/2016/2016-04-23-R02/</link>
      <pubDate>Sat, 23 Apr 2016 15:19:39 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-04-23-R02/</guid>
      <description>

&lt;p&gt;MITè¯¾ç¨‹ &lt;a href=&#34;https://courses.edx.org/courses/course-v1:MITx+15.071x_3+1T2016/info&#34;&gt;15.071x&lt;/a&gt; ç¬¬äºŒå•å…ƒçš„å­¦ä¹ è®°å½•ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;linear-regression:efa3f4364b4acd6454b77ef89af35a47&#34;&gt;Linear Regression&lt;/h2&gt;

&lt;p&gt;ç¬¬äºŒå•å…ƒçš„ä¸»é¢˜æ˜¯çº¿æ€§å›å½’ã€‚&lt;/p&gt;

&lt;h3 id=&#34;1-ç†è®º:efa3f4364b4acd6454b77ef89af35a47&#34;&gt;1.ç†è®º&lt;/h3&gt;

&lt;p&gt;ä¸€å…ƒçº¿æ€§å›å½’å…¬å¼ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?y^i=\beta_0+\beta_1x^i+\epsilon^i&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å…¶ä¸­xæ˜¯è‡ªå˜é‡independent variableï¼Œyæ˜¯å› å˜é‡dependent variableã€‚&lt;br /&gt;
betaæ˜¯ç›¸å…³ç³»æ•°coefficientï¼Œepsilonæ˜¯è¯¯å·®errorã€‚&lt;/p&gt;

&lt;p&gt;ä¸ºäº†åˆ¤æ–­çº¿æ€§å›å½’çš„æ•ˆæœï¼Œæˆ‘ä»¬æœ‰å¦‚ä¸‹æ£€éªŒæ ‡å‡†ï¼š&lt;/p&gt;

&lt;p&gt;1.SSEï¼ˆsum of squared errorsï¼‰&lt;br /&gt;
æ³¨æ„è¿™é‡Œçš„è¯¯å·®æ˜¯å®é™…å€¼ç›¸å¯¹äºé¢„æµ‹å€¼çš„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?SSE = \sum_{i=1}^{n}\epsilon_i^2&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;p&gt;2.SST ï¼ˆtotal sum of squareï¼‰&lt;br /&gt;
å…¬å¼åŒä¸Šã€‚ä½†è¿™é‡Œçš„è¯¯å·®æ˜¯å®é™…å€¼ç›¸å¯¹äºbaselineçš„ã€‚baselineæ˜¯å› å˜é‡çš„å¹³å‡å€¼ã€‚&lt;br /&gt;
æ‰€ä»¥æœ‰ 0 &amp;lt;= SSE &amp;lt;= SST ã€‚&lt;/p&gt;

&lt;p&gt;3.RMSEï¼ˆroot mean square errorï¼‰&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?RMSE = \sqrt\frac{SSE}{n}&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;p&gt;4.Rå¹³æ–¹&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?R^2 = 1 - \frac{SSE}{SST}&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Rå¹³æ–¹è¶Šæ¥è¿‘1è¶Šå¥½ã€‚&lt;/p&gt;

&lt;p&gt;å¤šå…ƒçº¿æ€§å›å½’å…¬å¼ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?y^i = \beta_0 + \beta_1x_1^i + \beta_2x_2^i + \ldots + \beta_nx_n^i + \epsilon^i&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;æ‰€æœ‰æ•°æ®åˆ†æï¼Œéƒ½è¦ç»å† trainingï¼testï¼predict è¿™ä¸‰ä¸ªè¿‡ç¨‹ã€‚
åœ¨æ¥ä¸‹æ¥çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä»‹ç» å»ºæ¨¡ï¼è¯„ä¼° è¿™å‰ä¸¤ä¸ªè¿‡ç¨‹ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¡¥å……ä¸€ä¸ªrelative errorçš„å…¬å¼ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?relative\;error =  \frac{observed\;value - estimated\,value}{observed\;value}&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;h5 id=&#34;2-0-äº‹å‰æ•´ç†:efa3f4364b4acd6454b77ef89af35a47&#34;&gt;2.0 äº‹å‰æ•´ç†&lt;/h5&gt;

&lt;p&gt;2.0.1 å»é™¤ç©ºå€¼&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# å¦‚æœæ•°æ®ä¸­åŒ…å«ç©ºå€¼
DF ï¼ na.omit(DF)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;2.0.2 reference level&lt;br /&gt;
æœ‰äº›åˆ—æ—¶å­—ç¬¦å‹çš„ï¼Œå®ƒä»¬æ— æ³•è¿›è¡Œè®¡ç®—ã€‚&lt;br /&gt;
å¦‚æœæŸåˆ—çš„å› å­ä¸ç®—å¤šï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸€åˆ—å˜æ¢æˆå¤šä¸ªå¯ä»¥ç”¨äºè®¡ç®—çš„åˆ—ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# å‡è®¾DF$colræœ‰å› å­ &amp;quot;Red&amp;quot;4æ¬¡, &amp;quot;Blue&amp;quot;3æ¬¡, &amp;quot;Yellow&amp;quot;2æ¬¡
DF$colr = relevel(DF$colr, &amp;quot;red&amp;quot;)

# æ•ˆæœæ˜¯ï¼ŒDF$colr è¿™ä¸€åˆ—ä¸è§äº†
# å¢åŠ äº†ä¸¤åˆ— DF$colrBlue å’Œ DF$colrYellow
# åŸå…ˆ DF$colr == &amp;quot;Red&amp;quot; çš„é‚£äº›è¡Œï¼Œå®ƒä»¬ colrBlue å’Œ colrYellow çš„å€¼éƒ½æ˜¯0
# åŸå…ˆ DF$colr == &amp;quot;Blue&amp;quot; çš„é‚£äº›è¡Œï¼Œå®ƒä»¬ colrBlue=1, colrYellow=0
# åŸå…ˆ DF$colr == &amp;quot;Yellow&amp;quot; çš„é‚£äº›è¡Œï¼Œå®ƒä»¬ colrBlue=0, colrYellow=1
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;2-å»ºç«‹å›å½’æ¨¡å‹:efa3f4364b4acd6454b77ef89af35a47&#34;&gt;2.å»ºç«‹å›å½’æ¨¡å‹&lt;/h3&gt;

&lt;p&gt;å»ºæ¨¡ä½¿ç”¨lm()å‡½æ•°ã€‚&lt;br /&gt;
DFæ˜¯ä¿å­˜å­¦ä¹ æ•°æ®çš„data.frameã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;model = lm(y ~ x1 + x2 + ... +xn, data = DF)
# yä¸è¦å†™æˆ DF$y
# x1ä¹Ÿä¸è¦å†™æˆ DF$x1
# å¦åˆ™ï¼Œåé¢åšé¢„æµ‹predict()çš„æ—¶å€™ï¼ŒDFTestä»£å…¥ä¼šæŠ¥warning

# é™¤äº†yåˆ—ä»¥å¤–æ‰€æœ‰åˆ—
model = lm(y ~ ., data = DF)

# è¯¯å·® model$residuals
SSE = sum(model$residuals^2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;éšä¾¿çœ‹ä¸ªç»“æœå§&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;gt; summary(model)

Call:
lm(formula = Price ~ HarvestRain + WinterRain, data = wine)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.0933 -0.3222 -0.1012  0.3871  1.1877 

Coefficients:
              Estimate Std. Error t value Pr(&amp;gt;|t|)    
(Intercept)  7.865e+00  6.616e-01  11.888 4.76e-11 ***
HarvestRain -4.971e-03  1.601e-03  -3.105  0.00516 ** 
WinterRain  -9.848e-05  9.007e-04  -0.109  0.91392    
---
Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1

Residual standard error: 0.5611 on 22 degrees of freedom
Multiple R-squared:  0.3177,    Adjusted R-squared:  0.2557 
F-statistic: 5.122 on 2 and 22 DF,  p-value: 0.01492
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Callè¡¨ç¤ºå»ºæ¨¡ä½¿ç”¨çš„è¯­å¥ã€‚&lt;br /&gt;
Residualsè¡¨ç¤ºè¯¯å·®ã€‚&lt;br /&gt;
Coefficientsè¡¨ç¤ºç³»æ•°ï¼Œå°±æ˜¯å…¬å¼é‡Œé¢çš„betaã€‚&lt;br /&gt;
Estimateçš„ç¬¬ä¸€è¡Œæ˜¯å¸¸æ•°beta0ï¼Œç¬¬äºŒè¡Œæ˜¯ç¬¬ä¸€ä¸ªè‡ªå˜é‡çš„ç³»æ•°beta1ï¼Œç¬¬ä¸‰è¡Œæ˜¯ç¬¬äºŒä¸ªè‡ªå˜é‡çš„ç³»æ•°beta2ï¼Œåé¢ç±»æ¨ã€‚&lt;br /&gt;
t valueè¶Šå¤§è¶Šå¥½&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://latex.codecogs.com/svg.latex?{t\,value} = \frac{Estimate}{Std. Error}&#34; alt=&#34;formula&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Pr(&amp;gt;|t|) å’Œt valueç›¸åï¼Œè¶Šå°è¶Šå¥½ã€‚&lt;br /&gt;
æœ€åä¸€åˆ—æ˜Ÿæ˜Ÿè¶Šå¤šè¶Šå¥½ã€‚&lt;br /&gt;
ä¸‰çŸ­æ¨ªä¸‹é¢è¿™è¡Œè§£é‡Šäº†æ˜Ÿæ˜Ÿçš„å«ä¹‰ã€‚&lt;br /&gt;
Multiple R-squaredå°±æ˜¯Rå¹³æ–¹ï¼Œè¶Šæ¥è¿‘1è¶Šå‡†ç¡®ã€‚&lt;/p&gt;

&lt;h3 id=&#34;3-è¯„ä¼°:efa3f4364b4acd6454b77ef89af35a47&#34;&gt;3.è¯„ä¼°&lt;/h3&gt;

&lt;p&gt;å¯¹äºåˆšè¿‡ç®€å†çš„æ¨¡å‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æµ‹è¯•æ•°æ®æ¥è¯„ä¼°ä¸€ä¸‹å‡†ç¡®åº¦ã€‚&lt;br /&gt;
modelå°±æ˜¯ä¸Šæ–‡å»ºç«‹çš„æ¨¡å‹ã€‚&lt;br /&gt;
DFTestæ˜¯æµ‹è¯•æ•°æ®ï¼Œå®ƒçš„ç»“æ„å’Œä¸Šæ–‡çš„DFä¸€æ ·ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;predict = predict(model, newdata = DFTest)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ä¸ªå‘½ä»¤çš„è¿”å›å€¼æ˜¯ DFTest$Price çš„&lt;strong&gt;é¢„æµ‹&lt;/strong&gt;ç»“æœã€‚ä½ å¯ä»¥è·Ÿ DFTest$Price çš„&lt;strong&gt;å®é™…&lt;/strong&gt;ç»“æœç›¸æ¯”è¾ƒï¼Œè®¡ç®—SSEã€RMSEã€Rå¹³æ–¹ç­‰ç­‰æ¥è¡¡é‡å¯¹æµ‹è¯•æ•°æ®çš„é¢„æµ‹çš„å‡†ç¡®æ€§ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;SSE = sum( (DFTest$Price - predict)^2 )
SST = sum( (DFTest$Price - mean(DF$Price)^2 )
R2 = 1 - SSE/SST
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;4-correlation:efa3f4364b4acd6454b77ef89af35a47&#34;&gt;4.Correlation&lt;/h3&gt;

&lt;p&gt;çº¿æ€§ç›¸å…³æ€§&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cor(var1, var2)
# ä¹Ÿå¯ä»¥è€ƒå¯Ÿæ•´ä¸ªDFä¸­ï¼Œæ¯ä¸¤åˆ—çš„çº¿æ€§ç›¸å…³æ€§
cor(DF)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿”å›å€¼æ˜¯æ–œç‡ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;å»ºç«‹çº¿æ€§å›å½’æ¨¡å‹çš„æ—¶å€™ï¼Œåº”è¯¥å»æ‰ç›¸å…³æ€§æ¯”è¾ƒé«˜çš„åˆ—ã€‚&lt;/strong&gt;&lt;/p&gt;

&lt;h3 id=&#34;è¡¥å……çŸ¥è¯†a-æ£’çƒç»Ÿè®¡æœ¯è¯­:efa3f4364b4acd6454b77ef89af35a47&#34;&gt;è¡¥å……çŸ¥è¯†Aï¼æ£’çƒç»Ÿè®¡æœ¯è¯­&lt;/h3&gt;

&lt;p&gt;å®Œå…¨ä¸æ‡‚æ£’çƒå•Šï¼Œä¸€å¼€å§‹æ‘¸ä¸ç€å¤´è„‘ã€‚&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;ç¼©å†™&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;åŸæ–‡&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;ä¸­æ–‡&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;RS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Run Scores&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;è·‘åˆ†ï¼Œå¾—åˆ†&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;RA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Run Allowed&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;å¤±åˆ†ï¼Œå¯¹æ‰‹å¾—åˆ†&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;OBP&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;On-Base Percentage&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ä¸Šå’ç‡&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;OOBP&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Opponent On-Base Percentage&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;å¯¹æ‰‹ä¸Šå’ç‡&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;SLG&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Slugging Percentage&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;é•¿æ‰“ç‡ï¼Œå‡»ä¸­ç‡&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;OSLG&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Opponent Slugging Percentage&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;å¯¹æ‰‹é•¿æ‰“ç‡&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;BA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Batting Avarage&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;å¹³å‡æˆåŠŸç‡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&#34;è¡¥å……çŸ¥è¯†b-ç¯®çƒç»Ÿè®¡æœ¯è¯­:efa3f4364b4acd6454b77ef89af35a47&#34;&gt;è¡¥å……çŸ¥è¯†Bï¼ç¯®çƒç»Ÿè®¡æœ¯è¯­&lt;/h3&gt;

&lt;p&gt;å¹´è½»æ—¶çœ‹NBAï¼Œå¥½æ­¹çŸ¥é“ä¸€ç‚¹ã€‚&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;ç¼©å†™&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;åŸæ–‡&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;ä¸­æ–‡&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;PTS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Points&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;å¾—åˆ†&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;oppPTS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Opponent Points&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;å¤±åˆ†ï¼Œå¯¹æ‰‹å¾—åˆ†&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;FG&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Field Goals (success)&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;è¿›çƒæ•°&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;FGA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Field Goals Attempted&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;å‡ºæ‰‹æ¬¡æ•°&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;X2P&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2 Points&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2åˆ†çƒè¿›çƒæ•°&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;X2PA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2 Points Attempted&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;2åˆ†çƒå‡ºæ‰‹æ¬¡æ•°&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;X3P&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3 Points&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3åˆ†çƒè¿›çƒæ•°&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;X3PA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3 Points Attempted&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;3åˆ†çƒå‡ºæ‰‹æ¬¡æ•°&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;FT&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Free Throw&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ç½šçƒè¿›çƒæ•°&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;FTA&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Free Throw Attempted&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;å‘çƒå‡ºæ‰‹æ¬¡æ•°&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;ORB&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Offensive Rebounds&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;å‰åœºç¯®æ¿ï¼Œè¿›æ”»ç¯®æ¿&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;DRB&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Defensive Rebounds&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ååœºç¯®æ¿ï¼Œé˜²å®ˆç¯®æ¿&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;AST&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Assists&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;åŠ©æ”»&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;STL&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Steals&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;æŠ¢æ–­&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;BLK&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Blocks&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ç›–å¸½&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;TOV&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Turnovers&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;å¤±è¯¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;æ³¨ï¼šX2Påˆ—ï¼ŒåŸå§‹æ•°æ®åˆ—åæ˜¯2Pã€‚ç”±äºRä¸æ”¯æŒæ•°å­—å¼€å¤´çš„åˆ—åï¼å˜é‡ï¼Œè¯»å–CSVæ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šåœ¨åŸåˆ—å2På‰åŠ ä¸ªXï¼Œä»è€Œå˜æˆ X2Pã€‚&lt;/p&gt;

&lt;h3 id=&#34;è¡¥å……çŸ¥è¯†c-æ»ååºåˆ—:efa3f4364b4acd6454b77ef89af35a47&#34;&gt;è¡¥å……çŸ¥è¯†Cï¼æ»ååºåˆ—&lt;/h3&gt;

&lt;p&gt;å‡½æ•°lagï¼Œç”¨äºç”Ÿæˆæ»å/åç§»åºåˆ—ï¼Ÿ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;lag(x, k = 1, ...)
# k &amp;lt; 0, previous observations   
# k &amp;gt; 0, future observations
# na.pad=TRUE, add missing values
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Rè¯­è¨€ç¬”è®°01</title>
      <link>http://youngspring1.github.io/post/2016/2016-04-18-R01/</link>
      <pubDate>Mon, 18 Apr 2016 19:55:25 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-04-18-R01/</guid>
      <description>

&lt;p&gt;MITè¯¾ç¨‹ &lt;a href=&#34;https://courses.edx.org/courses/course-v1:MITx+15.071x_3+1T2016/info&#34;&gt;15.071x&lt;/a&gt; ç¬¬ä¸€å•å…ƒçš„å­¦ä¹ è®°å½•ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;rè¯­è¨€å…¥é—¨:86ba9dc4beedcb3ca4aa6515cf113aed&#34;&gt;Rè¯­è¨€å…¥é—¨&lt;/h2&gt;

&lt;p&gt;Rè¯­è¨€å…¥é—¨åªè®²äº†ä¸€äº›å¸¸ç”¨çš„æ“ä½œã€‚ç›¸å¯¹äºåŠ¨è¾„èŠ±ä¸€æœ¬ä¹¦æ¥è®²è¿™äº›ï¼ŒçœŸæ˜¯ç›¸å½“ç®€çº¦ã€‚ä½†å…¶å®è¶³å¤Ÿäº†ï¼Œå…¶ä»–æ“ä½œï¼Œéœ€è¦çš„æ—¶å€™å†æŸ¥å˜›ã€‚&lt;br /&gt;
æ•°æ®åˆ†æçš„å››è¦ç´ ï¼šdataã€modelsã€decisionsã€value&lt;/p&gt;

&lt;h3 id=&#34;ç®€å•ä½¿ç”¨:86ba9dc4beedcb3ca4aa6515cf113aed&#34;&gt;ç®€å•ä½¿ç”¨&lt;/h3&gt;

&lt;p&gt;å¸®åŠ©ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;?func
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ˜¾ç¤ºå½“å‰çš„ä¸´æ—¶å˜é‡ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ls()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è·å–ï¼è®¾ç½®å½“å‰ç›®å½•ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;getwd()
setwd()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ˜¾ç¤ºå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dir()
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;æ•°æ®ç»“æ„:86ba9dc4beedcb3ca4aa6515cf113aed&#34;&gt;æ•°æ®ç»“æ„&lt;/h3&gt;

&lt;p&gt;å‘é‡æ¦‚å¿µï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯å¯¹å‘é‡çš„æ¯ä¸ªå…ƒç´ å®æ–½çš„
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;data.frameï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;observationï¼šè¡Œ
variable   ï¼šåˆ—ï¼Œdata.frameæ˜¯æŒ‰ç…§åˆ—å­˜å‚¨çš„
rbind()åˆå¹¶ä¸¤ä¸ªdata.frame
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åºåˆ—ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;è‡ªåŠ¨ç”Ÿæˆåºåˆ—seq()
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;è·å–æ•°æ®:86ba9dc4beedcb3ca4aa6515cf113aed&#34;&gt;è·å–æ•°æ®&lt;/h3&gt;

&lt;p&gt;è¯»å–CSVæ–‡ä»¶ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DF = read.csv(&amp;quot;file_path&amp;quot;)
# è¿”å›å€¼æ˜¯data.frame
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æŸ¥çœ‹DFçš„åŸºæœ¬ä¿¡æ¯ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;str(DF)
# DFçš„ç»“æ„ä¿¡æ¯ã€‚è¡Œå’Œåˆ—çš„æ•°ç›®ï¼Œåˆ—åã€åˆ—çš„ç±»å‹ã€åˆ—çš„æ•°æ®ä¸¾ä¾‹ã€‚

summary(DF)
# æ¯åˆ—çš„æœ€å¤§å€¼ã€æœ€å°å€¼ã€ä¸­ä½æ•°ã€å¹³å‡æ•°ã€1/4å€¼ã€3/4å€¼ï¼Œä»¥åŠæ˜¯å¦åŒ…å«ç©ºå€¼ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å†™å…¥CSVæ–‡ä»¶ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;write.csv(DF, &amp;quot;file_path&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä»å†…å­˜ä¸­åˆ é™¤å˜é‡ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rm(DF)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;æ•°æ®æ“ä½œ:86ba9dc4beedcb3ca4aa6515cf113aed&#34;&gt;æ•°æ®æ“ä½œ&lt;/h3&gt;

&lt;p&gt;é€‰å–ä¸€éƒ¨åˆ†æ•°æ®ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;subset( DF, æ¡ä»¶1 &amp;amp; æ¡ä»¶2 ï½œ æ¡ä»¶3)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æŒ‰ç…§åˆ—åé€‰å–3åˆ—ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DF[c(var1, var2, var3)]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é€‰å–1ï¼Œ3ï¼Œ5åˆ—ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DF[c(1, 3, 5)]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è®¡ç®—å¹³å‡å€¼å’Œæ ‡å‡†å·®ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mean(DF$var)
sd(DF$var)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿”å›æœ€å¤§å€¼ï¼æœ€å°å€¼çš„ä½ç½®(index)ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;which.max(DF$var)
which.min(DF$var)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿”å›è¡Œæ•°ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nrow(DF)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;ç»˜å›¾:86ba9dc4beedcb3ca4aa6515cf113aed&#34;&gt;ç»˜å›¾&lt;/h3&gt;

&lt;p&gt;ç›´æ–¹å›¾ï¼Œåæ˜ &lt;strong&gt;ä¸€åˆ—&lt;/strong&gt;æ•°æ®çš„åˆ†å¸ƒæƒ…å†µï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;hist(DF$var, xlim = c(1, 100), breaks = 100)
# xlim é™å®šèŒƒå›´
# breaks xè½´çš„ç²¾ç¡®åº¦ã€‚æ³¨æ„æ˜¯é’ˆå¯¹åŸå§‹æ•°æ®çš„ï¼Œä¸æ˜¯å¯¹é™å®šåçš„
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç®±å‹å›¾ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;boxplot(DF$var1 ~ DF$var2, xlab = &amp;quot;x-label&amp;quot;, ylab = &amp;quot;y-label&amp;quot;, main = &amp;quot;title&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç‚¹é˜µå›¾ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;plot(......, col = &amp;quot;red&amp;quot;)
line(......, col = &amp;quot;blue&amp;quot;) # åœ¨åŸå…ˆçš„åŸºç¡€ä¸Šå†åŠ ä¸€æ¡

å‡½æ•°jitter() # å¯¹äºæœ‰å¾ˆå¤šé‡åˆçš„ç‚¹é˜µå›¾ï¼Œå…ˆç”¨jitteråç§»ä¸€ç‚¹ï¼Œè¿™æ ·çœ‹ä¸Šå»æ•ˆæœå¥½å¾ˆå¤š
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…¶ä»–å…±é€šçš„å‚æ•°ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;col = &amp;quot;red&amp;quot;
type = &amp;quot;line&amp;quot; # å¯ä»¥æŒ‡å®š1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;èšåˆ:86ba9dc4beedcb3ca4aa6515cf113aed&#34;&gt;èšåˆ&lt;/h3&gt;

&lt;p&gt;åˆ†ç»„ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;table(DF$var1)
# var1åˆ—ä¸­ï¼Œæ¯ç§æ•°æ®çš„æ•°é‡çš„ç»Ÿè®¡
table(DF$var1, DF$var2)
# var1å’Œvar2åˆ—ä¸­ï¼Œæ¯ç§æ•°æ®çš„æ•°é‡çš„äº¤å‰ç»Ÿè®¡
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åˆ†ç»„è®¡ç®—ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;tapply(DF$var1, DF$var2, func)
# DF$var1, åŸå§‹æ•°æ®
# DF$var2, åˆ†ç»„ä¾æ®
# func, è¦åº”ç”¨çš„å‡½æ•°
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>data.table æ•™ç¨‹5ï¼ˆæ ¡å¯¹ä¸­ï¼‰</title>
      <link>http://youngspring1.github.io/post/2016/2016-04-08-datatable5/</link>
      <pubDate>Fri, 08 Apr 2016 13:00:57 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-04-08-datatable5/</guid>
      <description>

&lt;p&gt;ç›®å½•ï¼š&lt;br /&gt;
1) &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-13-datatable1/&#34;&gt;data.table ä»‹ç»&lt;/a&gt;&lt;br /&gt;
2) &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-21-datatable2/&#34;&gt;è¯­ä¹‰å¼•ç”¨&lt;/a&gt;&lt;br /&gt;
3) &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-22-datatable3/&#34;&gt;ä¸»é”®ã€åŸºäºå¿«é€ŸäºŒåˆ†æ³•æœç´¢çš„subset&lt;/a&gt;&lt;br /&gt;
4) &lt;a href=&#34;http://youngspring1.github.io/post/2016-04-02-datatable4/&#34;&gt;äºŒçº§ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•&lt;/a&gt;&lt;br /&gt;
5) æœ‰æ•ˆçš„æ•°æ®æ‹†åˆ†å’Œåˆå¹¶&lt;/p&gt;

&lt;p&gt;åŸæ–‡åœ°å€ï¼š&lt;br /&gt;
1) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-intro-vignette.html&#34;&gt;Introduction to data.table&lt;/a&gt;&lt;br /&gt;
2) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-reference-semantics.html&#34;&gt;Reference semantics&lt;/a&gt;&lt;br /&gt;
3) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-keys-fast-subset.html&#34;&gt;Keys and fast binary search based subsets&lt;/a&gt;&lt;br /&gt;
4) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-secondary-indices-and-auto-indexing.html&#34;&gt;Secondary indices and auto indexing&lt;/a&gt;&lt;br /&gt;
5) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-reshape.html&#34;&gt;Efficient reshaping using data.tables&lt;/a&gt;&lt;br /&gt;
6) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-faq.html&#34;&gt;Frequently asked questions&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&#34;æœ‰æ•ˆçš„æ•°æ®æ‹†åˆ†å’Œåˆå¹¶:8a0e17190d0dbfa1c06f28f3c1a1fd66&#34;&gt;æœ‰æ•ˆçš„æ•°æ®æ‹†åˆ†å’Œåˆå¹¶&lt;/h1&gt;

&lt;p&gt;è¿™ä¸€è®²æˆ‘ä»¬å­¦ä¹ reshapingå‡½æ•° melt å’Œ dcast åŸæœ¬çš„ç”¨æ³•ï¼Œä»¥åŠä»Rè¯­è¨€ v1.9.6ç‰ˆä»¥åï¼Œå‡½æ•° melt å’Œ dcast æ–°æ‰©å±•çš„åŠŸèƒ½ï¼ˆå®ƒä»¬èƒ½æ“ä½œå¤šä¸ªåˆ—ï¼‰ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;æ•°æ®:8a0e17190d0dbfa1c06f28f3c1a1fd66&#34;&gt;æ•°æ®&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬åœ¨è®²è§£çš„æ—¶å€™ç›´æ¥åŠ è½½æ•°æ®ã€‚&lt;/p&gt;

&lt;h2 id=&#34;ä»‹ç»:8a0e17190d0dbfa1c06f28f3c1a1fd66&#34;&gt;ä»‹ç»&lt;/h2&gt;

&lt;p&gt;data.tableçš„å‡½æ•°melt å’Œ dcast æ˜¯å¢å¼ºåŒ…&lt;a href=&#34;https://cran.r-project.org/web/packages/reshape2/index.html&#34;&gt;reshape2&lt;/a&gt;é‡ŒåŒåå‡½æ•°çš„æ‰©å±•ã€‚&lt;br /&gt;
åœ¨è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä¼šï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;é¦–å…ˆï¼Œç®€å•çœ‹ä¸€ä¸‹åŸå…ˆçš„å‡½æ•° melt å’Œ dcastï¼Œå®ƒä»¬æ˜¯å¦‚ä½•reshapingä¸€ä¸ªdata.tableã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;ç„¶åï¼Œäº†è§£ä¸€ä¸‹å½“å‰çš„åŠŸèƒ½æ˜¯å¦‚ä½•å˜å¾—å†—é•¿è€Œä¸”ä½æ•ˆã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;æœ€åï¼Œå­¦ä¹ ä¸€ä¸‹æ”¹è¿›ä¹‹åçš„å‡½æ•° melt å’Œ dcast å¦‚ä½•åŒæ—¶å¤„ç†å¤šä¸ªåˆ—ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æ‰©å±•åçš„åŠŸèƒ½ç¬¦åˆdata.tableçš„è®¾è®¡å“²å­¦ï¼šè¿è¡Œé«˜æ•ˆï¼Œè¯­æ³•ç®€æ˜ã€‚&lt;/p&gt;

&lt;p&gt;æ³¨æ„ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ä»Rè¯­è¨€ v1.9.6ç‰ˆä»¥åï¼Œä½ å†ä¹Ÿä¸éœ€è¦åŠ è½½å¢å¼ºåŒ… reshape2 äº†ï¼Œåªéœ€è¦åŠ è½½ data.tableã€‚å¦‚æœä½ å·²ç»åŠ è½½äº† reshape2 æ¥å¤„ç†çŸ©é˜µæˆ–è€…data.frameï¼Œé‚£ä¹ˆä¸€å®šè¦ç¡®ä¿åœ¨è¿™ä¹‹åå†åŠ è½½ data.tableã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;1-åŸç”Ÿçš„melt-dcast:8a0e17190d0dbfa1c06f28f3c1a1fd66&#34;&gt;1.åŸç”Ÿçš„meltï¼dcast&lt;/h2&gt;

&lt;h4 id=&#34;a-å‡½æ•°melt:8a0e17190d0dbfa1c06f28f3c1a1fd66&#34;&gt;a) å‡½æ•°melt&lt;/h4&gt;

&lt;p&gt;å‡è®¾æˆ‘ä»¬æœ‰ä¸‹é¢è¿™æ ·çš„data.tableï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT = fread(&amp;quot;melt_default.csv&amp;quot;)
DT
#    family_id age_mother dob_child1 dob_child2 dob_child3
# 1:         1         30 1998-11-26 2000-01-29         NA
# 2:         2         27 1996-06-22         NA         NA
# 3:         3         26 2002-07-11 2004-04-05 2007-09-02
# 4:         4         32 2004-10-10 2009-08-27 2012-07-21
# 5:         5         29 2000-12-05 2005-02-28         NA
## dob stands for date of birth.

str(DT)
# Classes &#39;data.table&#39; and &#39;data.frame&#39;:    5 obs. of  5 variables:
#  $ family_id : int  1 2 3 4 5
#  $ age_mother: int  30 27 26 32 29
#  $ dob_child1: chr  &amp;quot;1998-11-26&amp;quot; &amp;quot;1996-06-22&amp;quot; &amp;quot;2002-07-11&amp;quot; &amp;quot;2004-10-10&amp;quot; ...
#  $ dob_child2: chr  &amp;quot;2000-01-29&amp;quot; NA &amp;quot;2004-04-05&amp;quot; &amp;quot;2009-08-27&amp;quot; ...
#  $ dob_child3: chr  NA NA &amp;quot;2007-09-02&amp;quot; &amp;quot;2012-07-21&amp;quot; ...
#  - attr(*, &amp;quot;.internal.selfref&amp;quot;)=&amp;lt;externalptr&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼è½¬åŒ–DTï¼Œä½¿å¾—æ¯ä¸ªå°å­©çš„å‡ºç”Ÿä¿¡æ¯éƒ½ç‹¬å ä¸€æ¡æ•°æ®&lt;br /&gt;
æˆ‘ä»¬å¯ä»¥å¯¹å‡½æ•° melt() æŒ‡å®šå‚æ•° id.vars å’Œ measure.vars æ¥å®ç°&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT.m1 = melt(DT, id.vars = c(&amp;quot;family_id&amp;quot;, &amp;quot;age_mother&amp;quot;),
        measure.vars = c(&amp;quot;dob_child1&amp;quot;, &amp;quot;dob_child2&amp;quot;, &amp;quot;dob_child3&amp;quot;))
DT.m1
#     family_id age_mother   variable      value
#  1:         1         30 dob_child1 1998-11-26
#  2:         2         27 dob_child1 1996-06-22
#  3:         3         26 dob_child1 2002-07-11
#  4:         4         32 dob_child1 2004-10-10
#  5:         5         29 dob_child1 2000-12-05
#  6:         1         30 dob_child2 2000-01-29
#  7:         2         27 dob_child2         NA
#  8:         3         26 dob_child2 2004-04-05
#  9:         4         32 dob_child2 2009-08-27
# 10:         5         29 dob_child2 2005-02-28
# 11:         1         30 dob_child3         NA
# 12:         2         27 dob_child3         NA
# 13:         3         26 dob_child3 2007-09-02
# 14:         4         32 dob_child3 2012-07-21
# 15:         5         29 dob_child3         NA
str(DT.m1)
# Classes &#39;data.table&#39; and &#39;data.frame&#39;:    15 obs. of  4 variables:
#  $ family_id : int  1 2 3 4 5 1 2 3 4 5 ...
#  $ age_mother: int  30 27 26 32 29 30 27 26 32 29 ...
#  $ variable  : Factor w/ 3 levels &amp;quot;dob_child1&amp;quot;,&amp;quot;dob_child2&amp;quot;,..: 1 1 1 1 1 2 2 2 2 2 ...
#  $ value     : chr  &amp;quot;1998-11-26&amp;quot; &amp;quot;1996-06-22&amp;quot; &amp;quot;2002-07-11&amp;quot; &amp;quot;2004-10-10&amp;quot; ...
#  - attr(*, &amp;quot;.internal.selfref&amp;quot;)=&amp;lt;externalptr&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å‚æ•° measure.vars æŒ‡å®šäº†æƒ³è¦æ‹†åˆ†ï¼ˆæˆ–åˆå¹¶ï¼‰çš„åˆ—ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šç´¢å¼•è€Œä¸æ˜¯åˆ—åã€‚&lt;/li&gt;
&lt;li&gt;é»˜è®¤çš„ï¼Œvariableåˆ—æ˜¯ factorï¼ˆå› å­ï¼‰ç±»å‹çš„ã€‚å¦‚æœä½ æƒ³è¿”å›ä¸€ä¸ªå­—ç¬¦å‹çš„å‘é‡ï¼Œå¯ä»¥å°†å‚æ•° variable.factor è®¾ä¸º FALSEã€‚å‚æ•° variable.factor æ˜¯data.tableçš„å‡½æ•°melt() é‡Œç‹¬æœ‰çš„ï¼Œå¢å¼ºåŒ…reshape2 é‡Œé¢æ²¡æœ‰è¿™ä¸ªå‚æ•°ã€‚&lt;/li&gt;
&lt;li&gt;é»˜è®¤çš„ï¼Œè½¬åŒ–æœçš„åˆ—è¢«è‡ªåŠ¨å‘½åä¸º variable å’Œ valueã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ç»“æœé‡Œï¼Œå‡½æ•°melt() ä¿æŒäº†åŸæ¥åˆ—çš„å±æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ï¼åˆ†åˆ«å°† variableåˆ—å’Œ valueåˆ—é‡å‘½åä¸º child å’Œ dob&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT.m1 = melt(DT, measure.vars = c(&amp;quot;dob_child1&amp;quot;, &amp;quot;dob_child2&amp;quot;, &amp;quot;dob_child3&amp;quot;),
           variable.name = &amp;quot;child&amp;quot;, value.name = &amp;quot;dob&amp;quot;)
DT.m1
#     family_id age_mother      child        dob
#  1:         1         30 dob_child1 1998-11-26
#  2:         2         27 dob_child1 1996-06-22
#  3:         3         26 dob_child1 2002-07-11
#  4:         4         32 dob_child1 2004-10-10
#  5:         5         29 dob_child1 2000-12-05
#  6:         1         30 dob_child2 2000-01-29
#  7:         2         27 dob_child2         NA
#  8:         3         26 dob_child2 2004-04-05
#  9:         4         32 dob_child2 2009-08-27
# 10:         5         29 dob_child2 2005-02-28
# 11:         1         30 dob_child3         NA
# 12:         2         27 dob_child3         NA
# 13:         3         26 dob_child3 2007-09-02
# 14:         4         32 dob_child3 2012-07-21
# 15:         5         29 dob_child3         NA
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;é»˜è®¤çš„ï¼Œå‚æ•°id.vars æˆ– measure.vars ä¸­çš„ä¸€ä¸ªçœç•¥äº†ï¼Œå‰©ä½™çš„åˆ—è‡ªåŠ¨è¢«èµ‹å€¼ç»™çœç•¥çš„é‚£ä¸ªå‚æ•°ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœå‚æ•°id.vars å’Œ measure.vars éƒ½æ²¡æœ‰æŒ‡å®šï¼Œæ‰€æœ‰ä¸æ˜¯numbericï¼integerï¼logicalçš„åˆ—éƒ½ä¼šè¢«èµ‹å€¼ç»™ id.varsã€‚å¦å¤–ï¼Œç³»ç»Ÿè¿˜ä¼šè¾“å‡ºä¸€æ¡è­¦å‘Šæ¶ˆæ¯ï¼Œæç¤ºé‚£äº›åˆ—è¢«è®¤ä¸ºæ˜¯ id.varsã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;b-å‡½æ•°cast:8a0e17190d0dbfa1c06f28f3c1a1fd66&#34;&gt;b) å‡½æ•°cast&lt;/h4&gt;

&lt;p&gt;åœ¨å‰é¢ä¸€èŠ‚ï¼Œæˆ‘ä»¬çŸ¥é“å¦‚ä½•åˆ†æ‹†æ•°æ®ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å­¦ä¹ ç›¸åçš„æ“ä½œã€‚&lt;br /&gt;
ï¼å¦‚ä½•å°†åˆšåˆšåˆ†æ‹†çš„ DT.m è¿˜åŸæˆ DT&lt;br /&gt;
ä¹Ÿå°±æ˜¯ï¼Œæˆ‘ä»¬æƒ³æŠŠæ¯ä¸ªå®¶åº­ï¼æ¯äº²çš„æ‰€æœ‰å°å­©ï¼Œéƒ½åˆå¹¶åˆ°åŒä¸€è¡Œé‡Œã€‚æˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·ä½¿ç”¨å‡½æ•° dcast()ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dcast(DT.m1, family_id + age_mother ~ child, value.var = &amp;quot;dob&amp;quot;)
#    family_id age_mother dob_child1 dob_child2 dob_child3
# 1:         1         30 1998-11-26 2000-01-29         NA
# 2:         2         27 1996-06-22         NA         NA
# 3:         3         26 2002-07-11 2004-04-05 2007-09-02
# 4:         4         32 2004-10-10 2009-08-27 2012-07-21
# 5:         5         29 2000-12-05 2005-02-28         NA
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å‡½æ•° dcast() ä½¿ç”¨äº†æ“ä½œç¬¦â€œ~â€ï¼Œå·¦è¾¹æ˜¯ä½œä¸º id.vars çš„åˆ—ï¼Œå³è¾¹æ˜¯ä½œä¸º measure.vars çš„åˆ—ã€‚&lt;/li&gt;
&lt;li&gt;å‚æ•° value.var æŒ‡å®šäº†éœ€è¦è¢«åˆ†æ‹†æ‰©å¼ çš„åˆ—ã€‚&lt;/li&gt;
&lt;li&gt;å‡½æ•° dcast() ä¹Ÿä¼šåœ¨ç»“æœä¸­å°½é‡ä¿æŒåŸæ¥çš„å±æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ï¼å¯¹äº DT.mï¼Œå¦‚ä½•çŸ¥é“æ¯ä¸ªå®¶åº­æœ‰å‡ ä¸ªå°å­©&lt;br /&gt;
å¯ä»¥ç»™å‡½æ•° dcast() çš„å‚æ•° fun.aggregate ä¼ é€’ä¸€ä¸ªå‡½æ•°ã€‚å½“æ“ä½œç¬¦â€œ~â€ä¸æ–¹ä¾¿æŒ‡å®šåˆ—åçš„æ—¶å€™ï¼Œè¿™ä¸ªåŠŸèƒ½ç‰¹åˆ«æœ‰ç”¨ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dcast(DT.m1, family_id ~ ., fun.agg = function(x) sum(!is.na(x)), value.var = &amp;quot;dob&amp;quot;)
#    family_id .
# 1:         1 2
# 2:         2 1
# 3:         3 3
# 4:         4 3
# 5:         5 2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¾“å…¥ ?dcast å¯ä»¥æŸ¥çœ‹å…¶ä»–å‚æ•°å’Œä¾‹å­çš„è¯´æ˜ã€‚&lt;/p&gt;

&lt;h2 id=&#34;2-åŸç”Ÿçš„melt-dcastçš„å±€é™:8a0e17190d0dbfa1c06f28f3c1a1fd66&#34;&gt;2.åŸç”Ÿçš„meltï¼dcastçš„å±€é™&lt;/h2&gt;

&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å‡½æ•° melt å’Œ dcast çš„åŠŸèƒ½ï¼Œå®ƒä»¬æ˜¯åŸºäºå¢å¼ºåŒ… reshape2 çš„ã€‚ä½†æ˜¯å› ä¸ºä½¿ç”¨äº†data.tableçš„å†…éƒ¨æœºåˆ¶ï¼ˆå¿«é€Ÿæ’åºï¼ŒäºŒåˆ†æ³•æœç´¢ç­‰ï¼‰ï¼Œæ‰€ä»¥èƒ½æœ‰æ•ˆåœ°å¯¹data.tableå®è¡Œã€‚&lt;br /&gt;
ç„¶è€Œï¼Œä¹Ÿæœ‰ä¸€äº›æƒ…å†µï¼Œæˆ‘ä»¬æƒ³åšçš„æ“ä½œæ— æ³•å†™å¾—å¾ˆç®€æ´ã€‚æ¯”å¦‚ï¼Œè€ƒè™‘ä¸‹é¢è¿™ä¸ªdata.tableï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT = fread(&amp;quot;melt_enhanced.csv&amp;quot;)
DT
#    family_id age_mother dob_child1 dob_child2 dob_child3 gender_child1 gender_child2 gender_child3
# 1:         1         30 1998-11-26 2000-01-29         NA             1             2            NA
# 2:         2         27 1996-06-22         NA         NA             2            NA            NA
# 3:         3         26 2002-07-11 2004-04-05 2007-09-02             2             2             1
# 4:         4         32 2004-10-10 2009-08-27 2012-07-21             1             1             1
# 5:         5         29 2000-12-05 2005-02-28         NA             2             1            NA
## 1 = female, 2 = male
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚æœä½ æƒ³ç”¨æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢å­¦è¿‡çš„çŸ¥è¯†ï¼Œå°†æ¯ä¸ªå­©å­çš„ dob å’Œ gender åˆå¹¶åˆ°ä¸€è¡Œä¸­ï¼Œå¾—è¿™æ ·åšï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT.m1 = melt(DT, id = c(&amp;quot;family_id&amp;quot;, &amp;quot;age_mother&amp;quot;))
# Warning in melt.data.table(DT, id = c(&amp;quot;family_id&amp;quot;, &amp;quot;age_mother&amp;quot;)): &#39;measure.vars&#39; [dob_child1,
# dob_child2, dob_child3, gender_child1, gender_child2, gender_child3] are not all of the same
# type. By order of hierarchy, the molten data value column will be of type &#39;character&#39;. All measure
# variables not of type &#39;character&#39; will be coerced to. Check DETAILS in ?melt.data.table for more on
# coercion.
DT.m1[, c(&amp;quot;variable&amp;quot;, &amp;quot;child&amp;quot;) := tstrsplit(variable, &amp;quot;_&amp;quot;, fixed = TRUE)]
DT.c1 = dcast(DT.m1, family_id + age_mother + child ~ variable, value.var = &amp;quot;value&amp;quot;)
DT.c1
#     family_id age_mother  child        dob gender
#  1:         1         30 child1 1998-11-26      1
#  2:         1         30 child2 2000-01-29      2
#  3:         1         30 child3         NA     NA
#  4:         2         27 child1 1996-06-22      2
#  5:         2         27 child2         NA     NA
#  6:         2         27 child3         NA     NA
#  7:         3         26 child1 2002-07-11      2
#  8:         3         26 child2 2004-04-05      2
#  9:         3         26 child3 2007-09-02      1
# 10:         4         32 child1 2004-10-10      1
# 11:         4         32 child2 2009-08-27      1
# 12:         4         32 child3 2012-07-21      1
# 13:         5         29 child1 2000-12-05      2
# 14:         5         29 child2 2005-02-28      1
# 15:         5         29 child3         NA     NA

str(DT.c1) ## gender column is character type now!
# Classes &#39;data.table&#39; and &#39;data.frame&#39;:    15 obs. of  5 variables:
#  $ family_id : int  1 1 1 2 2 2 3 3 3 4 ...
#  $ age_mother: int  30 30 30 27 27 27 26 26 26 32 ...
#  $ child     : chr  &amp;quot;child1&amp;quot; &amp;quot;child2&amp;quot; &amp;quot;child3&amp;quot; &amp;quot;child1&amp;quot; ...
#  $ dob       : chr  &amp;quot;1998-11-26&amp;quot; &amp;quot;2000-01-29&amp;quot; NA &amp;quot;1996-06-22&amp;quot; ...
#  $ gender    : chr  &amp;quot;1&amp;quot; &amp;quot;2&amp;quot; NA &amp;quot;2&amp;quot; ...
#  - attr(*, &amp;quot;.internal.selfref&amp;quot;)=&amp;lt;externalptr&amp;gt; 
#  - attr(*, &amp;quot;sorted&amp;quot;)= chr  &amp;quot;family_id&amp;quot; &amp;quot;age_mother&amp;quot; &amp;quot;child&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é—®é¢˜ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æˆ‘ä»¬æƒ³åšçš„æ˜¯ï¼Œåˆ†åˆ«å°†æ¯ä¸ªå­©å­çš„ dob å’Œ gender åˆå¹¶åˆ°ä¸€è¡Œã€‚ä½†æ˜¯æˆ‘ä»¬å…ˆæŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½æ‹†åˆ†å¼€äº†ï¼Œå†å°†å®ƒä»¬åˆå¹¶ã€‚å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œè¿™å¤ªè¿‡è¿‚å›å’Œä½æ•ˆäº†ã€‚
ç±»ä¼¼çš„ï¼Œæƒ³æƒ³ä½ çš„å£æ©±é‡Œæœ‰4æ¶å­çš„è¡£æœï¼Œä½ æƒ³æŠŠç¬¬1æ¶å’Œç¬¬2æ¶çš„è¡£æœå…¨éƒ½æ”¾åˆ°ç¬¬1æ¶ä¸Šï¼ŒæŠŠç¬¬3æ¶å’Œç¬¬4æ¶çš„è¡£æœå…¨éƒ½æ”¾åˆ°ç¬¬3æ¶ä¸Šã€‚æˆ‘ä»¬åˆšåˆšåšçš„äº‹æƒ…ï¼Œå°±åƒæŠŠ4æ¶è¡£æœéƒ½æ”¾ä¸€èµ·ï¼Œå†åˆ†å¼€æ”¾åˆ°ç¬¬1æ¶å’Œç¬¬3æ¶ä¸Šï¼&lt;/li&gt;
&lt;li&gt;éœ€è¦è¢«æ•´åˆçš„åˆ—å¯èƒ½æ˜¯ä¸åŒçš„ç±»å‹ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œæ˜¯å­—ç¬¦å‹å’Œæ•´å‹ã€‚ä½¿ç”¨å‡½æ•°melt çš„æ—¶å€™ï¼Œè¿™äº›åˆ—è¢«ç¡¬å¡åˆ°ç»“æœé‡Œé¢ï¼Œæ­£å¦‚str(DT.c1)çš„è­¦å‘Šæ¶ˆæ¯æ‰€æç¤ºçš„ï¼Œgenderåˆ—è¢«è½¬åŒ–æˆäº†å­—ç¬¦å‹ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬å°†variableæ‹†åˆ†æˆäº†ä¸¤åˆ—ï¼Œå› æ­¤é¢å¤–å¤šäº†ä¸€åˆ—ï¼Œè¿™æ ·åšçš„ç›®çš„çœŸæ˜¯éå¸¸æ¨¡ç³Šã€‚æˆ‘ä»¬è¿™ä¹ˆåšæ˜¯å› ä¸ºä¸‹ä¸€æ­¥æˆ‘ä»¬éœ€è¦è½¬åŒ–è¿™ä¸€åˆ—ã€‚&lt;/li&gt;
&lt;li&gt;æœ€åï¼Œæˆ‘ä»¬æ•´åˆäº†æ•°æ®ã€‚ä½†æ˜¯é—®é¢˜æ˜¯æˆ‘ä»¬å¼•å…¥å¾ˆå¤šæ“ä½œã€‚ç‰¹åˆ«æ˜¯ï¼Œå¿…é¡»è¦è®¡ç®—ç­‰å¼ä¸­å˜é‡çš„é¡ºåºï¼Œä»£ä»·å¤ªå¤§ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;äº‹å®ä¸Šï¼Œbase::reshape æœ‰ç®€å•çš„å†™æ³•æ¥å®ç°è¿™ä¸ªæ“ä½œã€‚å®ƒéå¸¸æœ‰ç”¨ï¼Œè€Œä¸”ç»å¸¸è¢«ä½ä¼°ã€‚ä½ åº”è¯¥è¯•è¯•ï¼&lt;/p&gt;

&lt;h2 id=&#34;3-å¢å¼ºçš„æ–°åŠŸèƒ½:8a0e17190d0dbfa1c06f28f3c1a1fd66&#34;&gt;3.å¢å¼ºçš„æ–°åŠŸèƒ½&lt;/h2&gt;

&lt;h4 id=&#34;a-å¢å¼ºçš„melt:8a0e17190d0dbfa1c06f28f3c1a1fd66&#34;&gt;a) å¢å¼ºçš„melt&lt;/h4&gt;

&lt;p&gt;æ—¢ç„¶æˆ‘ä»¬å¸Œæœ›ç®€å•åœ°å®ç°åŒæ ·çš„æ“ä½œï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªé¢å¤–çš„åŠŸèƒ½ï¼Œè¿™æ ·å°±å¯ä»¥åŒæ—¶æ“ä½œå¤šä¸ªåˆ—ã€‚&lt;br /&gt;
ï¼ç”¨å‡½æ•°melt åŒæ—¶æ‹†åˆ†å¤šä¸ªåˆ—&lt;br /&gt;
è¿™ä¸ªåŠæ³•å¾ˆç®€å•ã€‚æˆ‘ä»¬ç»™å‚æ•° measure.vars ä¼ é€’ä¸€ä¸ªåˆ—è¡¨ï¼Œè¿™ä¸ªåˆ—è¡¨çš„æ¯ä¸ªå…ƒç´ åŒ…å«éœ€è¦è¢«åˆå¹¶çš„åˆ—ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;colA = paste(&amp;quot;dob_child&amp;quot;, 1:3, sep = &amp;quot;&amp;quot;)
colB = paste(&amp;quot;gender_child&amp;quot;, 1:3, sep = &amp;quot;&amp;quot;)
DT.m2 = melt(DT, measure = list(colA, colB), value.name = c(&amp;quot;dob&amp;quot;, &amp;quot;gender&amp;quot;))
DT.m2
#     family_id age_mother variable        dob gender
#  1:         1         30        1 1998-11-26      1
#  2:         2         27        1 1996-06-22      2
#  3:         3         26        1 2002-07-11      2
#  4:         4         32        1 2004-10-10      1
#  5:         5         29        1 2000-12-05      2
#  6:         1         30        2 2000-01-29      2
#  7:         2         27        2         NA     NA
#  8:         3         26        2 2004-04-05      2
#  9:         4         32        2 2009-08-27      1
# 10:         5         29        2 2005-02-28      1
# 11:         1         30        3         NA     NA
# 12:         2         27        3         NA     NA
# 13:         3         26        3 2007-09-02      1
# 14:         4         32        3 2012-07-21      1
# 15:         5         29        3         NA     NA

str(DT.m2) ## col type is preserved
# Classes &#39;data.table&#39; and &#39;data.frame&#39;:    15 obs. of  5 variables:
#  $ family_id : int  1 2 3 4 5 1 2 3 4 5 ...
#  $ age_mother: int  30 27 26 32 29 30 27 26 32 29 ...
#  $ variable  : Factor w/ 3 levels &amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;: 1 1 1 1 1 2 2 2 2 2 ...
#  $ dob       : chr  &amp;quot;1998-11-26&amp;quot; &amp;quot;1996-06-22&amp;quot; &amp;quot;2002-07-11&amp;quot; &amp;quot;2004-10-10&amp;quot; ...
#  $ gender    : int  1 2 2 1 2 2 NA 2 1 1 ...
#  - attr(*, &amp;quot;.internal.selfref&amp;quot;)=&amp;lt;externalptr&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼å‡½æ•° patterns()&lt;br /&gt;
é€šå¸¸ï¼Œæˆ‘ä»¬æƒ³æ•´åˆçš„è¿™äº›åˆ—çš„åˆ—åéƒ½æœ‰å…±é€šçš„æ ¼å¼ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å‡½æ•°patterns()æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼ï¼Œè®©è¯­æ³•æ›´ç®€æ´ã€‚ä¸Šé¢çš„æ“ä½œè¿˜å¯ä»¥è¿™æ ·å†™ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT.m2 = melt(DT, measure = patterns(&amp;quot;^dob&amp;quot;, &amp;quot;^gender&amp;quot;), value.name = c(&amp;quot;dob&amp;quot;, &amp;quot;gender&amp;quot;))
DT.m2
#     family_id age_mother variable        dob gender
#  1:         1         30        1 1998-11-26      1
#  2:         2         27        1 1996-06-22      2
#  3:         3         26        1 2002-07-11      2
#  4:         4         32        1 2004-10-10      1
#  5:         5         29        1 2000-12-05      2
#  6:         1         30        2 2000-01-29      2
#  7:         2         27        2         NA     NA
#  8:         3         26        2 2004-04-05      2
#  9:         4         32        2 2009-08-27      1
# 10:         5         29        2 2005-02-28      1
# 11:         1         30        3         NA     NA
# 12:         2         27        3         NA     NA
# 13:         3         26        3 2007-09-02      1
# 14:         4         32        3 2012-07-21      1
# 15:         5         29        3         NA     NA
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å°±æ˜¯è¿™æ ·ï¼&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å¦‚æœéœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥å»æ‰ variableåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;è¿™ä¸ªåŠŸèƒ½æ˜¯ç”¨Cå®ç°çš„ï¼Œå› æ­¤æ•ˆç‡é«˜ï¼ŒèŠ‚çœå†…å­˜ï¼Œè€Œä¸”ç®€æ´ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;b-å¢å¼ºçš„dcast:8a0e17190d0dbfa1c06f28f3c1a1fd66&#34;&gt;b) å¢å¼ºçš„dcast&lt;/h4&gt;

&lt;p&gt;éå¸¸å¥½ï¼ç°åœ¨æˆ‘ä»¬å¯ä»¥åŒæ—¶æ‹†åˆ†å¤šä¸ªåˆ—äº†ã€‚ç°åœ¨æˆ‘ä»¬å¦‚ä½•å°†ä¸Šé¢çš„ DT.m2 å†æ¢å¤æˆåŸæ¥çš„æ ·å­å‘¢ï¼Ÿ&lt;br /&gt;
å¦‚æœæˆ‘ä»¬ä½¿ç”¨åŸç”Ÿçš„å‡½æ•°dcast()ï¼Œæˆ‘ä»¬éœ€è¦åšä¸¤æ¬¡ï¼Œç„¶åå°†ç»“æœåˆå¹¶åœ¨ä¸€èµ·ã€‚ä½†æ˜¯è¿™æ ·åšå¤ªéº»çƒ¦ï¼Œä¸€ç‚¹ä¹Ÿä¸ç®€æ´å’Œæœ‰æ•ˆã€‚&lt;br /&gt;
ï¼åŒæ—¶åˆå¹¶å¤šä¸ª value.vars&lt;br /&gt;
æˆ‘ä»¬å¯ä»¥å¯¹å‡½æ•°dcast()æŒ‡å®šå¤šä¸ª value.varå‚æ•°ï¼Œè¿™æ ·æ“ä½œå°±åœ¨å†…éƒ¨è¿›è¡Œï¼Œè€Œä¸”é«˜æ•ˆã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;## new &#39;cast&#39; functionality - multiple value.vars
DT.c2 = dcast(DT.m2, family_id + age_mother ~ variable, value.var = c(&amp;quot;dob&amp;quot;, &amp;quot;gender&amp;quot;))
DT.c2
#    family_id age_mother      dob_1      dob_2      dob_3 gender_1 gender_2 gender_3
# 1:         1         30 1998-11-26 2000-01-29         NA        1        2       NA
# 2:         2         27 1996-06-22         NA         NA        2       NA       NA
# 3:         3         26 2002-07-11 2004-04-05 2007-09-02        2        2        1
# 4:         4         32 2004-10-10 2009-08-27 2012-07-21        1        1        1
# 5:         5         29 2000-12-05 2005-02-28         NA        2        1       NA
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;åœ¨ç»“æœä¸­ï¼ŒåŸå…ˆçš„å±æ€§ä¼šå°½é‡ä¿æŒã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰çš„äº‹æƒ…éƒ½åœ¨å†…éƒ¨é«˜æ•ˆå¤„ç†ã€‚å¿«é€Ÿå¹¶ä¸”èŠ‚çœå†…å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å‚æ•°fun.aggregateå¯ä»¥æŒ‡å®šå¤šä¸ªå‡½æ•°ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ä½ å¯ä»¥ç»™å‡½æ•°dcast()çš„å‚æ•°fun.aggregateå¯ä»¥æŒ‡å®šå¤šä¸ªå‡½æ•°ã€‚è¯¦ç»†å†…å®¹è¯·æ‰§è¡Œ ?dcast æ¥æŸ¥çœ‹ç¤ºä¾‹ã€‚
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>data.table æ•™ç¨‹4ï¼ˆæ ¡å¯¹ä¸­ï¼‰</title>
      <link>http://youngspring1.github.io/post/2016/2016-04-02-datatable4/</link>
      <pubDate>Sat, 02 Apr 2016 07:38:11 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-04-02-datatable4/</guid>
      <description>

&lt;p&gt;ç›®å½•ï¼š&lt;br /&gt;
1) &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-13-datatable1/&#34;&gt;data.table ä»‹ç»&lt;/a&gt;&lt;br /&gt;
2) &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-21-datatable2/&#34;&gt;è¯­ä¹‰å¼•ç”¨&lt;/a&gt;&lt;br /&gt;
3) &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-22-datatable3/&#34;&gt;ä¸»é”®ã€åŸºäºå¿«é€ŸäºŒåˆ†æ³•æœç´¢çš„subset&lt;/a&gt;&lt;br /&gt;
4) äºŒçº§ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•&lt;br /&gt;
5) Efficient reshaping using data.tables&lt;/p&gt;

&lt;p&gt;åŸæ–‡åœ°å€ï¼š&lt;br /&gt;
1) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-intro-vignette.html&#34;&gt;Introduction to data.table&lt;/a&gt;&lt;br /&gt;
2) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-reference-semantics.html&#34;&gt;Reference semantics&lt;/a&gt;&lt;br /&gt;
3) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-keys-fast-subset.html&#34;&gt;Keys and fast binary search based subsets&lt;/a&gt;&lt;br /&gt;
4) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-secondary-indices-and-auto-indexing.html&#34;&gt;Secondary indices and auto indexing&lt;/a&gt;&lt;br /&gt;
5) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-reshape.html&#34;&gt;Efficient reshaping using data.tables&lt;/a&gt;&lt;br /&gt;
6) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-faq.html&#34;&gt;Frequently asked questions&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&#34;äºŒçº§ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•:3887792cd19298be3383c54afb194a11&#34;&gt;äºŒçº§ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•&lt;/h1&gt;

&lt;p&gt;æœ¬æ•™ç¨‹å‡å®šè¯»è€…å·²ç»ç†Ÿæ‚‰data.tableçš„[i, j, by]è¯­æ³•ã€æ‡‚å¾—å¦‚ä½•åŸºäºäºŒåˆ†æ³•çš„é€‰å–äº†ã€‚å¦‚æœä½ å¯¹è¿™äº›ä¸ç†Ÿæ‚‰ï¼Œè¯·å­¦ä¹ ä¸Šé¢ä¸‰è®² &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-13-datatable1/&#34;&gt;data.table ä»‹ç»&lt;/a&gt; ã€ &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-21-datatable2/&#34;&gt;è¯­ä¹‰å¼•ç”¨&lt;/a&gt;å’Œ&lt;a href=&#34;http://youngspring1.github.io/post/2016-03-22-datatable3/&#34;&gt;ä¸»é”®ã€åŸºäºå¿«é€ŸäºŒåˆ†æ³•æœç´¢çš„subset&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;æ•°æ®:3887792cd19298be3383c54afb194a11&#34;&gt;æ•°æ®&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬ç»§ç»­ä½¿ç”¨å·²ç»ä¿å­˜åˆ°æœ¬åœ°çš„èˆªç­ä¿¡æ¯flightsã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights &amp;lt;- fread(&amp;quot;flights14.csv&amp;quot;)
head(flights)
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014     1   1        14        13      AA    JFK  LAX      359     2475    9
# 2: 2014     1   1        -3        13      AA    JFK  LAX      363     2475   11
# 3: 2014     1   1         2         9      AA    JFK  LAX      351     2475   19
# 4: 2014     1   1        -8       -26      AA    LGA  PBI      157     1035    7
# 5: 2014     1   1         2         1      AA    JFK  LAX      350     2475   13
# 6: 2014     1   1         4         0      AA    EWR  LAX      339     2454   18
dim(flights)
# [1] 253316     11
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;ä»‹ç»:3887792cd19298be3383c54afb194a11&#34;&gt;ä»‹ç»&lt;/h2&gt;

&lt;p&gt;åœ¨è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä¼šï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;è®¨è®ºäºŒçº§ç´¢å¼•ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;å†æ¬¡æ¼”ç¤ºå¿«é€Ÿsubsetï¼Œä½†è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨æ–°çš„å‚æ•°onï¼Œå®ƒèƒ½è‡ªåŠ¨è®¾ç½®äºŒçº§ç´¢å¼•ã€‚&lt;/li&gt;
&lt;li&gt;æœ€åè¿›ä¸€æ­¥çš„ï¼Œæ¥çœ‹ä¸€ä¸‹è‡ªåŠ¨ç´¢å¼•ï¼Œå®ƒä¹Ÿèƒ½è‡ªåŠ¨è®¾ç½®ç´¢å¼•ï¼Œä½†æ˜¯å®ƒæ˜¯åŸºäºRçš„åŸç”Ÿè¯­æ³•æ¥åšsubsetçš„ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;1-äºŒçº§ç´¢å¼•:3887792cd19298be3383c54afb194a11&#34;&gt;1.äºŒçº§ç´¢å¼•&lt;/h2&gt;

&lt;h4 id=&#34;a-ä»€ä¹ˆæ˜¯äºŒçº§ç´¢å¼•:3887792cd19298be3383c54afb194a11&#34;&gt;a) ä»€ä¹ˆæ˜¯äºŒçº§ç´¢å¼•&lt;/h4&gt;

&lt;p&gt;äºŒçº§ç´¢å¼•å’Œdata.tableçš„ä¸»é”®ç±»ä¼¼ï¼Œä½†æœ‰ä»¥ä¸‹ä¸¤ç‚¹ä¸åŒï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å®ƒä¸ä¼šå†å†…å­˜é‡Œå°†æ•´ä¸ªdata.tableé‡æ–°æ’åºã€‚å®ƒåªä¼šè®¡ç®—æŸåˆ—çš„é¡ºåºï¼Œå°†è¿™ä¸ªé¡ºåºå‘é‡ä¿å­˜åœ¨ä¸€ä¸ªé¢å¤–çš„ï¼Œå«åšindexçš„å±æ€§é‡Œé¢ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªdata.tableå¯ä»¥æœ‰å¤šä¸ªäºŒçº§ç´¢å¼•ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸‹é¢è¦æ¼”ç¤ºçš„ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;b-è®¾ç½®å’Œè·å–äºŒçº§ç´¢å¼•:3887792cd19298be3383c54afb194a11&#34;&gt;b) è®¾ç½®å’Œè·å–äºŒçº§ç´¢å¼•&lt;/h4&gt;

&lt;p&gt;ï¼å¦‚ä½•å°†originåˆ—è®¾ç½®ä¸ºè¯¥data.tableçš„äºŒçº§ç´¢å¼•&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;setindex(flights, origin)
head(flights)
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014     1   1        14        13      AA    JFK  LAX      359     2475    9
# 2: 2014     1   1        -3        13      AA    JFK  LAX      363     2475   11
# 3: 2014     1   1         2         9      AA    JFK  LAX      351     2475   19
# 4: 2014     1   1        -8       -26      AA    LGA  PBI      157     1035    7
# 5: 2014     1   1         2         1      AA    JFK  LAX      350     2475   13
# 6: 2014     1   1         4         0      AA    EWR  LAX      339     2454   18

## alternatively we can provide character vectors to the function &#39;setindexv()&#39;
# setindexv(flights, &amp;quot;origin&amp;quot;) # useful to program with

# &#39;index&#39; attribute added
names(attributes(flights))
# [1] &amp;quot;names&amp;quot;             &amp;quot;row.names&amp;quot;         &amp;quot;class&amp;quot;             &amp;quot;.internal.selfref&amp;quot;
# [5] &amp;quot;index&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å‡½æ•°setindex å’Œ setindexv()å¯ä»¥å¯¹data.tableæ·»åŠ ä¸€ä¸ªäºŒçº§ç´¢å¼•ã€‚&lt;/li&gt;
&lt;li&gt;æ³¨æ„flightså®é™…ä¸Šæ²¡æœ‰æŒ‰ç…§originåˆ—çš„å‡åºé‡æ–°æ’åˆ—ã€‚è¿˜è®°å¾—å—ï¼Ÿsetkey()ä¼šé‡æ–°æ’åºï¼&lt;/li&gt;
&lt;li&gt;setindex(flights, NULL)ä¼šåˆ é™¤æ‰€æœ‰çš„äºŒçº§ç´¢å¼•ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ï¼å¦‚ä½•å–å¾—flightsçš„äºŒçº§ç´¢å¼•&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;indices(flights)
# [1] &amp;quot;origin&amp;quot;

setindex(flights, origin, dest)
indices(flights)
# [1] &amp;quot;origin&amp;quot;       &amp;quot;origin__dest&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å‡½æ•°indices()è¿”å›ä¸€ä¸ªdata.tableæ‰€æœ‰çš„äºŒçº§ç´¢å¼•ã€‚å¦‚æœè¯¥data.tableæ²¡æœ‰äºŒçº§ç´¢å¼•ï¼Œé‚£ä¹ˆè¿”å›NULLã€‚&lt;/li&gt;
&lt;li&gt;æ³¨æ„æˆ‘ä»¬å¯¹ originåˆ—,deståˆ—åˆ›å»ºäº†å¦ä¸€ä¸ªäºŒçº§ç´¢å¼•çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¸¢æ‰ä¹‹å‰åˆ›å»ºçš„ç¬¬ä¸€ä¸ªäºŒçº§ç´¢å¼•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¤šä¸ªäºŒçº§ç´¢å¼•ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;c-ä¸ºä»€ä¹ˆä½¿ç”¨äºŒçº§ç´¢å¼•:3887792cd19298be3383c54afb194a11&#34;&gt;c) ä¸ºä»€ä¹ˆä½¿ç”¨äºŒçº§ç´¢å¼•&lt;/h4&gt;

&lt;p&gt;ï¼å¯¹ä¸€ä¸ªdata.tableé‡æ–°æ’åºæˆæœ¬å¤ªé«˜
è€ƒè™‘ä¸€ä¸‹è¿™ç§æƒ…å†µï¼Œå½“ä½ æƒ³ç”¨ä¸»é”®originåˆ—æ¥subsetæ‰€æœ‰â€œJFKâ€çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾—è¿™ä¹ˆåšï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;## not run
setkey(flights, origin)
flights[&amp;quot;JFK&amp;quot;] # or flights[.(&amp;quot;JFK&amp;quot;)]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;setkey()éœ€è¦ï¼š
a.è®¡ç®—å¾—å‡ºoriginåˆ—çš„æ’åºå‘é‡ï¼Œå¹¶ä¸”
b.åŸºäºåˆšåˆšçš„æ’åºå‘é‡ï¼Œå¯¹æ•´ä¸ªdata.tableé‡æ–°æ’åº
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ’åºå¹¶ä¸æ˜¯æœ€èŠ±æ—¶é—´çš„ï¼Œå› ä¸ºdata.tableä½¿ç”¨å¯¹æ•´å‹ã€å­—ç¬¦å‹ã€æ•°å€¼å‹çš„å‘é‡è¿›è¡Œradixæ’åºã€‚ç„¶è€Œé‡æ–°æ’åºå´å¾ˆèŠ±æ—¶é—´ã€‚&lt;br /&gt;
é™¤éæˆ‘ä»¬éœ€è¦å¯¹æŸä¸€åˆ—é‡å¤åœ°è¿›è¡Œsubsetï¼Œå¦åˆ™äºŒåˆ†æ³•å¿«é€Ÿsubsetçš„é«˜æ•ˆå¯èƒ½è¢«é‡æ–°æ’åºæŠµæ¶ˆã€‚&lt;/p&gt;

&lt;p&gt;ï¼ä¸ºæ·»åŠ ï¼æ›´æ–°åˆ—è€Œå¯¹æ•´ä¸ªdata.tableé‡æ–°æ’åºå¹¶ä¸ç†æƒ³&lt;br /&gt;
ï¼æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªä¸»é”®&lt;br /&gt;
ç°åœ¨æˆ‘ä»¬å¦‚æœæƒ³å¯¹deståˆ—æ˜¯â€œLAXâ€çš„è¡Œï¼Œé‡å¤åœ°è¿›è¡ŒæŸä¸ªç‰¹å®šçš„æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»å†è°ƒç”¨å‡½æ•°setkey() è®¾ç½®ä¸€æ¬¡ä¸»é”®ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;## not run
setkey(flights, dest)
flights[&amp;quot;LAX&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·ï¼Œflightsåˆå†æ¬¡æŒ‰deståˆ—é‡æ–°æ’åºäº†ã€‚å…¶å®æˆ‘ä»¬çœŸæ­£æƒ³åšçš„æ˜¯ï¼Œå¿«é€Ÿåœ°subsetåŒæ—¶åˆä¸å¿…é‡æ–°æ’åºã€‚&lt;br /&gt;
è¿™æ—¶å€™ï¼ŒäºŒçº§ç´¢å¼•å°±æ´¾ä¸Šç”¨åœºäº†ï¼&lt;/p&gt;

&lt;p&gt;ï¼äºŒçº§ç´¢å¼•å¯ä»¥è¢«é‡ç”¨&lt;br /&gt;
æ—¢ç„¶ä¸€ä¸ªdata.tableä¸­å¯ä»¥æœ‰å¤šä¸ªäºŒçº§ç´¢å¼•ï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªäºŒçº§ç´¢å¼•å°±å’Œå°†ä¸€ä¸ªæ’åºå‘é‡ä¿å­˜ä¸ºå±æ€§ä¸€æ ·ç®€å•ï¼Œé‚£ä¹ˆåˆ›å»ºäºŒçº§ç´¢å¼•åï¼Œæˆ‘ä»¬å¯ä»¥çœä¸‹é‡æ–°æ’åºçš„æ—¶é—´ã€‚&lt;br /&gt;
ï¼å‚æ•°onä½¿å¾—è¯­æ³•æ›´ç®€æ´ï¼Œå¹¶ä¸”èƒ½è‡ªåŠ¨åˆ›å»ºå¹¶é‡ç”¨äºŒçº§ç´¢å¼•&lt;br /&gt;
æˆ‘ä»¬ä¸‹é¢ä¸€èŠ‚ä¼šè¯´æ˜å‚æ•°onçš„å‡ ä¸ªä¼˜ç‚¹ï¼š&lt;/p&gt;

&lt;p&gt;å‚æ•°on&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;é€šè¿‡åˆ›å»ºç´¢å¼•è¿›è¡Œsubsetã€‚æ¯æ¬¡éƒ½èƒ½èŠ‚çœsetindex()çš„æ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡æ£€æŸ¥å±æ€§ï¼Œå¯ä»¥ç®€å•åœ°é‡ç”¨å·²ç»å­˜åœ¨çš„äºŒçº§ç´¢å¼•ã€‚&lt;/li&gt;
&lt;li&gt;è¯­æ³•ç®€å•ã€‚
æ³¨æ„å‚æ•°onä¹Ÿå¯ä»¥ç”¨æ¥æŒ‡å®šä¸»é”®ã€‚äº‹å®ä¸Šï¼Œä¸ºäº†æ›´ä½³çš„å¯è¯»æ€§ï¼Œæˆ‘ä»¬é¼“åŠ±åœ¨å‚æ•°oné‡Œé¢æŒ‡å®šä¸»é”®ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;2-ä½¿ç”¨å‚æ•°onå’Œç´¢å¼•è¿›è¡Œå¿«é€Ÿsubset:3887792cd19298be3383c54afb194a11&#34;&gt;2.ä½¿ç”¨å‚æ•°onå’Œç´¢å¼•è¿›è¡Œå¿«é€Ÿsubset&lt;/h2&gt;

&lt;h4 id=&#34;a-å‚æ•°ié‡Œçš„subset:3887792cd19298be3383c54afb194a11&#34;&gt;a) å‚æ•°ié‡Œçš„subset&lt;/h4&gt;

&lt;p&gt;ï¼subsetæ‰€æœ‰originæ˜¯â€œJFKâ€çš„è¡Œ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[&amp;quot;JFK&amp;quot;, on = &amp;quot;origin&amp;quot;]
#        year month day dep_delay arr_delay carrier origin dest air_time distance hour
#     1: 2014     1   1        14        13      AA    JFK  LAX      359     2475    9
#     2: 2014     1   1        -3        13      AA    JFK  LAX      363     2475   11
#     3: 2014     1   1         2         9      AA    JFK  LAX      351     2475   19
#     4: 2014     1   1         2         1      AA    JFK  LAX      350     2475   13
#     5: 2014     1   1        -2       -18      AA    JFK  LAX      338     2475   21
#    ---
# 81479: 2014    10  31        -4       -21      UA    JFK  SFO      337     2586   17
# 81480: 2014    10  31        -2       -37      UA    JFK  SFO      344     2586   18
# 81481: 2014    10  31         0       -33      UA    JFK  LAX      320     2475   17
# 81482: 2014    10  31        -6       -38      UA    JFK  SFO      343     2586    9
# 81483: 2014    10  31        -6       -38      UA    JFK  LAX      323     2475   11

## alternatively
# flights[.(&amp;quot;JFK&amp;quot;), on = &amp;quot;origin&amp;quot;] (or) 
# flights[list(&amp;quot;JFK&amp;quot;), on = &amp;quot;origin&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;è¿™æ®µè¯­å¥æ‰§è¡Œçš„subsetä¹Ÿæ˜¯é€šè¿‡åˆ›å»ºäºŒçº§ç´¢å¼•ï¼ŒåŸºäºå¿«é€ŸäºŒåˆ†æ³•æœç´¢çš„ã€‚ä½†è®°ä½ï¼Œå®ƒä¸ä¼šæŠŠè¿™ä¸ªäºŒçº§ç´¢å¼•è‡ªåŠ¨åˆ›å»ºä¸ºdata.tableçš„ä¸€ä¸ªå±æ€§ã€‚å½“ç„¶åé¢æˆ‘ä»¬ä¹Ÿä¼šæ•™ä½ å¦‚ä½•å°†å®ƒè®¾ç½®ä¸ºä¸€ä¸ªå±æ€§ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;å¦‚æœæˆ‘ä»¬å·²ç»æ·»åŠ äº†ä¸€ä¸ªäºŒçº§ç´¢å¼•äº†ï¼Œé‚£ä¹ˆå‚æ•°onå°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªäºŒçº§ç´¢å¼•ï¼Œè€Œä¸æ˜¯å†å¯¹æ•´ä¸ªèˆªç­ä¿¡æ¯flightsè¿›è¡Œè®¡ç®—ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æˆ‘ä»¬æ¥çœ‹ä¸‹é¢ verbose = TRUE çš„ç”¨æ³•ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;setindex(flights, origin)
flights[&amp;quot;JFK&amp;quot;, on = &amp;quot;origin&amp;quot;, verbose = TRUE][1:5]
# names(on) = NULL. Assigning &#39;on&#39; to names(on)&#39; as well.
# Looking for existing (secondary) index... found. Reusing index.
# Starting bmerge ...done in 0 secs
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014     1   1        14        13      AA    JFK  LAX      359     2475    9
# 2: 2014     1   1        -3        13      AA    JFK  LAX      363     2475   11
# 3: 2014     1   1         2         9      AA    JFK  LAX      351     2475   19
# 4: 2014     1   1         2         1      AA    JFK  LAX      350     2475   13
# 5: 2014     1   1        -2       -18      AA    JFK  LAX      338     2475   21
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼å¦‚ä½•å¯¹originåˆ—å’Œdeståˆ—è¿›è¡Œsubset
ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³é€‰å–æ‰€æœ‰ä»â€œJFKâ€èµ·é£åˆ°è¾¾â€œLAXâ€çš„æ‰€æœ‰èˆªç­ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(&amp;quot;JFK&amp;quot;, &amp;quot;LAX&amp;quot;), on = c(&amp;quot;origin&amp;quot;, &amp;quot;dest&amp;quot;)][1:5]
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014     1   1        14        13      AA    JFK  LAX      359     2475    9
# 2: 2014     1   1        -3        13      AA    JFK  LAX      363     2475   11
# 3: 2014     1   1         2         9      AA    JFK  LAX      351     2475   19
# 4: 2014     1   1         2         1      AA    JFK  LAX      350     2475   13
# 5: 2014     1   1        -2       -18      AA    JFK  LAX      338     2475   21
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;åœ¨å‚æ•°ié‡Œé¢æŒ‡å®šå–å€¼ï¼Œåœ¨å‚æ•°oné‡Œé¢æŒ‡å®šåˆ—åã€‚å‚æ•°onå¿…é¡»æ˜¯ä¸€ä¸ªå­—ç¬¦å‹çš„å‘é‡ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;å› ä¸ºè®¡ç®—ç´¢å¼•éå¸¸å¿«ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨setindex()ã€‚é™¤éä½ éœ€è¦å¯¹æŸä¸€åˆ—é‡å¤åœ°è¿›è¡Œsubsetæ“ä½œã€‚&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;b-å‚æ•°jé‡Œçš„select:3887792cd19298be3383c54afb194a11&#34;&gt;b) å‚æ•°jé‡Œçš„select&lt;/h4&gt;

&lt;p&gt;ä¸‹é¢æˆ‘ä»¬å°†è¦è®¨è®ºçš„æ‰€æœ‰æ“ä½œï¼Œè·Ÿæˆ‘ä»¬åœ¨ä¸Šä¸€è®²é‡Œé¢å­¦ä¹ çš„ç±»ä¼¼ã€‚åªæ˜¯æˆ‘ä»¬ç°åœ¨ä½¿ç”¨å‚æ•°onã€‚&lt;br /&gt;
ï¼è¿”å›æ»¡è¶³æ¡ä»¶ origin = &amp;ldquo;LGA&amp;rdquo; and dest = &amp;ldquo;TPA&amp;rdquo;çš„ arr_delayåˆ—çš„å€¼&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(&amp;quot;LGA&amp;quot;, &amp;quot;TPA&amp;quot;), .(arr_delay), on = c(&amp;quot;origin&amp;quot;, &amp;quot;dest&amp;quot;)]
#       arr_delay
#    1:         1
#    2:        14
#    3:       -17
#    4:        -4
#    5:       -12
#   ---          
# 1848:        39
# 1849:       -24
# 1850:       -12
# 1851:        21
# 1852:       -11
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;c-chaining:3887792cd19298be3383c54afb194a11&#34;&gt;c) Chaining&lt;/h4&gt;

&lt;p&gt;ï¼åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šï¼Œä½¿ç”¨chainingæ¥å°†ç»“æœé™åºæ’åˆ—&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(&amp;quot;LGA&amp;quot;, &amp;quot;TPA&amp;quot;), .(arr_delay), on = c(&amp;quot;origin&amp;quot;, &amp;quot;dest&amp;quot;)][order(-arr_delay)]
#       arr_delay
#    1:       486
#    2:       380
#    3:       351
#    4:       318
#    5:       300
#   ---          
# 1848:       -40
# 1849:       -43
# 1850:       -46
# 1851:       -48
# 1852:       -49
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;d-å‚æ•°jé‡Œçš„è®¡ç®—:3887792cd19298be3383c54afb194a11&#34;&gt;d) å‚æ•°jé‡Œçš„è®¡ç®—&lt;/h4&gt;

&lt;p&gt;ï¼æ‰¾å‡ºæ»¡è¶³æ¡ä»¶ origin = &amp;ldquo;LGA&amp;rdquo; and dest = &amp;ldquo;TPA&amp;rdquo;çš„ arr_delayåˆ—çš„æœ€å¤§å€¼ï¼ˆèˆªç­åˆ°è¾¾çš„æœ€é•¿å»¶è¯¯æ—¶é—´ï¼‰&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(&amp;quot;LGA&amp;quot;, &amp;quot;TPA&amp;quot;), max(arr_delay), on = c(&amp;quot;origin&amp;quot;, &amp;quot;dest&amp;quot;)]
# [1] 486
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;e-å‚æ•°jé‡Œä½¿ç”¨æ“ä½œç¬¦-è¿›è¡Œsub-assign:3887792cd19298be3383c54afb194a11&#34;&gt;e) å‚æ•°jé‡Œä½¿ç”¨æ“ä½œç¬¦&amp;rdquo;:=&amp;ldquo;è¿›è¡Œsub-assign&lt;/h4&gt;

&lt;p&gt;åœ¨ä¸Šä¸€è®²ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ è¿‡äº†ç±»ä¼¼çš„åŠŸèƒ½ã€‚åŒæ ·åœ°ï¼Œç°åœ¨æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•æ‰¾åˆ°åœ¨flightsé‡Œé¢ï¼Œhoursåˆ—æ‰€æœ‰å¯èƒ½çš„å–å€¼ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# get all &#39;hours&#39; in flights
flights[, sort(unique(hour))]
#  [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œä¸€å…±æœ‰25ç§ä¸åŒçš„å–å€¼ã€‚ä½†æ˜¯0ç‚¹å’Œ24ç‚¹å…¶å®æ˜¯åŒæ ·çš„ã€‚ä¸‹é¢æˆ‘ä»¬æŠŠ24å…¨éƒ¨æ›¿æ¢æˆ0ï¼Œä½†æ˜¯è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨å‚æ•°onã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(24L), hour := 0L, on = &amp;quot;hour&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç°åœ¨æˆ‘ä»¬å†æ¥çœ‹çœ‹24æ˜¯ä¸æ˜¯éƒ½è¢«æ›¿æ¢æˆ0äº†ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[, sort(unique(hour))]
#  [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;è¿™çœŸæ˜¯äºŒçº§ç´¢å¼•çš„ä¸€å¤§ä¼˜ç‚¹ã€‚ä»¥å‰ï¼Œåªæ˜¯ä¸ºäº†æ›´æ–°ä¸€äº›è¡Œçš„houråˆ—çš„å–å€¼ï¼Œæˆ‘ä»¬ä¸å¾—ä¸è°ƒç”¨å‡½æ•°setkey()å°†houråˆ—è®¾ç½®ä¸ºä¸»é”®ï¼Œè¿™å¿…é¡»å¯¹æ•´ä¸ªdata.tableè¿›è¡Œé‡æ–°æ’åºã€‚ä½†æ˜¯ç°åœ¨ï¼Œç”¨å‚æ•°onï¼ŒåŸæ•°æ®çš„é¡ºåºå¹¶æ²¡æœ‰æ”¹å˜ï¼Œæ“ä½œåè€Œæ›´å¿«äº†ï¼è€Œä»£ç è¿˜æ˜¯å¦‚æ­¤ç®€æ´ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;f-é€šè¿‡å‚æ•°byèšåˆ:3887792cd19298be3383c54afb194a11&#34;&gt;f) é€šè¿‡å‚æ•°byèšåˆ&lt;/h4&gt;

&lt;p&gt;ï¼æ‰¾åˆ°æ¯æœˆä»â€œJFKâ€èµ·é£çš„èˆªç­èµ·é£çš„æœ€é•¿å»¶è¯¯æ—¶é—´ï¼Œå¹¶æŒ‰ç…§æœˆä»½æ’åº&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[&amp;quot;JFK&amp;quot;, max(dep_delay), keyby = month, on = &amp;quot;origin&amp;quot;]
head(ans)
#    month   V1
# 1:     1  881
# 2:     2 1014
# 3:     3  920
# 4:     4 1241
# 5:     5  853
# 6:     6  798
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨äºŒçº§ç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯ä¸åœ¨å‚æ•°oné‡Œé¢æŒ‡å®šï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¿…é¡»æŠŠoriginè®¾ç½®ä¸ºä¸»é”®ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;g-å‚æ•°mult:3887792cd19298be3383c54afb194a11&#34;&gt;g) å‚æ•°mult&lt;/h4&gt;

&lt;p&gt;å‚æ•°multå’Œä¸Šä¸€è®²ä¸€æ ·ã€‚å®ƒçš„é»˜è®¤å€¼æ˜¯â€œallâ€ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©æ˜¯ç¬¬ä¸€æ¡è¿˜æ˜¯æœ€åä¸€æ¡ç¬¦åˆæ¡ä»¶çš„è¡Œè¢«è¿”å›ã€‚&lt;br /&gt;
ï¼subsetæ»¡è¶³æ¡ä»¶dest ï¼ â€œBOSâ€ å’Œ â€œDAYâ€çš„ç¬¬ä¸€è¡Œ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[c(&amp;quot;BOS&amp;quot;, &amp;quot;DAY&amp;quot;), on = &amp;quot;dest&amp;quot;, mult = &amp;quot;first&amp;quot;]
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014     1   1         3         1      AA    JFK  BOS       39      187   12
# 2: 2014     1   1        25        35      EV    EWR  DAY      102      533   17
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼subsetæ»¡è¶³æ¡ä»¶ origin ï¼ â€œLGAâ€ æˆ–è€… â€œJFKâ€ æˆ–è€… â€œEWRâ€ï¼Œå¹¶ä¸” dest ï¼ â€œXNAâ€ çš„æœ€åä¸€è¡Œ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(c(&amp;quot;LGA&amp;quot;, &amp;quot;JFK&amp;quot;, &amp;quot;EWR&amp;quot;), &amp;quot;XNA&amp;quot;), on = c(&amp;quot;origin&amp;quot;, &amp;quot;dest&amp;quot;), mult = &amp;quot;last&amp;quot;]
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014    10  31        -5       -11      MQ    LGA  XNA      165     1147    6
# 2:   NA    NA  NA        NA        NA      NA    JFK  XNA       NA       NA   NA
# 3: 2014    10  31        -2       -25      EV    EWR  XNA      160     1131    6
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;h-å‚æ•°nomatch:3887792cd19298be3383c54afb194a11&#34;&gt;h) å‚æ•°nomatch&lt;/h4&gt;

&lt;p&gt;å¦‚æœæŸ¥è¯¢è¯­å¥æ²¡æœ‰æ‰¾åˆ°ä»»ä½•åŒ¹é…çš„æ•°æ®ï¼Œé€šè¿‡æŒ‡å®šå‚æ•°nomatchï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æ˜¯è¿”å› NAï¼Œè¿˜æ˜¯å¿½ç•¥ã€‚&lt;br /&gt;
ï¼åœ¨ä¸Šé¢è¿™ä¸ªåˆ—å­ä¸­ï¼Œå¿½ç•¥æ²¡æœ‰å®é™…æ„ä¹‰çš„æ•°æ®&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(c(&amp;quot;LGA&amp;quot;, &amp;quot;JFK&amp;quot;, &amp;quot;EWR&amp;quot;), &amp;quot;XNA&amp;quot;), mult = &amp;quot;last&amp;quot;, on = c(&amp;quot;origin&amp;quot;, &amp;quot;dest&amp;quot;), nomatch = 0L]
#    year month day dep_delay arr_delay carrier origin dest air_time distance hour
# 1: 2014    10  31        -5       -11      MQ    LGA  XNA      165     1147    6
# 2: 2014    10  31        -2       -25      EV    EWR  XNA      160     1131    6
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;æ²¡æœ‰èˆªç­ä»â€œJFKâ€èµ·é£åˆ°è¾¾â€œXNAâ€ï¼Œæ‰€ä»¥ç»“æœé‡Œé¢ï¼Œè¿™ä¸€è¡Œè¢«å¿½ç•¥äº†ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;3-è‡ªåŠ¨ç´¢å¼•:3887792cd19298be3383c54afb194a11&#34;&gt;3.è‡ªåŠ¨ç´¢å¼•&lt;/h2&gt;

&lt;p&gt;å›é¡¾ä¸€ä¸‹ï¼Œæˆ‘ä»¬å…ˆå­¦ä¹ å¦‚ä½•é€šè¿‡ä¸»é”®ä½¿ç”¨å¿«é€ŸäºŒåˆ†æ³•æœç´¢è¿›è¡Œsubsetã€‚æ¥ç€ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä½¿ç”¨äºŒçº§ç´¢å¼•ï¼Œå®ƒå¸¦æ¥æ›´å¥½çš„æ•ˆæœï¼Œè€Œä¸”è¯­æ³•ä¹Ÿæ›´ç®€æ´ã€‚&lt;br /&gt;
ç­‰ç­‰ï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Ÿæœ‰ï¼ä¼˜åŒ–Rçš„åŸç”Ÿè¯­æ³•ï¼Œä½¿ç”¨å†…ç½®çš„ç´¢å¼•ã€‚è¿™æ ·æˆ‘ä»¬æ¯‹éœ€ä½¿ç”¨æ–°çš„è¯­æ³•ï¼Œå°±èƒ½å¾—åˆ°åŒæ ·çš„æ•ˆæœã€‚&lt;br /&gt;
è¿™å°±æ˜¯è‡ªåŠ¨ç´¢å¼•ã€‚&lt;br /&gt;
ç›®å‰ï¼Œå®ƒåªæ”¯æŒæ“ä½œç¬¦ == å’Œ %in% ã€‚è€Œä¸”åªå¯¹ä¸€åˆ—èµ·ä½œç”¨ã€‚æŸä¸€åˆ—ä¼šè¢«è‡ªåŠ¨åˆ›å»ºä¸ºç´¢å¼•ï¼Œå¹¶ä¸”ä½œä¸ºdata.tableçš„å±æ€§ä¿å­˜èµ·æ¥ã€‚è¿™è·Ÿå‚æ•°onä¸åŒï¼Œå‚æ•°onä¼šæ¯æ¬¡åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç´¢å¼•ï¼Œæ‰€ä»¥æ‰ä¼šè¢«å«åšâ€œäºŒçº§ç´¢å¼•â€ã€‚&lt;/p&gt;

&lt;p&gt;è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæå¤§çš„data.tableæ¥å‡¸æ˜¾å®ƒçš„ä¼˜åŠ¿ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(1L)
dt = data.table(x = sample(1e5L, 1e7L, TRUE), y = runif(100L))
print(object.size(dt), units = &amp;quot;Mb&amp;quot;)
# 114.4 Mb
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡å¯¹æŸä¸€åˆ—ä½¿ç”¨ == æˆ–è€… %in% çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªäºŒçº§ç´¢å¼•ï¼Œå®ƒä¼šè¢«ç”¨æ¥è¿›è¡Œsubsetã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# have a look at all the attribute names
names(attributes(dt))
# [1] &amp;quot;names&amp;quot;             &amp;quot;row.names&amp;quot;         &amp;quot;class&amp;quot;             &amp;quot;.internal.selfref&amp;quot;

## run thefirst time
(t1 &amp;lt;- system.time(ans &amp;lt;- dt[x == 989L]))
#    user  system elapsed 
#   0.235   0.013   0.249
head(ans)
#      x         y
# 1: 989 0.5372007
# 2: 989 0.5642786
# 3: 989 0.7151100
# 4: 989 0.3920405
# 5: 989 0.9547465
# 6: 989 0.2914710

## secondary index is created
names(attributes(dt))
# [1] &amp;quot;names&amp;quot;             &amp;quot;row.names&amp;quot;         &amp;quot;class&amp;quot;             &amp;quot;.internal.selfref&amp;quot;
# [5] &amp;quot;index&amp;quot;

indices(dt)
# [1] &amp;quot;x&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¬¬ä¸€æ¬¡subsetçš„æ—¶å€™ï¼Œå°±æ˜¯åˆ›å»ºç´¢å¼•çš„æ—¶å€™ã€‚å› ä¸ºåˆ›å»ºäºŒçº§ç´¢å¼•åªä¼šå¼•å…¥ä¸€ä¸ªæ’åºå‘é‡ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œè¿™ç§æ“ä½œç¬¦çš„æ–¹å¼ä¼šæ¯”æ‰«æå‘é‡å¿«å¾—å¤šã€‚æ‰€ä»¥ï¼Œä»ç¬¬äºŒæ¬¡subsetå¼€å§‹ï¼Œè‡ªåŠ¨ç´¢å¼•çš„ä¼˜åŠ¿å°±éå¸¸æ˜æ˜¾äº†ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;## successive subsets
(t2 &amp;lt;- system.time(dt[x == 989L]))
#    user  system elapsed 
#   0.001   0.000   0.001
system.time(dt[x %in% 1989:2012])
#    user  system elapsed 
#   0.001   0.000   0.001
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€æ¬¡subsetèŠ±äº†0.228ç§’ï¼Œä½†æ˜¯ç¬¬äºŒæ¬¡åªèŠ±äº†0.001ç§’ï¼&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;å¯ä»¥é€šè¿‡è®¾ç½®å…¨å±€å‚æ•°å…³é—­è‡ªåŠ¨ç´¢å¼•ï¼šoptions(datatable.auto.index = FALSE)ã€‚&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æˆ‘ä»¬æ­£åœ¨å°†äºŒåˆ†æ³•æœç´¢æ‰©å±•åˆ°å…¶å®ƒçš„æ“ä½œç¬¦ï¼Œæ¯”å¦‚ &amp;lt;, &amp;lt;= å’Œ &amp;gt;=ã€‚å®Œæˆä¹‹åï¼Œå°±èƒ½ç›´æ¥ç”¨åœ¨å…¶ä»–æ“ä½œç¬¦ä¸Šäº†ã€‚&lt;br /&gt;
åœ¨å°†æ¥ï¼Œæˆ‘ä»¬è®¡åˆ’å°†è‡ªåŠ¨ç´¢å¼•æ‰©å±•åˆ°å‚æ•°ä¸­çš„å…¶å®ƒåˆ—ã€‚&lt;/p&gt;

&lt;p&gt;åœ¨ä¸‹ä¸€è®²â€œç»“åˆå’Œæ»šåŠ¨ç»“åˆâ€ä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ ä½¿ç”¨ä¸»é”®å’ŒäºŒçº§ç´¢å¼•è¿›è¡Œå¿«é€Ÿsubsetã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Shiny Server ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †</title>
      <link>http://youngspring1.github.io/post/2016/2016-03-26-shinyserver-jp/</link>
      <pubDate>Sat, 26 Mar 2016 08:08:31 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-03-26-shinyserver-jp/</guid>
      <description>

&lt;p&gt;Rã¯ã€çµ±è¨ˆã«å¯¾ã—ã¦ã€ã¨ã¦ã‚‚ä¾¿åˆ©ã§ã™ãŒã€ãƒ¦ãƒ¼ã‚¶ã«å‘ã‘ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã¯ãã‚“ãªã«è‰¯ããªã„ã¨æ€ã„ã¾ã™ã€‚&lt;br /&gt;
Shiny Serverã¯ã€Webã‚µãƒ¼ãƒ“ã‚¹ã®ã‚ˆã†ã«ã€ãƒ¦ãƒ¼ã‚¶ã®å…¥åŠ›ã‹ã‚‰ã€Rã§è¨ˆç®—ã—ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§çµæœã‚’è¡¨ç¤ºã™ã‚‹ã‚µãƒ¼ãƒã§ã™ã€‚&lt;br /&gt;
ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ã¯ã€ä¸‹è¨˜ã®é€šã‚Šã§ã™ã€‚&lt;br /&gt;
ç’°å¢ƒã¯ã€ã‚¤ãƒ³ãƒˆãƒãƒƒãƒˆã«æ¥ç¶šã§ããªã„CentOS 6.5 x64ã§ã™ã€‚&lt;/p&gt;

&lt;h4 id=&#34;1-ã‚½ãƒ¼ã‚¹ã‹ã‚‰rã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:16be4caf9550ae37fbcf4bfe15c6e5b2&#34;&gt;1.ã‚½ãƒ¼ã‚¹ã‹ã‚‰Rã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;./configure --prefix=/opt/r --enable-R-shlib 
make 
make install 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„1ï¼šPATHã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã€Œ/etc/profileã€ã§è¨­å®šã—ã¦ãã ã•ã„ã€‚&lt;br /&gt;
æ³¨æ„2ï¼šRã¯ã€ä»–ã®ã‚³ãƒ³ãƒã«ä¾é ¼ã—ã¾ã™ã€‚ä¸‹è¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒå¿…è¦ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã‚ˆã‚Šç¢ºèªã—ã¦ãã ã•ã„ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;yum install gcc-gfortran 
yum install readline-devel 
yum install libXt-devel 
yum install gcc-c++ glibc-headers
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;2-xvfbã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:16be4caf9550ae37fbcf4bfe15c6e5b2&#34;&gt;2.Xvfbã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;yum install Xvfb
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;èª¬æ˜ï¼šçµµã®ä½œã‚‹ã®ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãŒ X11ã§ã™ãŒã€ã„ã‚ã„ã‚ãªå•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚æœ€å¾Œã€Xvfbã«ãªã‚Šã¾ã—ãŸã€‚&lt;/p&gt;

&lt;h4 id=&#34;3-shinyã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:16be4caf9550ae37fbcf4bfe15c6e5b2&#34;&gt;3.Shinyã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&lt;/h4&gt;

&lt;h5 id=&#34;3-1-shiny-libã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:16be4caf9550ae37fbcf4bfe15c6e5b2&#34;&gt;3.1 Shiny libã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&lt;/h5&gt;

&lt;p&gt;Rã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã€Shiny libã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;install.packages(&#39;shiny&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä»–ã®libã«ä¾é ¼ã—ã¾ã™ãŒã€ã‚‚ã—ã‚µãƒ¼ãƒã¯ã€ã„ã‚“ã¨ã­ã£ã¨ã«æ¥ç¶šã§ããªã„ãªã‚‰ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€ã‚µãƒ¼ãƒã«ç½®ã„ã¦ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚&lt;br /&gt;
Rã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ã€quit()ã—ã¦ã€ä¸‹è¨˜ã®ã‚ˆã†ãªã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;R CMD INSTALL XXXXX.tar.gz 
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;3-2-shiny-serverã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:16be4caf9550ae37fbcf4bfe15c6e5b2&#34;&gt;3.2 Shiny Serverã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;yum install --nogpgcheck shiny-server-1.4.2.786-rh5-x86_64.rpm 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ä¸‹è¨˜ã®ãƒ‘ã‚¹ã§ã™ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/etc/shiny-server/shiny-server.conf 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç¢ºèªã®ãŸã‚ã«ã€Shiny libã®10å€‹ã®ä¾‹ã‚’ã€shiny-serverã®ã‚µãƒ¼ãƒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cp -R /opt/r/lib64/R/library/shiny/examples/* /srv/shiny-server/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸Šè¨˜ã«ã‚ˆã‚Šã€ã™ã¹ã¦ã®APPã¯ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã€Œ/srv/shiny-server/ã€ã«ç½®ãã¾ã™ã€‚ãã—ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;http://localhost:3838/ç›®å½•å
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ãã‚Œä»¥å¤–ã€èµ·å‹•ãƒ»åœæ­¢ã‚³ãƒãƒ³ãƒ‰ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;start shiny-server 
stop shiny-server 
restart shiny-server 
status shiny-server 
reload shiny-server #ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä¸­æ­¢ã—ãªã„ã‚ˆã†ã«ã€æ›´æ–°å†…å®¹ã‚’ãƒ­ãƒ¼ãƒ‰
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ãƒ›ãƒ¼ãƒ³ãƒšãƒ¼ã‚¸ã‚’ç¢ºèªã—ã¾ã™ã‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;http://localhost:3838/index.html
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç”»é¢ã‚’è¡¨ç¤ºã§ãã¾ã™ãŒã€çµµã¯èª¤ã‚ŠãŒã‚ã‚Šãã†ã§ã™ã€‚&lt;/p&gt;

&lt;h4 id=&#34;4-çµµã®ä½œã‚Š:16be4caf9550ae37fbcf4bfe15c6e5b2&#34;&gt;4.çµµã®ä½œã‚Š&lt;/h4&gt;

&lt;h5 id=&#34;4-1-xvfbã®èµ·å‹•:16be4caf9550ae37fbcf4bfe15c6e5b2&#34;&gt;4.1 Xvfbã®èµ·å‹•&lt;/h5&gt;

&lt;p&gt;X11ã‚’ä½¿ã£ãŸã‚‰ã€ã‚¨ãƒ©ãƒ¼ã€Œcan&amp;rsquo;t start PNG deviceã€ã«ãªã‚Šã¾ã™ã€‚&lt;br /&gt;
ãã®ãŸã‚ã«ã€X11ã®ä»£ã‚ã‚Šã«ï¼ŒXvfbã‚’ä½¿ã„ã¾ã™ã€‚&lt;br /&gt;
Xvfbã‚’èµ·å‹•ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Xvfb :3 -screen 1 1280x1024x24
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;4-1-è¨­å®š:16be4caf9550ae37fbcf4bfe15c6e5b2&#34;&gt;4.1 è¨­å®š&lt;/h5&gt;

&lt;p&gt;ui.Rã«ã¯ã€ä¸‹è¨˜ã®å†…å®¹ã‚’è¿½åŠ ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Sys.setenv(DISPLAY = &amp;quot;:3.1&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¾‹ã‚’ç¢ºèªã—ã¾ã›ã‚“ã‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;http://localhost:3838/index.html 
http://localhost:3838/01_hello/ 
http://localhost:3838/02_text/
http://localhost:3838/03_reactivity/
http://localhost:3838/04_mpg/
http://localhost:3838/05_sliders/
http://localhost:3838/06_tabsets/
http://localhost:3838/07_widgets/
http://localhost:3838/08_html/
http://localhost:3838/09_upload/
http://localhost:3838/10_download/
http://localhost:3838/11_timer/
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;p&gt;å‚ç…§ï¼š&lt;a href=&#34;https://www.rstudio.com/products/shiny/shiny-server2/&#34;&gt;https://www.rstudio.com/products/shiny/shiny-server2/&lt;/a&gt;&lt;br /&gt;
ä¸­å›½èªç‰ˆï¼š&lt;a href=&#34;http://youngspring1.github.io/post/2016-03-25-shinyserver/&#34;&gt;http://youngspring1.github.io/post/2016-03-25-shinyserver/&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Shiny Server å®‰è£…æ­¥éª¤</title>
      <link>http://youngspring1.github.io/post/2016/2016-03-25-shinyserver/</link>
      <pubDate>Fri, 25 Mar 2016 20:00:38 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-03-25-shinyserver/</guid>
      <description>

&lt;p&gt;Rè¯­è¨€éå¸¸é€‚åˆç”¨äºç»Ÿè®¡ç›¸å…³çš„è¿ç®—ã€‚ä½†æ˜¯åœ¨ç”¨æˆ·äº¤äº’æ–¹é¢ä¸å¤Ÿå‹å¥½ã€‚&lt;br /&gt;
Shiny Serveræ˜¯RStudioæ¨å‡ºçš„ï¼Œä¸€ä¸ªWebæœåŠ¡ã€‚å®ƒå¯ä»¥æ¥å—ç”¨æˆ·çš„è¾“å…¥ï¼Œä½¿ç”¨Rè¯­è¨€è¿›è¡Œè®¡ç®—ï¼Œæœ€ç»ˆå±•ç¤ºè®¡ç®—ç»“æœã€‚è¿™ä¸€åˆ‡éƒ½åœ¨æµè§ˆå™¨ä¸Šå®Œæˆã€‚&lt;br /&gt;
æ€»ä¹‹éå¸¸å®ç”¨ï¼Œç°åœ¨æ•´ç†ä¸‹æˆ‘è‡ªå·±çš„å®‰è£…æ‰‹å†Œã€‚&lt;/p&gt;

&lt;h4 id=&#34;1-ä»ä»£ç å®‰è£…r:c33352843d2370512fb8e3c681b7c165&#34;&gt;1.ä»ä»£ç å®‰è£…R&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;./configure --prefix=/opt/r --enable-R-shlib 
make 
make install 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„1ï¼šPATHè¦è®¾ç½®è¿™ä¸ªæ–‡ä»¶ï¼Œå¦åˆ™å¯èƒ½ä¼šæ‰¾ä¸åˆ°R ï¼š/etc/profile&lt;br /&gt;
æ³¨æ„2ï¼šå¯èƒ½ä¾èµ–å…¶ä»–åŒ…æ¯”å¦‚fortranï¼Œä½ å¯èƒ½è¿˜éœ€è¦æ‰§è¡Œä¸‹é¢è¿™äº›å‘½ä»¤ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;yum install gcc-gfortran 
yum install readline-devel 
yum install libXt-devel 
yum install gcc-c++ glibc-headers
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;2-å®‰è£…xvfb:c33352843d2370512fb8e3c681b7c165&#34;&gt;2.å®‰è£…Xvfb&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;yum install Xvfb
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼šç»˜åˆ¶å›¾å½¢å¥½åƒé»˜è®¤ä½¿ç”¨ X11ï¼Œä½†æ˜¯å®‰è£…è¿‡ç¨‹ä¸­é‡åˆ°äº†å„ç§éº»çƒ¦ï¼Œæœ€åå°è¯•äº†è¿™ä¸ªï¼Œèƒ½å¤Ÿæ­£å¸¸æ˜¾ç¤ºã€‚&lt;/p&gt;

&lt;h4 id=&#34;3-å®‰è£…shiny:c33352843d2370512fb8e3c681b7c165&#34;&gt;3.å®‰è£…Shiny&lt;/h4&gt;

&lt;h5 id=&#34;3-1-å®‰è£…shiny:c33352843d2370512fb8e3c681b7c165&#34;&gt;3.1 å®‰è£…Shiny&lt;/h5&gt;

&lt;p&gt;Rå‘½ä»¤è¡Œä¸‹é¢å®‰è£…Shinyçš„åŒ…ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;install.packages(&#39;shiny&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å®‰è£…è¿‡ç¨‹ä¸­ï¼Œä¼šå®‰è£…å…¶ä»–ä¾èµ–çš„åŒ…ã€‚&lt;br /&gt;
å¦‚æœä½ è·Ÿæˆ‘ä¸€æ ·ï¼ŒæœåŠ¡å™¨ä¸èƒ½è¿ç½‘ç»œï¼Œé‚£å°±å¿…é¡»ä¸‹è½½å¥½å‹ç¼©åŒ…ï¼Œå†ä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼Œä»æœ¬åœ°å®‰è£…ã€‚&lt;br /&gt;
ä½†æ˜¯ä¸åœ¨Rå‘½ä»¤è¡Œä¸‹ï¼Œè€Œæ˜¯è¿˜è¦quit()é€€å‡ºæ¥ã€‚&lt;br /&gt;
å®‰è£…çš„å‘½ä»¤é•¿è¿™æ ·ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;R CMD INSTALL XXXXX.tar.gz 
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;3-2-å®‰è£…shiny-server:c33352843d2370512fb8e3c681b7c165&#34;&gt;3.2 å®‰è£…Shiny Server&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;yum install --nogpgcheck shiny-server-1.4.2.786-rh5-x86_64.rpm 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é…ç½®æ–‡ä»¶è·¯å¾„ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/etc/shiny-server/shiny-server.conf 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½ å¯ä»¥æŠŠshinyåŒ…é‡Œé¢è‡ªå¸¦çš„10ä¸ªä¾‹å­ï¼Œéƒ½æ‹·è´åˆ°shiny-serverçš„ç›®å½•ä¸‹å»ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cp -R /opt/r/lib64/R/library/shiny/examples/* /srv/shiny-server/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ˜¯çš„ï¼Œä½ ä»¥åæ‰€æœ‰çš„APPéƒ½è¦åœ¨/srv/shiny-server/ç›®å½•ä¸‹ï¼Œç„¶ååœ¨æµè§ˆå™¨ä¸­é€šè¿‡è¿™æ ·çš„æ–¹å¼æ¥è®¿é—®ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;http://localhost:3838/ç›®å½•å
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦å¤–ï¼Œå¯åŠ¨ï¼åœæ­¢ç­‰å‘½ä»¤ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;start shiny-server 
stop shiny-server 
restart shiny-server 
status shiny-server 
reload shiny-server #ä¸ä¸­æ–­æœåŠ¡çš„å‰æä¸‹ æ›´æ–°åŠ è½½é…ç½®é¡¹
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ—¶å¯ä»¥çœ‹ä¸‹é¦–é¡µï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;http://localhost:3838/index.html
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é¡µé¢èƒ½å¤Ÿæ˜¾ç¤ºï¼Œä½†æ˜¯ç»˜å›¾çš„éƒ¨åˆ†å¥½åƒæŠ¥é”™äº†ã€‚&lt;/p&gt;

&lt;h4 id=&#34;4-ç»˜å›¾å¼•æ“:c33352843d2370512fb8e3c681b7c165&#34;&gt;4.ç»˜å›¾å¼•æ“&lt;/h4&gt;

&lt;h5 id=&#34;4-1-å¯åŠ¨xvfb:c33352843d2370512fb8e3c681b7c165&#34;&gt;4.1 å¯åŠ¨Xvfb&lt;/h5&gt;

&lt;p&gt;å„ç§æ³ªæµæ»¡é¢å•Šï¼Œä¹ç‰›äºŒè™å•Šã€‚ä¹‹å‰å®‰è£…ä¸€å †ä¸œè¥¿ï¼Œä¼å›¾ä½¿ç”¨X11ï¼Œä¼šæŠ¥é”™ï¼šcan&amp;rsquo;t start PNG deviceã€‚&lt;br /&gt;
åæ¥æ”¾å¼ƒX11ï¼Œä½¿ç”¨Xvfbã€‚éœ€è¦å¯åŠ¨Xvfbã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Xvfb :3 -screen 1 1280x1024x24
&lt;/code&gt;&lt;/pre&gt;

&lt;h5 id=&#34;4-1-è®¾ç½®:c33352843d2370512fb8e3c681b7c165&#34;&gt;4.1 è®¾ç½®&lt;/h5&gt;

&lt;p&gt;ui.Réœ€è¦åŠ å…¥ä¸‹é¢è¿™ä¸€è¡Œï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Sys.setenv(DISPLAY = &amp;quot;:3.1&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è®¿é—®ç¤ºä¾‹è¯•è¯•ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;http://localhost:3838/index.html 
http://localhost:3838/01_hello/ 
http://localhost:3838/02_text/
http://localhost:3838/03_reactivity/
http://localhost:3838/04_mpg/
http://localhost:3838/05_sliders/
http://localhost:3838/06_tabsets/
http://localhost:3838/07_widgets/
http://localhost:3838/08_html/
http://localhost:3838/09_upload/
http://localhost:3838/10_download/
http://localhost:3838/11_timer/
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;p&gt;å‚ç…§ï¼š&lt;a href=&#34;https://www.rstudio.com/products/shiny/shiny-server2/&#34;&gt;https://www.rstudio.com/products/shiny/shiny-server2/&lt;/a&gt;&lt;br /&gt;
æ—¥æ–‡ç‰ˆï¼š&lt;a href=&#34;http://youngspring1.github.io/post/2016-03-26-shinyserver-jp/&#34;&gt;http://youngspring1.github.io/post/2016-03-26-shinyserver-jp/&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>data.table æ•™ç¨‹3ï¼ˆæ ¡å¯¹ä¸­ï¼‰</title>
      <link>http://youngspring1.github.io/post/2016/2016-03-22-datatable3/</link>
      <pubDate>Tue, 22 Mar 2016 23:58:42 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-03-22-datatable3/</guid>
      <description>

&lt;p&gt;ç›®å½•ï¼š&lt;br /&gt;
1) &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-13-datatable1/&#34;&gt;data.table ä»‹ç»&lt;/a&gt;&lt;br /&gt;
2) &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-21-datatable2/&#34;&gt;è¯­ä¹‰å¼•ç”¨&lt;/a&gt;&lt;br /&gt;
3) ä¸»é”®ã€åŸºäºå¿«é€ŸäºŒåˆ†æ³•æœç´¢çš„subset&lt;br /&gt;
4) [äºŒæ¬¡ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•]()&lt;br /&gt;
5) Efficient reshaping using data.tables&lt;/p&gt;

&lt;p&gt;åŸæ–‡åœ°å€ï¼š&lt;br /&gt;
1) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-intro-vignette.html&#34;&gt;Introduction to data.table&lt;/a&gt;&lt;br /&gt;
2) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-reference-semantics.html&#34;&gt;Reference semantics&lt;/a&gt;&lt;br /&gt;
3) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-keys-fast-subset.html&#34;&gt;Keys and fast binary search based subsets&lt;/a&gt;&lt;br /&gt;
4) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-secondary-indices-and-auto-indexing.html&#34;&gt;Secondary indices and auto indexing&lt;/a&gt;&lt;br /&gt;
5) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-reshape.html&#34;&gt;Efficient reshaping using data.tables&lt;/a&gt;&lt;br /&gt;
6) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-faq.html&#34;&gt;Frequently asked questions&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;æœ¬æ•™ç¨‹ä¸»è¦æä¾›ç»™é‚£äº›å·²ç»ç†Ÿæ‚‰data.tableçš„è¯­æ³•ã€æ‡‚å¾—subsetè¡Œselectåˆ—ã€çŸ¥é“å¦‚ä½•æ·»åŠ ï¼æ›´æ–°ï¼åˆ é™¤åˆ—çš„äººå‘˜å­¦ä¹ ã€‚å¦‚æœä½ å¯¹è¿™äº›ä¸ç†Ÿæ‚‰ï¼Œè¯·å­¦ä¹ ä¸Šé¢ä¸¤è®² &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-13-datatable1/&#34;&gt;data.table ä»‹ç»&lt;/a&gt; å’Œ &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-21-datatable2/&#34;&gt;è¯­ä¹‰å¼•ç”¨&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;æ•°æ®:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;æ•°æ®&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬ç»§ç»­ä½¿ç”¨ä¸Šä¸€è®²ä¸­ä½¿ç”¨çš„èˆªç­ä¿¡æ¯flightsã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights &amp;lt;- fread(&amp;quot;https://raw.githubusercontent.com/wiki/arunsrinivasan/    flights/NYCflights14/flights14.csv&amp;quot;)
flights
#         year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight
#      1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1
#      2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3
#      3: 2014     1   1     1902         2     2224         9         0      AA  N327AA     21
#      4: 2014     1   1      722        -8     1014       -26         0      AA  N3EHAA     29
#      5: 2014     1   1     1347         2     1706         1         0      AA  N319AA    117
#     ---                                                                                      
# 253312: 2014    10  31     1459         1     1747       -30         0      UA  N23708   1744
# 253313: 2014    10  31      854        -5     1147       -14         0      UA  N33132   1758
# 253314: 2014    10  31     1102        -8     1311        16         0      MQ  N827MQ   3591
# 253315: 2014    10  31     1106        -4     1325        15         0      MQ  N511MQ   3592
# 253316: 2014    10  31      824        -5     1045         1         0      MQ  N813MQ   3599
#         origin dest air_time distance hour min
#      1:    JFK  LAX      359     2475    9  14
#      2:    JFK  LAX      363     2475   11  57
#      3:    JFK  LAX      351     2475   19   2
#      4:    LGA  PBI      157     1035    7  22
#      5:    JFK  LAX      350     2475   13  47
#     ---                                       
# 253312:    LGA  IAH      201     1416   14  59
# 253313:    EWR  IAH      189     1400    8  54
# 253314:    LGA  RDU       83      431   11   2
# 253315:    LGA  DTW       75      502   11   6
# 253316:    LGA  SDF      110      659    8  24
dim(flights)
# [1] 253316     17
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;ä»‹ç»:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;ä»‹ç»&lt;/h2&gt;

&lt;p&gt;åœ¨è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä¼šï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* ä»‹ç»â€œä¸»é”®â€çš„æ¦‚å¿µï¼Œåœ¨å‚æ•°ié‡Œé¢ï¼Œè®¾ç½®å¹¶ä½¿ç”¨ä¸»é”®è¿›è¡ŒåŸºäºå¿«é€ŸäºŒåˆ†æ³•æœç´¢çš„subsetã€‚
* å­¦ä¹ å¦‚ä½•å°†åŸºäºä¸»é”®çš„subsetï¼Œä¸å‚æ•°iå’Œbyç›¸ç»“åˆï¼Œå°±åƒä»¥å‰åšçš„ä¸€æ ·ã€‚
* å­¦ä¹ å¦å¤–ä¸¤ä¸ªæœ‰ç”¨çš„å‚æ•° mult å’Œ nomatch
* æœ€åæ€»ç»“ä¸€ä¸‹ä¸»é”®çš„ä¼˜è¶Šæ€§ï¼šåŸºäºå¿«é€ŸäºŒåˆ†æ³•æœç´¢çš„subsetçš„è¡¨ç°ï¼Œå¹¶å’Œä¼ ç»Ÿçš„vector scan approachå¯¹æ¯”ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;1-ä¸»é”®:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;1.ä¸»é”®&lt;/h2&gt;

&lt;h4 id=&#34;a-ä»€ä¹ˆæ˜¯ä¸»é”®:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;a) ä»€ä¹ˆæ˜¯ä¸»é”®&lt;/h4&gt;

&lt;p&gt;åœ¨&lt;a href=&#34;http://youngspring1.github.io/post/2016-03-13-datatable1/&#34;&gt;data.table ä»‹ç»&lt;/a&gt;é‡Œï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•åœ¨å‚æ•°ié‡ŒæŒ‡å®šé€»è¾‘è¡¨è¾¾å¼å’Œè¡Œå·subsetè¡Œï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ order().åœ¨è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ å¦‚ä½•ä½¿ç”¨ä¸»é”®subsetè¡Œï¼Œè€Œä¸”è¿™éš¾ä»¥ç½®ä¿¡çš„å¿«ã€‚&lt;br /&gt;
ä½†é¦–å…ˆï¼Œæˆ‘ä»¬ä»data.frameå¼€å§‹ã€‚æ‰€æœ‰çš„data.frameéƒ½æœ‰ä¸€ä¸ªè¡Œåçš„å±æ€§ã€‚çœ‹ä¸‹é¢è¿™ä¸ªdata.frame DFã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(1L)
DF = data.frame(ID1 = sample(letters[1:2], 10, TRUE), 
                ID2 = sample(1:3, 10, TRUE),
                val = sample(10), 
                stringsAsFactors = FALSE,
                row.names = sample(LETTERS[1:10]))
DF
#   ID1 ID2 val
# C   a   3   5
# D   a   1   6
# E   b   2   4
# G   a   1   2
# B   b   1  10
# H   a   2   8
# I   b   1   9
# F   b   2   1
# J   a   3   7
# A   b   2   3

rownames(DF)
#  [1] &amp;quot;C&amp;quot; &amp;quot;D&amp;quot; &amp;quot;E&amp;quot; &amp;quot;G&amp;quot; &amp;quot;B&amp;quot; &amp;quot;H&amp;quot; &amp;quot;I&amp;quot; &amp;quot;F&amp;quot; &amp;quot;J&amp;quot; &amp;quot;A&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ‘ä»¬å¯ä»¥ç”¨è¡Œåæ¥subsetä¸€è¡Œï¼Œå°±åƒè¿™æ ·ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DF[&amp;quot;C&amp;quot;, ]
#   ID1 ID2 val
# C   a   3   5
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¡Œåï¼Œæˆ–å¤šæˆ–å°‘ï¼Œç®—æ˜¯ä¸€ä¸ªdata.frameçš„ç´¢å¼•ã€‚ç„¶è€Œï¼Œ&lt;br /&gt;
1. æ¯è¡Œéƒ½æœ‰ä¸”åªæœ‰ä¸€ä¸ªè¡Œåã€‚
ä½†æ˜¯ï¼Œä¸€ä¸ªäººå¯èƒ½æœ‰ä¸¤ä¸ªåå­—ï¼Œæ¯”å¦‚åå­—å’Œä¸­é—´åã€‚å½“ç¼–çº‚ç”µè¯ç°¿çš„æ—¶å€™ï¼Œè¿™å°±éå¸¸æœ‰ç”¨ã€‚
2. è€Œä¸”è¡Œåå¿…é¡»æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rownames(DF) = sample(LETTERS[1:5], 10, TRUE)
# Warning: non-unique values when setting &#39;row.names&#39;: &#39;C&#39;, &#39;D&#39;
# Error in `row.names&amp;lt;-.data.frame`(`*tmp*`, value = value): duplicate &#39;row.names&#39; are not allowed
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹data.tableå§ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT = as.data.table(DF)
DT
#     ID1 ID2 val
#  1:   a   3   5
#  2:   a   1   6
#  3:   b   2   4
#  4:   a   1   2
#  5:   b   1  10
#  6:   a   2   8
#  7:   b   1   9
#  8:   b   2   1
#  9:   a   3   7
# 10:   b   2   3

rownames(DT)
#  [1] &amp;quot;1&amp;quot;  &amp;quot;2&amp;quot;  &amp;quot;3&amp;quot;  &amp;quot;4&amp;quot;  &amp;quot;5&amp;quot;  &amp;quot;6&amp;quot;  &amp;quot;7&amp;quot;  &amp;quot;8&amp;quot;  &amp;quot;9&amp;quot;  &amp;quot;10&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* è¡Œåè¢«é‡ç½®äº†ã€‚
* data.tableä»æ¥ä¸ä½¿ç”¨è¡Œåã€‚æ—¢ç„¶data.tableé›†æˆäº†data.frameï¼Œé‚£å®ƒè¿˜æ˜¯æœ‰è¡Œåè¿™ä¸ªå±æ€§çš„ï¼Œä½†æ˜¯ä»æ¥ä¸ä½¿ç”¨ã€‚é©¬ä¸Šæˆ‘ä»¬å°±çŸ¥é“ä¸ºä»€ä¹ˆäº†ã€‚
å¦‚æœæƒ³ä¿æŒè¡Œåï¼Œåœ¨è°ƒç”¨ as.data.table()çš„æ—¶å€™æŒ‡å®š keep.rownames = TRUEï¼Œè¿™å›åˆ›å»ºä¸€ä¸ªå«åš rnçš„åˆ—ï¼Œå¹¶ä¸”å°†åˆ—åèµ‹å€¼ç»™è¿™ä¸€åˆ—ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è€Œåœ¨data.tableé‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸»é”®ã€‚ä¸»é”®æ˜¯æ›´æœ‰æ•ˆçš„è¡Œåã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ä¸»é”®åŠå…¶ç‰¹æ€§
* æˆ‘ä»¬å¯ä»¥å¯¹å¤šä¸ªåˆ—è®¾ç½®ä¸»é”®ï¼Œè¿™äº›åˆ—å¯èƒ½æ˜¯ä¸åŒçš„ç±»å‹ï¼integer, numeric, character, factor, integer64ç­‰ç­‰ã€‚ä½†è¿˜ä¸æ”¯æŒlistå’Œcomplexã€‚
* ä¸å¼ºåˆ¶å”¯ä¸€æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸åŒåˆ—çš„ä¸»é”®å¯ä»¥æ˜¯ä¸€æ ·çš„ã€‚æ—¢ç„¶è¡Œå¯ä»¥é€šè¿‡ä¸»é”®æ’åºï¼Œé‚£ä¹ˆæ’åºçš„æ—¶å€™ï¼Œå…·æœ‰åŒæ ·ä¸»é”®çš„ä¸€äº›è¡Œï¼Œä¼šè¢«æ’åœ¨ä¸€èµ·ã€‚
* è®¾ç½®ä¸»é”®è¿™ä¸ªè¿‡ç¨‹åˆ†ä¸¤æ­¥ï¼š
  a.æ ¹æ®æŒ‡å®šçš„åˆ—ï¼Œå¯¹data.tableé‡æ–°æ’åºï¼Œè€Œä¸”æ€»æ˜¯æŒ‰å‡åºæ’åˆ—ã€‚
  b.å¯¹äºdata.tableï¼Œé€šè¿‡è®¾ç½®ä¸€ä¸ªå«åš sorted çš„å±æ€§ï¼Œæ¥æŠŠé‚£äº›åˆ—æ ‡è®°ä¸ºä¸»é”®åˆ—ã€‚
  æ—¢ç„¶æ˜¯æ’åºï¼Œä¸€ä¸ªdata.tableæœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ï¼Œå› ä¸ºå®ƒä¸èƒ½æŒ‰ç…§ä¸¤ç§æ–¹æ³•æ’åºã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨æ•™ç¨‹æ¥ä¸‹æ¥çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¸€ç›´éƒ½æ˜¯ç”¨èˆªç­ä¿¡æ¯ flights æ¥è®²è§£ã€‚&lt;/p&gt;

&lt;h3 id=&#34;b-è®¾ç½®-è·å–-ä½¿ç”¨ä¸»é”®:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;b) è®¾ç½®ï¼è·å–ï¼ä½¿ç”¨ä¸»é”®&lt;/h3&gt;

&lt;p&gt;ï¼å¦‚ä½•å°† originåˆ—è®¾ç½®ä¸ºä¸»é”®&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;setkey(flights, origin)
head(flights)
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     1   1     1824         4     2145         0         0      AA  N3DEAA    119    EWR
# 2: 2014     1   1     1655        -5     2003       -17         0      AA  N5CFAA    172    EWR
# 3: 2014     1   1     1611       191     1910       185         0      AA  N471AA    300    EWR
# 4: 2014     1   1     1449        -1     1753        -2         0      AA  N4WNAA    320    EWR
# 5: 2014     1   1      607        -3      905       -10         0      AA  N5DMAA   1205    EWR
# 6: 2014     1   1      949         4     1243       -17         0      AA  N491AA   1223    EWR
#    dest air_time distance hour min
# 1:  LAX      339     2454   18  24
# 2:  MIA      161     1085   16  55
# 3:  DFW      214     1372   16  11
# 4:  DFW      214     1372   14  49
# 5:  MIA      154     1085    6   7
# 6:  DFW      215     1372    9  49

## alternatively we can provide character vectors to the function &#39;setkeyv()&#39;
# setkeyv(flights, &amp;quot;origin&amp;quot;) # useful to program with
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* ä½ å¯ä»¥ç»™å‡½æ•°setkey() ä¼ å…¥åˆ—åä½œä¸ºå‚æ•°ï¼Œä¸éœ€è¦å¼•å·ã€‚è¿™åœ¨äº¤äº’å¼ä½¿ç”¨çš„æ—¶å€™ç‰¹åˆ«æ–¹ä¾¿ã€‚
* æ¢ä¸€ç§æ–¹å¼ï¼Œä½ å¯ä»¥ç»™å‡½æ•°setkeyv() ä¼ ä¸€ä¸ªå­—ç¬¦å‹çš„å‘é‡ï¼Œè¿™ä¸ªå‘é‡é‡Œä¿å­˜çš„æ˜¯åˆ—åã€‚è¿™åœ¨æŠŠåˆ—ä½œä¸ºå‚æ•°ä¼ ç»™ä¸€ä¸ªæ–°åˆ›å»ºçš„å‡½æ•°ï¼Œæ¥è®¾ç½®ä¸»é”®çš„æ—¶å€™ç‰¹åˆ«æ–¹ä¾¿ã€‚
* æ³¨æ„ï¼Œæˆ‘ä»¬ä¸éœ€è¦å°†ç»“æœèµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ã€‚è¿™æ˜¯å› ä¸ºï¼Œsetkey() å’Œ setkeyv()å¯ä»¥ç›´æ¥æ›´æ–°è¾“å…¥çš„data.tableï¼Œå°±å’Œä¸Šä¸€è®²ä¸­çš„æ“ä½œç¬¦&amp;quot;:=&amp;quot;ä¸€æ ·ã€‚å®ƒä»¬æ²¡æœ‰è¿”å›å€¼ã€‚
* ç°åœ¨è¿™ä¸ªdata.tableå·²ç»æŒ‰ç…§æˆ‘ä»¬æä¾›çš„ originåˆ—é‡æ–°æ’åºäº†ã€‚è™½ç„¶æ˜¯é‡æ–°æ’åºï¼Œä½†æˆ‘ä»¬åªéœ€è¦è¯·æ±‚å’Œdata.tableçš„è¡Œæ•°ç­‰é•¿çš„ä¸€åˆ—è¿™ä¹ˆå¤§çš„å†…å­˜ç©ºé—´ã€‚ä½ çœ‹ï¼ŒåˆèŠ‚çœå†…å­˜å¼€é”€äº†ã€‚
* ä½ ä¹Ÿå¯ä»¥åœ¨åˆ›å»ºdata.tableçš„æ—¶å€™ï¼Œè°ƒç”¨å‡½æ•°data.table() çš„å‚æ•° key=ï¼Œç›´æ¥è®¾ç½®ä¸»é”®ï¼Œå‚æ•°keyçš„å€¼æ˜¯åˆ—åçš„å­—ç¬¦å‹å‘é‡ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set* and :=:
åœ¨data.tableé‡Œï¼Œæ“ä½œç¬¦&amp;quot;:=&amp;quot;å’Œæ‰€æœ‰çš„ä»¥setå¼€å¤´å‡½æ•°ï¼ˆæ¯”å¦‚setkey,setorder,setnameç­‰ï¼‰ä¸€æ ·ï¼Œå®ƒä»¬éƒ½ä¼šæ›´æ–°è¾“å…¥çš„åŸæ•°æ®ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸€æ—¦å°†æŸä¸€åˆ—è®¾ç½®æˆdata.tableçš„ä¸»é”®ï¼Œå°±å¯ä»¥åœ¨å‚æ•°ié‡ŒæŒ‡å®š .()æ¥subseté‚£äº›ä¸»é”®äº†ã€‚å›å¿†ä¸€ä¸‹ï¼Œ.()å°±æ˜¯ list()çš„åˆ«åã€‚&lt;/p&gt;

&lt;p&gt;ï¼ä½¿ç”¨ä¸»é”®origin æ¥subsetæ‰€æœ‰originæ˜¯&amp;rdquo;JFK&amp;rdquo;çš„è¡Œ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(&amp;quot;JFK&amp;quot;)]
#        year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
#     1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1    JFK
#     2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3    JFK
#     3: 2014     1   1     1902         2     2224         9         0      AA  N327AA     21    JFK
#     4: 2014     1   1     1347         2     1706         1         0      AA  N319AA    117    JFK
#     5: 2014     1   1     2133        -2       37       -18         0      AA  N323AA    185    JFK
#    ---                                                                                             
# 81479: 2014    10  31     1705        -4     2024       -21         0      UA  N596UA    512    JFK
# 81480: 2014    10  31     1827        -2     2133       -37         0      UA  N568UA    514    JFK
# 81481: 2014    10  31     1753         0     2039       -33         0      UA  N518UA    535    JFK
# 81482: 2014    10  31      924        -6     1228       -38         0      UA  N512UA    541    JFK
# 81483: 2014    10  31     1124        -6     1408       -38         0      UA  N590UA    703    JFK
#        dest air_time distance hour min
#     1:  LAX      359     2475    9  14
#     2:  LAX      363     2475   11  57
#     3:  LAX      351     2475   19   2
#     4:  LAX      350     2475   13  47
#     5:  LAX      338     2475   21  33
#    ---                                
# 81479:  SFO      337     2586   17   5
# 81480:  SFO      344     2586   18  27
# 81481:  LAX      320     2475   17  53
# 81482:  SFO      343     2586    9  24
# 81483:  LAX      323     2475   11  24

## alternatively
# flights[J(&amp;quot;JFK&amp;quot;)] (or) flights[list(&amp;quot;JFK&amp;quot;)]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* å› ä¸ºå·²ç»å°†ä¸»é”®è®¾ç½®ä¸º originåˆ—äº†ï¼Œæ‰€ä»¥åªè¦ç›´æ¥æŒ‡å®š&amp;quot;JFK&amp;quot;å°±å¯ä»¥äº†ã€‚è¿™é‡Œ .()ç”¨æ¥åœ¨data.tableçš„ä¸»é”®ï¼ˆä¹Ÿå°±æ˜¯flights çš„ originåˆ—ï¼‰é‡Œï¼ŒæŸ¥æ‰¾&amp;quot;JFK&amp;quot;ã€‚
* é¦–å…ˆï¼Œæ»¡è¶³&amp;quot;JFK&amp;quot;æ¡ä»¶çš„è¡Œçš„ç´¢å¼•éƒ½è¢«è·å–åˆ°ã€‚ç„¶åï¼Œè¿™äº›è¡Œçš„å“ªäº›ä¿¡æ¯æ˜¯å¿…è¦çš„å‘¢ã€‚æ—¢ç„¶å‚æ•°jé‡Œæ²¡æœ‰æŒ‡å®šä»»ä½•è¡¨è¾¾å¼ï¼Œè¿™äº›è¡Œçš„æ‰€æœ‰åˆ—éƒ½è¢«è¿”å›äº†ã€‚
* å¦‚æœä¸»é”®æ˜¯å­—ç¬¦å‹çš„åˆ—ï¼Œé‚£ä¹ˆå¯ä»¥çœç•¥ .()ï¼Œå°±åƒç”¨è¡Œåsubsetä¸€ä¸ªdata.frameçš„è¡Œçš„æ—¶å€™ã€‚
flights[&amp;quot;JFK&amp;quot;]              ## same as flights[.(&amp;quot;JFK&amp;quot;)]

* æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦æŒ‡å®šå¤šä¸ªå€¼
flights[c(&amp;quot;JFK&amp;quot;, &amp;quot;LGA&amp;quot;)]    ## same as flights[.(c(&amp;quot;JFK&amp;quot;, &amp;quot;LGA&amp;quot;))]
è¿™è¿”å›æ‰€æœ‰ originåˆ—æ˜¯â€œJFKâ€ æˆ–è€… â€œLGAâ€çš„æ‰€æœ‰è¡Œã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼å¦‚ä½•è·å¾—è¢«è®¾ç½®ä¸ºdata.tableçš„ä¸»é”®çš„é‚£ä¸€åˆ—çš„åˆ—å
ä½¿ç”¨å‡½æ•° key()ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;key(flights)
# [1] &amp;quot;origin&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* å‡½æ•° key() è¿”å›ä¸»é”®åˆ—åçš„å­—ç¬¦å‹å‘é‡ã€‚
* å¦‚æœdata.tableæ²¡æœ‰è®¾ç½®è¿‡ä¸»é”®ï¼Œè¿”å› NULLã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;c-ä¸»é”®å’Œå¤šä¸ªåˆ—:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;c) ä¸»é”®å’Œå¤šä¸ªåˆ—&lt;/h4&gt;

&lt;p&gt;ä¸»é”®æ˜¯æ›´æœ‰æ•ˆçš„è¡Œåã€‚æˆ‘ä»¬å¯ä»¥å°†å¤šä¸ªåˆ—è®¾ç½®ä¸ºä¸»é”®ï¼Œå®ƒä»¬å¯ä»¥æ˜¯ä¸åŒçš„ç±»å‹ã€‚
ï¼å¦‚ä½•å°† originåˆ— å’Œ deståˆ— éƒ½è®¾ç½®ä¸ºä¸»é”®&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;setkey(flights, origin, dest)
head(flights)
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     1   2      724        -2      810       -25         0      EV  N11547   4373    EWR
# 2: 2014     1   3     2313        88        9        79         0      EV  N18120   4470    EWR
# 3: 2014     1   4     1526       220     1618       211         0      EV  N11184   4373    EWR
# 4: 2014     1   4      755        35      848        19         0      EV  N14905   4551    EWR
# 5: 2014     1   5      817        47      921        42         0      EV  N19966   4470    EWR
# 6: 2014     1   5     2301        66        2        62         0      EV  N19966   4682    EWR
#    dest air_time distance hour min
# 1:  ALB       30      143    7  24
# 2:  ALB       29      143   23  13
# 3:  ALB       32      143   15  26
# 4:  ALB       32      143    7  55
# 5:  ALB       26      143    8  17
# 6:  ALB       31      143   23   1

## or alternatively
# setkeyv(flights, c(&amp;quot;origin&amp;quot;, &amp;quot;dest&amp;quot;)) # provide a character vector of column names

key(flights)
# [1] &amp;quot;origin&amp;quot; &amp;quot;dest&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* data.tableå…ˆæŒ‰ originåˆ— æ’åºï¼Œå†æŒ‰ deståˆ— æ’åºã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼subsetæ‰€æœ‰æ»¡è¶³æ¡ä»¶ originæ˜¯&amp;rdquo;JFK&amp;rdquo;ã€destæ˜¯&amp;rdquo;MIA&amp;rdquo;çš„è¡Œ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(&amp;quot;JFK&amp;quot;, &amp;quot;MIA&amp;quot;)]
#       year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
#    1: 2014     1   1     1509        -1     1828       -17         0      AA  N5FJAA    145    JFK
#    2: 2014     1   1      917         7     1227        -8         0      AA  N5DWAA   1085    JFK
#    3: 2014     1   1     1227         2     1534        -1         0      AA  N635AA   1697    JFK
#    4: 2014     1   1      546         6      853         3         0      AA  N5CGAA   2243    JFK
#    5: 2014     1   1     1736         6     2043       -12         0      AA  N397AA   2351    JFK
#   ---                                                                                             
# 2746: 2014    10  31     1659        -1     1956       -22         0      AA  N5FNAA   2351    JFK
# 2747: 2014    10  31      826        -3     1116       -20         0      AA  N5EYAA   1085    JFK
# 2748: 2014    10  31      647         2      941       -17         0      AA  N5BTAA   1101    JFK
# 2749: 2014    10  31      542        -3      834       -12         0      AA  N3ETAA   2299    JFK
# 2750: 2014    10  31     1944        29     2232         4         0      AA  N5FSAA   2387    JFK
#       dest air_time distance hour min
#    1:  MIA      161     1089   15   9
#    2:  MIA      166     1089    9  17
#    3:  MIA      164     1089   12  27
#    4:  MIA      157     1089    5  46
#    5:  MIA      154     1089   17  36
#   ---                                
# 2746:  MIA      148     1089   16  59
# 2747:  MIA      146     1089    8  26
# 2748:  MIA      150     1089    6  47
# 2749:  MIA      150     1089    5  42
# 2750:  MIA      146     1089   19  44
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Ÿ
* ç†è§£å†…éƒ¨çš„å¤„ç†æ­¥éª¤å¾ˆé‡è¦ã€‚é¦–å…ˆï¼Œç”¨&amp;quot;JFK&amp;quot;å’Œç¬¬ä¸€ä¸ªä¸»é”® originåˆ—åŒ¹é…ï¼›ç„¶åï¼Œåœ¨åŒ¹é…ä¸Šçš„è¿™äº›è¡Œé‡Œï¼Œç”¨â€œMIAâ€å’Œç¬¬äºŒä¸ªä¸»é”® deståˆ—åŒ¹é…ï¼Œè¿™æ ·æ¥è·å–æ‰€æœ‰ç¬¦åˆè¿™ä¸¤ä¸ªæ¡ä»¶çš„è¡Œçš„ç´¢å¼•ã€‚
* æ—¢ç„¶æˆ‘ä»¬æ²¡æœ‰æŒ‡å®šå‚æ•°jï¼Œé‚£å°±ä¼šè¿”å›æ‰€æœ‰ç¬¦åˆä¸Šé¢ç´¢å¼•çš„è¡Œã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼subsetæ‰€æœ‰ä»…ä»…æ»¡è¶³æ¡ä»¶destæ˜¯&amp;rdquo;MIA&amp;rdquo;çš„è¡Œ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(unique(origin), &amp;quot;MIA&amp;quot;)]
#       year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
#    1: 2014     1   1     1655        -5     2003       -17         0      AA  N5CFAA    172    EWR
#    2: 2014     1   1      607        -3      905       -10         0      AA  N5DMAA   1205    EWR
#    3: 2014     1   1     1125        -5     1427        -8         0      AA  N3AGAA   1623    EWR
#    4: 2014     1   1     1533        43     1840        42         0      UA  N491UA    244    EWR
#    5: 2014     1   1     2130        60       29        49         0      UA  N476UA    308    EWR
#   ---                                                                                             
# 9924: 2014    10  31     1348       -11     1658        -8         0      AA  N3AMAA   2283    LGA
# 9925: 2014    10  31      950        -5     1257       -11         0      AA  N3LFAA   2287    LGA
# 9926: 2014    10  31      658        -2     1017        10         0      AA  N3HNAA   2451    LGA
# 9927: 2014    10  31     1913        -2     2212       -16         0      AA  N3LFAA   2455    LGA
# 9928: 2014    10  31     1530         1     1839       -11         0      US  N768US   1715    LGA
#       dest air_time distance hour min
#    1:  MIA      161     1085   16  55
#    2:  MIA      154     1085    6   7
#    3:  MIA      157     1085   11  25
#    4:  MIA      155     1085   15  33
#    5:  MIA      162     1085   21  30
#   ---                                
# 9924:  MIA      157     1096   13  48
# 9925:  MIA      150     1096    9  50
# 9926:  MIA      156     1096    6  58
# 9927:  MIA      156     1096   19  13
# 9928:  MIA      164     1096   15  30
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Ÿ
* å›å¿†ä¸€ä¸‹åˆšåˆšè®²çš„å¤„ç†æ­¥éª¤ã€‚é¦–å…ˆï¼Œæ‰¾åˆ°æ»¡è¶³ç¬¬ä¸€ä¸ªä¸»é”®originåˆ—çš„æ¡ä»¶çš„è¡Œï¼›ç„¶ååœ¨è¿™ä¸ªç»“æœä¸­ï¼Œæ‰¾åˆ°æ»¡è¶³ç¬¬äºŒä¸ªä¸»é”®deståˆ—æ˜¯â€œMIAâ€çš„è¡Œã€‚æˆ‘ä»¬ä¸èƒ½ç®€å•åœ°äº‹å…ˆè·³è¿‡ç¬¬ä¸€ä¸ªä¸»é”®åˆ—ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡ä¸»é”® originåˆ—ï¼Œè·å¾—å®ƒæ‰€æœ‰å¯èƒ½çš„å–å€¼ã€‚
* â€œMIAâ€ä¼šè¢«è‡ªåŠ¨è¡¥è¶³æˆè·Ÿ unique(origin) åŒæ ·çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯3ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;2-å’Œå‚æ•°j-å‚æ•°byä¸€èµ·ä½¿ç”¨:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;2. å’Œå‚æ•°jã€å‚æ•°byä¸€èµ·ä½¿ç”¨&lt;/h2&gt;

&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å­¦ä¹ çš„éƒ½æ˜¯åŒæ ·çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å‚æ•°iå–å¾—è¡Œï¼Œåªæ˜¯ä½¿ç”¨äº†ä¸»é”®è¿™ç§æ–°çš„æ–¹æ³•ã€‚é‚£ä¹ˆåŒæ ·çš„ï¼Œæˆ‘ä»¬åœ¨å‚æ•°jå’Œå‚æ•°byé‡Œé¢ä½¿ç”¨ä¸»é”®ï¼Œä¹Ÿæ²¡ä»€ä¹ˆå¤§æƒŠå°æ€ªçš„ã€‚æˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥è¯´æ˜ã€‚&lt;/p&gt;

&lt;h4 id=&#34;a-åœ¨å‚æ•°jé‡Œé¢select:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;a) åœ¨å‚æ•°jé‡Œé¢select&lt;/h4&gt;

&lt;p&gt;ï¼è¿”å›ç¬¦åˆ origin = &amp;ldquo;LGA&amp;rdquo; å’Œ dest = &amp;ldquo;TPA&amp;rdquo;è¿™ä¸¤ä¸ªæ¡ä»¶çš„ arr_delayåˆ—&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;key(flights)
# [1] &amp;quot;origin&amp;quot; &amp;quot;dest&amp;quot;
flights[.(&amp;quot;LGA&amp;quot;, &amp;quot;TPA&amp;quot;), .(arr_delay)]
#       arr_delay
#    1:         1
#    2:        14
#    3:       -17
#    4:        -4
#    5:       -12
#   ---          
# 1848:        39
# 1849:       -24
# 1850:       -12
# 1851:        21
# 1852:       -11
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* é€šè¿‡åŸºäºä¸»é”®çš„subsetï¼Œæˆ‘ä»¬è·å¾—äº†æ»¡è¶³ origin == &amp;quot;LGA&amp;quot; å’Œ dest == â€œTPAâ€è¿™ä¸¤ä¸ªæ¡ä»¶çš„è¡Œç´¢å¼•ã€‚
* ç°åœ¨æˆ‘ä»¬å·²ç»è·å¾—äº†è¿™äº›è¡Œçš„ç´¢å¼•ï¼Œè€Œå‚æ•°jåªè¯·æ±‚äº† arr_delayåˆ—ã€‚é‚£ä¹ˆæˆ‘ä»¬ç®€å•åœ°ä»è¿™äº›è¡Œç´¢å¼•ä¸­é€‰å– arr_delayåˆ—ï¼Œå°±åƒæˆ‘ä»¬åœ¨ç¬¬ä¸€è®²ä¸­åšçš„é‚£æ ·ã€‚
* åŒä»¥å‰ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®š with = FALSEï¼š
flights[.(&amp;quot;LGA&amp;quot;, &amp;quot;TPA&amp;quot;), &amp;quot;arr_delay&amp;quot;, with=FALSE]
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;b-chainingè¡¨è¾¾å¼:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;b) Chainingè¡¨è¾¾å¼&lt;/h4&gt;

&lt;p&gt;ï¼åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šï¼Œå°†ç»“æœç”¨chainingè¡¨è¾¾å¼æŒ‰é™åºæ’åˆ—&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(&amp;quot;LGA&amp;quot;, &amp;quot;TPA&amp;quot;), .(arr_delay)][order(-arr_delay)]
#       arr_delay
#    1:       486
#    2:       380
#    3:       351
#    4:       318
#    5:       300
#   ---          
# 1848:       -40
# 1849:       -43
# 1850:       -46
# 1851:       -48
# 1852:       -49
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;c-åœ¨å‚æ•°jé‡Œè¿ç®—:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;c) åœ¨å‚æ•°jé‡Œè¿ç®—&lt;/h4&gt;

&lt;p&gt;ï¼æ‰¾å‡ºç¬¦åˆ origin = &amp;ldquo;LGA&amp;rdquo; å’Œ dest = &amp;ldquo;TPA&amp;rdquo;è¿™ä¸¤ä¸ªæ¡ä»¶çš„èˆªç­çš„æœ€å¤§åˆ°è¾¾å»¶è¯¯æ—¶é—´&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(&amp;quot;LGA&amp;quot;, &amp;quot;TPA&amp;quot;), max(arr_delay)]
# [1] 486
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æ³¨æ„ä¸€ä¸‹ï¼Œè¿™ä¸ªç»“æœ(486)ï¼Œå°±æ˜¯b)çš„ç»“æœçš„ç¬¬ä¸€è¡Œçš„å€¼ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;d-åœ¨å‚æ•°jé‡Œä½¿ç”¨æ“ä½œç¬¦-æ¥sub-assign:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;d) åœ¨å‚æ•°jé‡Œä½¿ç”¨æ“ä½œç¬¦&amp;rdquo;:=&amp;ldquo;æ¥sub-assign&lt;/h4&gt;

&lt;p&gt;æˆ‘ä»¬å·²ç»åœ¨ç¬¬äºŒè®²&lt;a href=&#34;http://youngspring1.github.io/post/2016-03-21-datatable2/&#34;&gt;è¯­ä¹‰å¼•ç”¨&lt;/a&gt;é‡Œå­¦ä¹ äº†å‡ ä¸ªä¾‹å­äº†ã€‚ç°åœ¨æ¥çœ‹çœ‹filghtsé‡Œçš„ hoursåˆ—ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# get all &#39;hours&#39; in flights
flights[, sort(unique(hour))]
#  [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œhouråˆ—æœ‰25ç§ä¸åŒçš„å–å€¼ã€‚ä½†æ˜¯0ç‚¹å’Œ24ç‚¹åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬æ¥æŠŠ24ç‚¹å…¨éƒ¨æ›¿æ¢æˆ0ç‚¹ã€‚è¿™æ¬¡æˆ‘ä»¬ç”¨ä¸»é”®æ¥åšã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;setkey(flights, hour)
key(flights)
# [1] &amp;quot;hour&amp;quot;
flights[.(24), hour := 0L]
key(flights)
# NULL
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬é¦–å…ˆå°† houråˆ—è®¾ç½®ä¸ºä¸»é”®ã€‚è¿™ä¼šå°†flightsæŒ‰ç…§ houråˆ—é‡æ–°æ’åºï¼Œå¹¶ä¸”å°† houråˆ—æ ‡è®°ä¸ºä¸»é”®ã€‚
* ç°åœ¨æˆ‘ä»¬ç”¨ .()æ ‡è®°å¯¹houråˆ—æ¥subsetã€‚æˆ‘ä»¬subsetæ‰€æœ‰å€¼ä¸º24çš„è¡Œçš„ç´¢å¼•ã€‚
* å¯¹äºè¿™äº›è¡Œï¼Œæˆ‘ä»¬å°†ä¸»é”®åˆ—çš„å€¼æ›¿æ¢ä¸º0.
* æ—¢ç„¶æˆ‘ä»¬æ›¿æ¢äº†ä¸»é”®åˆ—çš„å€¼ï¼Œflightsä¹Ÿä¸å†æŒ‰ç…§ houråˆ—æ’åºäº†ã€‚å› æ­¤ï¼Œä¸»é”®è¢«è‡ªåŠ¨å»é™¤äº†ï¼Œå®ƒè¢«è®¾ç½®ä¸ºNULLã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç°åœ¨ï¼Œflightsçš„houråˆ—é‡Œï¼Œåº”è¯¥æ²¡æœ‰24äº†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[, sort(unique(hour))]
#  [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;e-ç”¨å‚æ•°byèšåˆ:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;e) ç”¨å‚æ•°byèšåˆ&lt;/h4&gt;

&lt;p&gt;æˆ‘ä»¬å…ˆå°† originåˆ— å’Œ deståˆ—è®¾ç½®ä¸ºä¸»é”®ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;setkey(flights, origin, dest)
key(flights)
# [1] &amp;quot;origin&amp;quot; &amp;quot;dest&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼è·å–æ¯ä¸ªæœˆä»â€œJFKâ€èµ·é£çš„èˆªç­çš„æœ€å¤§èµ·é£å»¶è¯¯æ—¶é—´ï¼ŒæŒ‰æœˆæ’åº&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[&amp;quot;JFK&amp;quot;, max(dep_delay), keyby=month]
head(ans)
#    month   V1
# 1:     1  881
# 2:     2 1014
# 3:     3  920
# 4:     4 1241
# 5:     5  853
# 6:     6  798
key(ans)
# [1] &amp;quot;month&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬å¯¹ä¸»é”® originåˆ—è¿›è¡Œsubsetï¼Œå¾—åˆ°äº†æ‰€æœ‰èµ·é£æœºåœºæ˜¯â€œJFKâ€çš„è¡Œç´¢å¼•ã€‚
* ç°åœ¨æˆ‘ä»¬å·²ç»å¾—åˆ°è¿™äº›è¡Œçš„ç´¢å¼•äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸¤åˆ—ï¼ç”¨æ¥åˆ†ç»„çš„monthåˆ—ï¼Œå’Œç”¨æ¥è®¡ç®—æ¯ç»„æœ€å¤§å€¼çš„dep_delayåˆ—ã€‚data.tableçš„æŸ¥è¯¢éƒ½è¢«ä¼˜åŒ–è¿‡äº†ï¼Œå› æ­¤åœ¨å‚æ•°iå–å¾—çš„è¡Œçš„åŸºç¡€ä¸Šï¼Œå†subsetè¿™ä¸¤åˆ—ï¼Œæ•ˆç‡å’Œå†…å­˜å¼€é”€éƒ½å¾ˆå¯è§‚ã€‚
* åœ¨subsetçš„æ—¶å€™ï¼Œæˆ‘ä»¬æŒ‰monthåˆ†ç»„ï¼Œå†è®¡ç®—dep_delayåˆ—çš„æœ€å¤§å€¼ã€‚
* æˆ‘ä»¬ä½¿ç”¨å‚æ•°keybyæ¥è‡ªåŠ¨å°†monthè®¾ç½®ä¸ºç»“æœçš„ä¸»é”®ã€‚ç°åœ¨æˆ‘ä»¬ç†è§£äº†ä¸ºä»€ä¹ˆå«keybyå§ã€‚å®ƒä½¿å¾—ç»“æœä¸ä»…æŒ‰monthåˆ—æ’åºï¼Œè€Œä¸”å°†monthè®¾ç½®ä¸ºä¸»é”®ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;3-å¦å¤–ä¸¤ä¸ªå‚æ•°multå’Œnomatch:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;3. å¦å¤–ä¸¤ä¸ªå‚æ•°multå’Œnomatch&lt;/h2&gt;

&lt;h4 id=&#34;a-å‚æ•°mult:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;a) å‚æ•°mult&lt;/h4&gt;

&lt;p&gt;å¯¹äºæ¯æ¬¡æŸ¥è¯¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‚æ•°multï¼ŒæŒ‡å®šæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è¡Œâ€œallâ€éƒ½è¢«è¿”å›ï¼Œè¿˜æ˜¯åªè¿”å›ç¬¬ä¸€è¡Œâ€œfirstâ€æˆ–è€…æœ€åä¸€è¡Œâ€œlastâ€ã€‚é»˜è®¤æ˜¯æ‰€æœ‰çš„è¡Œâ€œallâ€ã€‚&lt;br /&gt;
ï¼è·å–ç¬¦åˆorigin = &amp;ldquo;JFK&amp;rdquo; ä¸” dest = &amp;ldquo;MIA&amp;rdquo;çš„æ•°æ®çš„ç¬¬ä¸€è¡Œ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(&amp;quot;JFK&amp;quot;, &amp;quot;MIA&amp;quot;), mult=&amp;quot;first&amp;quot;]
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     1   1      546         6      853         3         0      AA  N5CGAA   2243    JFK
#    dest air_time distance hour min
# 1:  MIA      157     1089    5  46
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼è·å–ç¬¦åˆorigin = &amp;ldquo;LGA&amp;rdquo;æˆ–&amp;rdquo;JFK&amp;rdquo;æˆ–&amp;rdquo;EWR&amp;rdquo; ä¸” dest = &amp;ldquo;XNA&amp;rdquo;çš„æ•°æ®çš„æœ€åä¸€è¡Œ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(c(&amp;quot;LGA&amp;quot;, &amp;quot;JFK&amp;quot;, &amp;quot;EWR&amp;quot;), &amp;quot;XNA&amp;quot;), mult=&amp;quot;last&amp;quot;]
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     5  23     1803       163     2003       148         0      MQ  N515MQ   3553    LGA
# 2:   NA    NA  NA       NA        NA       NA        NA        NA      NA      NA     NA    JFK
# 3: 2014     2   3     1208       231     1516       268         0      EV  N14148   4419    EWR
#    dest air_time distance hour min
# 1:  XNA      158     1147   18   3
# 2:  XNA       NA       NA   NA  NA
# 3:  XNA      184     1131   12   8
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* JFKâ€, â€œXNAâ€ä¸åŒ¹é…flightsçš„ä»»ä½•ä¸€æ¡æ•°æ®ï¼Œå› æ­¤è¿”å› NAã€‚
* å†å¼ºè°ƒä¸€ä¸‹ï¼Œå‚æ•°ié‡ŒæŸ¥è¯¢è¯­å¥çš„ç¬¬äºŒä¸ªä¸»é”®deståˆ—ï¼Œ&amp;quot;XNA&amp;quot;ä¼šè¢«è‡ªåŠ¨è¡¥è¶³æˆè·Ÿç¬¬ä¸€ä¸ªä¸»é”®çš„å–å€¼ç­‰é•¿ï¼Œä¹Ÿå°±æ˜¯3ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;b-å‚æ•°nomatch:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;b) å‚æ•°nomatch&lt;/h4&gt;

&lt;p&gt;æˆ‘ä»¬å¯ä»¥é€šè¿‡å‚æ•°nomatchï¼ŒæŒ‡å®šåœ¨æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ•°æ®çš„æƒ…å†µä¸‹ï¼Œæ˜¯è¿”å›NAå‘¢ï¼Œè¿˜æ˜¯è·³è¿‡ï¼ˆä¸è¿”å›ï¼‰ã€‚&lt;br /&gt;
ï¼è·Ÿå‰ä¸€ä¸ªä¾‹å­ä¸€æ ·ï¼Œé€‰å–èƒ½æ‰¾åˆ°çš„æ•°æ®&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[.(c(&amp;quot;LGA&amp;quot;, &amp;quot;JFK&amp;quot;, &amp;quot;EWR&amp;quot;), &amp;quot;XNA&amp;quot;), mult=&amp;quot;last&amp;quot;, nomatch = 0L]
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     5  23     1803       163     2003       148         0      MQ  N515MQ   3553    LGA
# 2: 2014     2   3     1208       231     1516       268         0      EV  N14148   4419    EWR
#    dest air_time distance hour min
# 1:  XNA      158     1147   18   3
# 2:  XNA      184     1131   12   8
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* nomatchçš„é»˜è®¤æ˜¯æ˜¯NAã€‚è®¾ç½® nomatch = 0L è·³è¿‡å“ªäº›ä¸å­˜åœ¨çš„æ•°æ®ã€‚
* JFKâ€, â€œXNAâ€ä¸åŒ¹é…flightsçš„ä»»ä½•ä¸€æ¡æ•°æ®ï¼Œå› æ­¤å°±è¢«è·³è¿‡äº†ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;4-äºŒåˆ†æ³•æœç´¢-vs-å‘é‡æ‰«æ:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;4. äºŒåˆ†æ³•æœç´¢ vs å‘é‡æ‰«æ&lt;/h2&gt;

&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•è®¾ç½®å’Œä½¿ç”¨ä¸»é”®æ¥subsetã€‚ä½†æ˜¯å®ƒçš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼Œé™¤äº†è¿™ä¹ˆåšï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# key by origin,dest columns
flights[.(&amp;quot;JFK&amp;quot;, &amp;quot;MIA&amp;quot;)]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ‘ä»¬è¿˜å¯ä»¥è¿™æ ·åšï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[origin == &amp;quot;JFK&amp;quot; &amp;amp; dest == &amp;quot;MIA&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„ä¼˜ç‚¹æ˜¯ï¼Œçœ‹ä¸Šå»æ›´çŸ­ã€‚ä½†æ˜¯å®ƒçš„ä¼˜ç‚¹å¯ä¸åªæ˜¯è¿™ä¸ªï¼Œäº‹å®ä¸Šï¼ŒåŸºäºäºŒåˆ†æ³•æœç´¢çš„subsetéå¸¸å¿«é€Ÿã€‚&lt;/p&gt;

&lt;h4 id=&#34;a-äºŒåˆ†æ³•æœç´¢:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;a) äºŒåˆ†æ³•æœç´¢&lt;/h4&gt;

&lt;p&gt;ä¸ºäº†è¯´æ˜ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæœ‰ä¸¤åƒä¸‡è¡Œã€ä¸‰åˆ—çš„æ ·æœ¬æ•°æ®ï¼Œå°†å®ƒçš„ä¸»é”®è®¾ç½®ä¸ºxåˆ—å’Œyåˆ—ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(2L)
N = 2e7L
DT = data.table(x = sample(letters, N, TRUE), 
                y = sample(1000L, N, TRUE), 
                val=runif(N), key = c(&amp;quot;x&amp;quot;, &amp;quot;y&amp;quot;))
print(object.size(DT), units=&amp;quot;Mb&amp;quot;)
# 381.5 Mb

key(DT)
# [1] &amp;quot;x&amp;quot; &amp;quot;y&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;DTå¤§çº¦æœ‰ 380 MBã€‚è¿™ä¸ç®—ç‰¹åˆ«å¤§ï¼Œä½†æ˜¯è¶³å¤Ÿæˆ‘ä»¬ä½“ç°äºŒåˆ†æ³•æœç´¢çš„ä¼˜ç‚¹äº†ã€‚&lt;br /&gt;
ç”¨ç¬¬ä¸€è®²&lt;a href=&#34;http://youngspring1.github.io/post/2016-03-13-datatable1/&#34;&gt;data.table ä»‹ç»&lt;/a&gt;æˆ‘ä»¬å­¦è¿‡çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥subset é‚£äº› x = &amp;ldquo;g&amp;rdquo; å’Œ y = 877 çš„è¡Œã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;## (1) Usual way of subsetting - vector scan approach
t1 &amp;lt;- system.time(ans1 &amp;lt;- DT[x == &amp;quot;g&amp;quot; &amp;amp; y == 877L])
t1
#    user  system elapsed 
#   0.871   0.022   0.919
head(ans1)
#    x   y       val
# 1: g 877 0.3946652
# 2: g 877 0.9424275
# 3: g 877 0.7068512
# 4: g 877 0.6959935
# 5: g 877 0.9673482
# 6: g 877 0.4842585
dim(ans1)
# [1] 761   3
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç°åœ¨æˆ‘ä»¬ç”¨ä¸»é”®æ¥è¯•ç€åšä¸€ä¸‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;## (2) Subsetting using keys
t2 &amp;lt;- system.time(ans2 &amp;lt;- DT[.(&amp;quot;g&amp;quot;, 877L)])
t2
#    user  system elapsed 
#   0.001   0.000   0.002
head(ans2)
#    x   y       val
# 1: g 877 0.3946652
# 2: g 877 0.9424275
# 3: g 877 0.7068512
# 4: g 877 0.6959935
# 5: g 877 0.9673482
# 6: g 877 0.4842585
dim(ans2)
# [1] 761   3

identical(ans1$val, ans2$val)
# [1] TRUE
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(2)æ¯”(1)å¿«äº†460å€ï¼&lt;/p&gt;

&lt;h4 id=&#34;b-ä¸ºä»€ä¹ˆç”¨ä¸»é”®subsetèƒ½è¿™ä¹ˆå¿«:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;b) ä¸ºä»€ä¹ˆç”¨ä¸»é”®subsetèƒ½è¿™ä¹ˆå¿«?&lt;/h4&gt;

&lt;p&gt;ä¸ºäº†ç†è§£è¿™äº›ï¼Œæˆ‘ä»¬å…ˆçœ‹ç¬¬ä¸€ç§æ–¹æ³•(1)å‘é‡æ‰«æã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;å‘é‡æ‰«æ
* åœ¨æ‰€æœ‰ä¸¤åƒæ¡æ•°æ®ä¸­ï¼Œé€è¡Œæœç´¢ xåˆ—é‡Œå€¼ä¸ºâ€œgâ€çš„è¡Œã€‚è¿™ä¼šç”Ÿæˆä¸€ä¸ªæœ‰ä¸¤åƒè¡Œçš„é€»è¾‘å‘é‡ï¼Œæ ¹æ®å’Œxåˆ—çš„æ‰¹è¯„ç»“æœï¼Œå®ƒæ¯ä¸ªå…ƒç´ çš„å–å€¼å¯èƒ½æ˜¯TRUE, FALSE ä»¥åŠ NAã€‚
* ç›¸ä¼¼çš„ï¼Œåœ¨æ‰€æœ‰ä¸¤åƒæ¡æ•°æ®ä¸­ï¼Œé€è¡Œæœç´¢ yåˆ—é‡Œå€¼ä¸ºâ€œ877â€çš„è¡Œï¼Œå†ä¿å­˜åœ¨å¦ä¸€ä¸ªé€»è¾‘å‘é‡é‡Œé¢ã€‚
* æ“ä½œç¬¦&amp;quot;&amp;amp;&amp;quot;å¯¹ä¸Šé¢ä¸¤ä¸ªé€»è¾‘å‘é‡è¿›è¡Œâ€œä¸”â€è¿ç®—ï¼Œè¿”å›ç»“æœä¸ºTRUEçš„è¡Œ
è¿™å°±æ˜¯æ‰€è°“çš„â€œå‘é‡æ‰«æâ€ã€‚æ•ˆç‡éå¸¸ä½ï¼Œç‰¹åˆ«æ˜¯æ•°æ®é‡å¾ˆå¤§ã€éœ€è¦é‡å¤subsetçš„æ—¶å€™ã€‚å› ä¸ºå®ƒæ¯æ¬¡ä¸å¾—ä¸å¯¹æ•´ä¸ªæ•°æ®å…¨ç›˜æ‰«æã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç°åœ¨æˆ‘ä»¬å¼€çœ‹çœ‹ç¬¬äºŒç§æ–¹æ³•(2)äºŒåˆ†æ³•æœç´¢ã€‚å›å¿†ä¸€ä¸‹å‰é¢â€œa)ä»€ä¹ˆæ˜¯ä¸»é”®â€é‡Œçš„å®šä¹‰ï¼Œæ ¹æ®ä¸»é”®åˆ—é‡æ–°æ’åºã€‚æ—¢ç„¶æ•°æ®è¢«æ’åºäº†ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦å†å¯¹æ•´ä¸ªæ•°æ®è¿›è¡Œæ‰«æã€‚æˆ‘ä»¬ç”¨äºŒåˆ†æ³•æœç´¢çš„æ—¶é—´å¼€é”€æ˜¯ O(log n)ï¼Œè€Œå‘é‡æ‰«æçš„æ—¶é—´å¼€é”€æ˜¯ O(n)ï¼Œå…¶ä¸­næ˜¯data.tableçš„è¡Œæ•°ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;äºŒåˆ†æ³•æœç´¢
è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ã€‚çœ‹çœ‹ä¸‹é¢è¿™ç»„æ’è¿‡åºçš„æ•°å­—ï¼š
1, 5, 10, 19, 22, 23, 30
å‡è®¾æˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°æ•°å­—1çš„ä½ç½®ï¼Œç”¨äºŒåˆ†æ³•æœç´¢ï¼ˆå› ä¸ºè¿™ç»„æ•°å­—æ˜¯æ’è¿‡åºçš„ï¼‰ï¼Œæˆ‘ä»¬æ˜¯è¿™ä¹ˆåšçš„ï¼š
* ä»ä¸­é—´çš„æ•°å¼€å§‹ï¼Œå®ƒæ˜¯19ï¼Œä¸æ˜¯1ï¼Œè€Œä¸” 1&amp;lt;19ã€‚
* æ—¢ç„¶æˆ‘ä»¬è¦æ‰¾çš„æ•°å­—1å°äº19ï¼Œé‚£å®ƒåº”è¯¥æ’åœ¨19å‰é¢ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ— è§†19åé¢çš„é‚£ä¸€åŠæ•°æ®ï¼Œå› ä¸ºå®ƒä»¬éƒ½å¤§äº19.
* ç°åœ¨æˆ‘ä»¬çš„æ•°æ®åªå‰©ä¸‹1, 5, 10ã€‚å†æ‰¾åˆ°ä¸­é—´çš„æ•°5ï¼Œå®ƒä¸æ˜¯1ï¼Œè€Œä¸” 1&amp;lt;5ã€‚
* ç°åœ¨æˆ‘ä»¬çš„æ•°æ®åªå‰©ä¸‹1ã€‚ç¬¦åˆæ¡ä»¶ã€‚è¿™å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„æ•°ã€‚
ç›¸åçš„ï¼Œå‘é‡æ‰«æéœ€è¦æ‰«ææ‰€æœ‰çš„æ•°å­—ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯7ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ˜¾è€Œæ˜“è§çš„ï¼Œæˆ‘ä»¬æ¯æ¬¡æœç´¢çš„æ—¶å€™ï¼Œæœç´¢é‡éƒ½æ˜¯åŸå…ˆçš„ä¸€åŠã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåŸºäºäºŒåˆ†æ³•æœç´¢çš„subsetæ˜¯å¦‚æ­¤çš„å¿«ã€‚&lt;br /&gt;
å› ä¸ºdata.tableçš„è¡Œåœ¨å†…å­˜ä¸­æ˜¯è¿ç»­å­˜å‚¨çš„ï¼Œè¿™ç§subsetçš„æ“ä½œä¹Ÿå¾ˆèŠ‚çœç¼“å­˜ï¼Œè¿™æœ‰åˆ©äºå¤„ç†é€Ÿåº¦ã€‚&lt;br /&gt;
å¦å¤–ï¼Œæ—¢ç„¶æˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºè¶…å¤§ï¼ˆè·ŸåŸæ•°æ®æœ‰åŒæ ·å¤šçš„è¡Œï¼‰çš„é€»è¾‘å‘é‡ï¼Œå°±èƒ½å–å¾—åŒ¹é…çš„è¡Œçš„ç´¢å¼•ï¼Œè¿™ç§subsetä¹Ÿèƒ½èŠ‚çœå†…å­˜ã€‚&lt;/p&gt;

&lt;h2 id=&#34;æ€»ç»“:e288dbec01fe10fa9bd0f8ade4810458&#34;&gt;æ€»ç»“&lt;/h2&gt;

&lt;p&gt;åœ¨è¿™ä¸€è®²ï¼Œæˆ‘ä»¬å­¦ä¹ äº†é€šè¿‡è®¾ç½®ä¸»é”®æ¥subsetè¡Œã€‚è®¾ç½®ä¸»é”®ä½¿ç”¨äº†äºŒåˆ†æ³•æœç´¢ä¼¼çš„subsetçš„æ“ä½œå˜å¾—æƒŠäººçš„å¿«ã€‚ç‰¹åˆ«çš„ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* è®¾ç½®ä¸»é”®ï¼Œå¹¶ä½¿ç”¨ä¸»é”®subsetè¡Œã€‚
* æ›´å¿«çš„åœ¨å‚æ•°ié‡Œé€šè¿‡ä¸»é”®subsetè¡Œçš„ç´¢å¼•ã€‚
* å°†ä¸»é”®å’Œå‚æ•°jã€å‚æ•°byä¸€èµ·ä½¿ç”¨ã€‚æ³¨æ„å‚æ•°jå’Œå‚æ•°byçš„ä½¿ç”¨æ–¹æ³•å’Œä»¥å‰ä¸€æ ·ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ‘ä»¬å¤§æ¦‚ä¸éœ€è¦ç”¨ä¸»é”®æ¥è¿›è¡Œèšåˆçš„æ“ä½œï¼Œé™¤éæ•°æ®äº†æå…¶å·¨å¤§ï¼Œä½¿å¾—æˆ‘ä»¬éœ€è¦é‡å¤åœ°åšå¾ˆå¤šæ¬¡subsetï¼Œè¿™å°±ä¼šè®©æ•ˆæœå˜å¾—å¾ˆé†’ç›®ã€‚&lt;br /&gt;
ç„¶è€Œï¼Œå½“è¿ç»“ä¸¤ä¸ªdata.tableçš„æ—¶å€™ï¼Œè®¾ç½®ä¸»é”®æ˜¯å¿…è¦çš„ã€‚è¿™æ˜¯ä¸‹ä¸€è®²çš„ä¸»é¢˜ã€‚&lt;br /&gt;
æˆ‘ä»¬ä¼šè¯¦ç»†è®²è§£æ ¹æ®ä¸»é”®åˆ—æ¥è¿ç»“ä¸¤ä¸ªdata.tableã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>data.table æ•™ç¨‹2ï¼ˆæ ¡å¯¹ä¸­ï¼‰</title>
      <link>http://youngspring1.github.io/post/2016/2016-03-21-datatable2/</link>
      <pubDate>Mon, 21 Mar 2016 19:56:45 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-03-21-datatable2/</guid>
      <description>

&lt;p&gt;ç›®å½•ï¼š&lt;br /&gt;
1) &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-13-datatable1/&#34;&gt;data.table ä»‹ç»&lt;/a&gt;&lt;br /&gt;
2) è¯­ä¹‰å¼•ç”¨&lt;br /&gt;
3) &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-22-datatable3/&#34;&gt;ä¸»é”®ã€åŸºäºäºŒåˆ†æ³•æœç´¢çš„subset&lt;/a&gt;&lt;br /&gt;
4) [äºŒæ¬¡ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•]()&lt;br /&gt;
5) Efficient reshaping using data.tables&lt;/p&gt;

&lt;p&gt;åŸæ–‡åœ°å€ï¼š&lt;br /&gt;
1) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-intro-vignette.html&#34;&gt;Introduction to data.table&lt;/a&gt;&lt;br /&gt;
2) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-reference-semantics.html&#34;&gt;Reference semantics&lt;/a&gt;&lt;br /&gt;
3) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-keys-fast-subset.html&#34;&gt;Keys and fast binary search based subsets&lt;/a&gt;&lt;br /&gt;
4) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-secondary-indices-and-auto-indexing.html&#34;&gt;Secondary indices and auto indexing&lt;/a&gt;&lt;br /&gt;
5) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-reshape.html&#34;&gt;Efficient reshaping using data.tables&lt;/a&gt;&lt;br /&gt;
6) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-faq.html&#34;&gt;Frequently asked questions&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;æœ¬æ•™ç¨‹è®¨è®ºdata.tableçš„è¯­ä¹‰å¼•ç”¨ï¼Œå®ƒå…è®¸é€šè¿‡å¼•ç”¨æ¥add/update/deleteåˆ—ï¼Œç„¶åé€šè¿‡å‚æ•°iå’Œbyç»“åˆã€‚å®ƒä¸»è¦ç»™é‚£äº›ç†Ÿæ‚‰data.tableè¯­æ³•ã€çŸ¥é“å¦‚ä½•subsetè¡Œï¼selectåˆ—ï¼åˆ†ç»„çš„äººä½¿ç”¨ã€‚å¦‚æœä½ å¯¹è¿™äº›ä¸ç†Ÿæ‚‰ï¼Œè¯·å­¦ä¹ ä¸Šä¸€è®² &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-13-datatable1/&#34;&gt;data.table ä»‹ç»&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;æ•°æ®:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;æ•°æ®&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬ç»§ç»­ä½¿ç”¨ä¸Šä¸€è®²ä¸­ä½¿ç”¨çš„èˆªç­ä¿¡æ¯flightsã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights &amp;lt;- fread(&amp;quot;https://raw.githubusercontent.com/wiki/arunsrinivasan/    flights/NYCflights14/flights14.csv&amp;quot;)
flights
#         year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight
#      1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1
#      2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3
#      3: 2014     1   1     1902         2     2224         9         0      AA  N327AA     21
#      4: 2014     1   1      722        -8     1014       -26         0      AA  N3EHAA     29
#      5: 2014     1   1     1347         2     1706         1         0      AA  N319AA    117
#     ---                                                                                      
# 253312: 2014    10  31     1459         1     1747       -30         0      UA  N23708   1744
# 253313: 2014    10  31      854        -5     1147       -14         0      UA  N33132   1758
# 253314: 2014    10  31     1102        -8     1311        16         0      MQ  N827MQ   3591
# 253315: 2014    10  31     1106        -4     1325        15         0      MQ  N511MQ   3592
# 253316: 2014    10  31      824        -5     1045         1         0      MQ  N813MQ   3599
#         origin dest air_time distance hour min
#      1:    JFK  LAX      359     2475    9  14
#      2:    JFK  LAX      363     2475   11  57
#      3:    JFK  LAX      351     2475   19   2
#      4:    LGA  PBI      157     1035    7  22
#      5:    JFK  LAX      350     2475   13  47
#     ---                                       
# 253312:    LGA  IAH      201     1416   14  59
# 253313:    EWR  IAH      189     1400    8  54
# 253314:    LGA  RDU       83      431   11   2
# 253315:    LGA  DTW       75      502   11   6
# 253316:    LGA  SDF      110      659    8  24
dim(flights)
# [1] 253316     17
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;ä»‹ç»:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;ä»‹ç»&lt;/h2&gt;

&lt;p&gt;åœ¨è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä¼šï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* ç®€è¦è®¨è®ºâ€œè¯­ä¹‰å¼•ç”¨â€ï¼Œç„¶åæ¯”è¾ƒæ“ä½œç¬¦â€œ:=â€çš„ä¸¤ç§ä¸åŒçš„å½¢å¼ã€‚
* å­¦ä¹ å¦‚ä½•åœ¨å‚æ•°jé‡Œé¢ä½¿ç”¨æ“ä½œç¬¦â€œ:=â€æ¥add/update/deleteåˆ—ï¼Œå¦‚ä½•ä¸å‚æ•°iå’Œbyç›¸ç»“åˆã€‚
* äº†è§£æ“ä½œç¬¦â€œ:=â€çš„å‰¯ä½œç”¨ï¼Œå¹¶å­¦ä¹ å¦‚ä½•ç”¨ copy() æ¥é¿å…è¿™äº›å‰¯ä½œç”¨ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;1-è¯­ä¹‰å¼•ç”¨:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;1. è¯­ä¹‰å¼•ç”¨&lt;/h2&gt;

&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å­¦ä¹ åˆ°çš„æ‰€æœ‰çš„æ“ä½œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ•°æ®é›†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ å¦‚ä½•åœ¨åŸæ¥æ•°æ®é›†çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ ï¼æ›´æ–°ï¼åˆ é™¤é‚£äº›å·²ç»å­˜åœ¨çš„åˆ—ã€‚&lt;/p&gt;

&lt;h4 id=&#34;a-èƒŒæ™¯:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;a) èƒŒæ™¯&lt;/h4&gt;

&lt;p&gt;åœ¨å­¦ä¹ è¯­ä¹‰å¼•ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹é¢è¿™ä¸ªdata.frameï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DF = data.frame(ID = c(&amp;quot;b&amp;quot;,&amp;quot;b&amp;quot;,&amp;quot;b&amp;quot;,&amp;quot;a&amp;quot;,&amp;quot;a&amp;quot;,&amp;quot;c&amp;quot;), a = 1:6, b = 7:12, c=13:18)
DF
#   ID a  b  c
# 1  b 1  7 13
# 2  b 2  8 14
# 3  b 3  9 15
# 4  a 4 10 16
# 5  a 5 11 17
# 6  c 6 12 18
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å½“æˆ‘ä»¬æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DF$c &amp;lt;- 18:13               # (1) -- replace entire column
# or
DF$c[DF$ID == &amp;quot;b&amp;quot;] &amp;lt;- 15:13 # (2) -- subassign in column &#39;c&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨Rè¯­è¨€V3.1ä¹‹å‰çš„ç‰ˆæœ¬é‡Œï¼Œä¸Šé¢è¿™ä¸¤ç§æ–¹æ³•éƒ½ä¼šå¯¼è‡´å¯¹æ•´ä¸ªdata.frameçš„æ·±åº¦æ‹·è´&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:e5b9ad2772afb60de67bb09a99ffa4e1:1&#34;&gt;&lt;a rel=&#34;footnote&#34; href=&#34;#fn:e5b9ad2772afb60de67bb09a99ffa4e1:1&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;ã€‚è€Œä¸”è¿˜ä¼šæ‹·è´å¤šæ¬¡&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:e5b9ad2772afb60de67bb09a99ffa4e1:2&#34;&gt;&lt;a rel=&#34;footnote&#34; href=&#34;#fn:e5b9ad2772afb60de67bb09a99ffa4e1:2&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;ã€‚ä¸ºäº†æé«˜æ•ˆç‡é¿å…å†—ä½™æ“ä½œï¼Œdata.tabelä½¿ç”¨äº†æ“ä½œç¬¦&amp;rdquo;:=&amp;ldquo;ã€‚Ré‡Œé¢æœ¬æ¥å°±æœ‰å®šä¹‰äº†è¿™ä¸ªæ“ä½œç¬¦ï¼Œä½†å´æ²¡æœ‰ä½¿ç”¨&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:e5b9ad2772afb60de67bb09a99ffa4e1:3&#34;&gt;&lt;a rel=&#34;footnote&#34; href=&#34;#fn:e5b9ad2772afb60de67bb09a99ffa4e1:3&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;ã€‚&lt;br /&gt;
åœ¨Rè¯­è¨€V3.1ä¹‹å‰çš„ç‰ˆæœ¬é‡Œï¼Œæ–¹æ³•(1)åªåšå½±å­æ‹·è´ï¼Œå¤„ç†æ€§èƒ½æœ‰äº†å¾ˆå¤§æå‡ã€‚ç„¶è€Œï¼Œæ–¹æ³•(2)è¿˜æ˜¯ä¼šåšæ·±åº¦æ‹·è´ã€‚è¿™å°±æ„å‘³ç€ï¼Œå¯¹äºåŒæ ·çš„æŸ¥è¯¢è¯­å¥ï¼Œæƒ³è¦é€‰å–çš„åˆ—è¶Šå¤šï¼Œéœ€è¦åšçš„æ·±åº¦æ‹·è´å°±è¶Šå¤šã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;å½±å­æ‹·è´ vs æ·±åº¦æ‹·è´
å½±å­æ‹·è´ï¼Œåªæ˜¯ä¸€ä»½æŒ‡å‘åˆ—çš„æŒ‡é’ˆå‘é‡çš„æ‹·è´ï¼Œå®ƒä¼šéšç€data.frameæˆ–è€…data.tableçš„å˜åŒ–è€Œå˜åŒ–ã€‚ä½†åœ¨å†…å­˜é‡Œï¼Œæ•°æ®ä¸æ˜¯çœŸçš„è¢«å¤åˆ¶äº†ã€‚   
æ·±åº¦æ‹·è´ï¼Œæ­£ç›¸åï¼Œå®ƒä¼šå¤åˆ¶æ•´ä¸ªæ•°æ®ï¼Œå¹¶ä¸”ä¿å­˜åœ¨å†…å­˜é‡Œã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚æœä½¿ç”¨æ“ä½œç¬¦&amp;rdquo;:=&amp;ldquo;ï¼Œä¸ç®¡åœ¨Rè¯­è¨€çš„ä»€ä¹ˆç‰ˆæœ¬é‡Œï¼Œä¸ç®¡æ˜¯æ–¹æ³•(1)è¿˜æ˜¯æ–¹æ³•(2)ï¼Œéƒ½ä¸ä¼šå†æ‹·è´ã€‚è¿™æ˜¯å› ä¸ºï¼Œæ“ä½œç¬¦&amp;rdquo;:=&amp;ldquo;é€šè¿‡å¼•ç”¨æ›´æ–°åˆ—ã€‚&lt;/p&gt;

&lt;h4 id=&#34;b-æ“ä½œç¬¦:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;b) æ“ä½œç¬¦â€œ:=â€&lt;/h4&gt;

&lt;p&gt;åœ¨å‚æ•°jä¸­ï¼Œæ“ä½œç¬¦â€œ:=â€æœ‰ä¸¤ç§ä½¿ç”¨æ–¹æ³•ï¼š&lt;br /&gt;
a.å·¦å³ç­‰å¼çš„å½¢å¼&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT[, c(&amp;quot;colA&amp;quot;, &amp;quot;colB&amp;quot;, ...) := list(valA, valB, ...)]

# when you have only one column to assign to you 
# can drop the quotes and list(), for convenience
DT[, colA := valA]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;b.å‡½æ•°å½¢å¼&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT[, `:=`(colA = valA, # valA is assigned to colA
      colB = valB, # valB is assigned to colB
      ...
)]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ä¸Šé¢çš„ä¸¤ä¸ªä¾‹å­åªæ˜¯ç”¨æ¥è¯´æ˜ä½¿ç”¨çš„å½¢å¼ï¼Œå¹¶ä¸æ˜¯å®é™…å¯ä»¥è¿è¡Œçš„ä»£ç ç¤ºä¾‹ã€‚æˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œç”¨èˆªç­ä¿¡æ¯flightçš„data.tableæ¥ä¸¾ä¾‹è¯´æ˜ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* å½¢å¼(a)æ¯”è¾ƒå®¹æ˜“ç¼–ç ï¼Œç‰¹åˆ«æ˜¯ï¼Œäº‹å…ˆä¸çŸ¥é“éœ€è¦è¢«èµ‹å€¼çš„åˆ—çš„æ—¶å€™ã€‚
* ç›¸å¯¹è€Œè¨€ï¼Œå½¢å¼(b)æ›´åŠ è¶æ‰‹ï¼Œå¦‚æœä½ æ„¿æ„è¿½åŠ ç‚¹æ³¨é‡ŠğŸ˜„ã€‚
* æ“ä½œç¬¦â€œ:=â€æ²¡æœ‰è¿”å›å€¼ã€‚
* æ—¢ç„¶å‚æ•°jé‡Œé¢å¯ä»¥ä½¿ç”¨æ“ä½œç¬¦â€œ:=â€ï¼Œé‚£ä¹ˆï¼Œå°±åƒä¸Šä¸€è®²ä¸­å­¦ä¹ åˆ°çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥å’Œå‚æ•°iå’Œå‚æ•°byä¸€èµ·ï¼Œåšäº›èšåˆçš„è¿ç®—ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨ä¸Šé¢ä¸¤ç§å½¢å¼é‡Œï¼Œæ³¨æ„æˆ‘ä»¬æ²¡æœ‰æŠŠè¿ç®—çš„ç»“æœèµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ã€‚å› ä¸ºå®Œå…¨æ²¡å¿…è¦ã€‚æˆ‘ä»¬ç›´æ¥æ›´æ–°data.tableã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›ä¾‹å­æ¥è¯´æ˜ã€‚&lt;br /&gt;
åœ¨æ¥ä¸‹æ¥çš„æ•™ç¨‹é‡Œï¼Œæˆ‘ä»¬å¯¹èˆªç­ä¿¡æ¯flightï¼Œè¿™ä¸ªdata.tableæ¥ç¤ºä¾‹ã€‚&lt;/p&gt;

&lt;h2 id=&#34;2-æ·»åŠ -æ›´æ–°-åˆ é™¤åˆ—:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;2. æ·»åŠ ï¼æ›´æ–°ï¼åˆ é™¤åˆ—&lt;/h2&gt;

&lt;h4 id=&#34;a-æ·»åŠ åˆ—:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;a) æ·»åŠ åˆ—&lt;/h4&gt;

&lt;p&gt;ï¼å¦‚ä½•å¯¹æ¯æ¬¡èˆªç­ï¼Œæ·»åŠ  speed å’Œ total delay ä¸¤åˆ—&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[, `:=`(speed = distance / (air_time/60), # speed in km/hr
           delay = arr_delay + dep_delay)]       # delay in minutes
head(flights)
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1    JFK
# 2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3    JFK
# 3: 2014     1   1     1902         2     2224         9         0      AA  N327AA     21    JFK
# 4: 2014     1   1      722        -8     1014       -26         0      AA  N3EHAA     29    LGA
# 5: 2014     1   1     1347         2     1706         1         0      AA  N319AA    117    JFK
# 6: 2014     1   1     1824         4     2145         0         0      AA  N3DEAA    119    EWR
#    dest air_time distance hour min    speed delay
# 1:  LAX      359     2475    9  14 413.6490    27
# 2:  LAX      363     2475   11  57 409.0909    10
# 3:  LAX      351     2475   19   2 423.0769    11
# 4:  PBI      157     1035    7  22 395.5414   -34
# 5:  LAX      350     2475   13  47 424.2857     3
# 6:  LAX      339     2454   18  24 434.3363     4

## alternatively, using the &#39;LHS := RHS&#39; form
# flights[, c(&amp;quot;speed&amp;quot;, &amp;quot;delay&amp;quot;) := list(distance/(air_time/60), arr_delay + dep_delay)]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬ä¸éœ€è¦å°†ç»“æœèµ‹å€¼ç»™ flightsã€‚
* flights ç°åœ¨åŒ…å«äº†åˆšåˆšè¿½åŠ çš„ä¸¤åˆ—ã€‚è¿™å°±æ˜¯æˆ‘ä»¬è¯´çš„â€œæ·»åŠ åˆ—â€ã€‚
* æˆ‘ä»¬ç”¨å‡½æ•°å½¢å¼ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æ—è¾¹å†™æ³¨é‡Šäº†ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç”¨ç­‰å¼çš„å½¢å¼ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;b-æ›´æ–°åˆ—-sub-assign:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;b) æ›´æ–°åˆ—ï¼ˆsub-assignï¼‰&lt;/h4&gt;

&lt;p&gt;ç°åœ¨ç•™æ„ä¸€ä¸‹ fligths é‡Œçš„ houråˆ—ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# get all &#39;hours&#39; in flights
flights[, sort(unique(hour))]
#  [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œhouråˆ—æœ‰25ç§ä¸åŒçš„å–å€¼ã€‚ä½†æ˜¯0ç‚¹å’Œ24ç‚¹åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬æ¥æŠŠ24ç‚¹å…¨éƒ¨æ›¿æ¢æˆ0ç‚¹ã€‚&lt;br /&gt;
ï¼å°† hour=24 æ›¿æ¢æˆ0&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# subassign by reference
flights[hour == 24L, hour := 0L]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* å°±åƒåœ¨ä¸Šä¸€è®²ä¸­å­¦ä¹ çš„ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‚æ•°i å’Œ å‚æ•°jé‡Œçš„æ“ä½œç¬¦â€œ:=â€ä¸€èµ·ä½¿ç”¨ã€‚
* åªæœ‰æ»¡è¶³äº†å‚æ•°i ä¸­æŒ‡å®šçš„æ¡ä»¶ hour == 24L çš„é‚£äº›åˆ—ï¼Œå®ƒä»¬çš„å€¼ä¼šè¢«æ›¿æ¢æˆ0ã€‚
* æ“ä½œç¬¦â€œ:=â€æ²¡æœ‰è¿”å›å€¼ã€‚æœ‰æ—¶å€™éœ€è¦æŸ¥çœ‹è¿è¡Œçš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æŸ¥è¯¢è¯­å¥çš„æœ€ååŠ ä¸€å¯¹æ–¹æ‹¬å·[]ï¼Œæ¥è¾¾åˆ°è¿™ä¸ªç›®çš„ã€‚
flights[hour == 24L, hour := 0L][]
#         year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight
#      1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1
#      2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3
#      3: 2014     1   1     1902         2     2224         9         0      AA  N327AA     21
#      4: 2014     1   1      722        -8     1014       -26         0      AA  N3EHAA     29
#      5: 2014     1   1     1347         2     1706         1         0      AA  N319AA    117
#     ---                                                                                      
# 253312: 2014    10  31     1459         1     1747       -30         0      UA  N23708   1744
# 253313: 2014    10  31      854        -5     1147       -14         0      UA  N33132   1758
# 253314: 2014    10  31     1102        -8     1311        16         0      MQ  N827MQ   3591
# 253315: 2014    10  31     1106        -4     1325        15         0      MQ  N511MQ   3592
# 253316: 2014    10  31      824        -5     1045         1         0      MQ  N813MQ   3599
#         origin dest air_time distance hour min    speed delay
#      1:    JFK  LAX      359     2475    9  14 413.6490    27
#      2:    JFK  LAX      363     2475   11  57 409.0909    10
#      3:    JFK  LAX      351     2475   19   2 423.0769    11
#      4:    LGA  PBI      157     1035    7  22 395.5414   -34
#      5:    JFK  LAX      350     2475   13  47 424.2857     3
#     ---                                                      
# 253312:    LGA  IAH      201     1416   14  59 422.6866   -29
# 253313:    EWR  IAH      189     1400    8  54 444.4444   -19
# 253314:    LGA  RDU       83      431   11   2 311.5663     8
# 253315:    LGA  DTW       75      502   11   6 401.6000    11
# 253316:    LGA  SDF      110      659    8  24 359.4545    -4
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç°åœ¨æˆ‘ä»¬å†æ¥çœ‹ä¸‹ houråˆ—ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# check again for &#39;24&#39;
flights[, sort(unique(hour))]
#  [1]  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;c-åˆ é™¤åˆ—:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;c) åˆ é™¤åˆ—&lt;/h4&gt;

&lt;p&gt;ï¼åˆ é™¤ delayåˆ—&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[, c(&amp;quot;delay&amp;quot;) := NULL]
head(flights)
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1    JFK
# 2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3    JFK
# 3: 2014     1   1     1902         2     2224         9         0      AA  N327AA     21    JFK
# 4: 2014     1   1      722        -8     1014       -26         0      AA  N3EHAA     29    LGA
# 5: 2014     1   1     1347         2     1706         1         0      AA  N319AA    117    JFK
# 6: 2014     1   1     1824         4     2145         0         0      AA  N3DEAA    119    EWR
#    dest air_time distance hour min    speed
# 1:  LAX      359     2475    9  14 413.6490
# 2:  LAX      363     2475   11  57 409.0909
# 3:  LAX      351     2475   19   2 423.0769
# 4:  PBI      157     1035    7  22 395.5414
# 5:  LAX      350     2475   13  47 424.2857
# 6:  LAX      339     2454   18  24 434.3363

## or using the functional form
# flights[, `:=`(delay = NULL)]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* å°†ä¸€åˆ—èµ‹å€¼ä¸º NULLï¼Œå°±ä¼šåˆ é™¤é‚£ä¸€åˆ—ã€‚åˆ é™¤ç«‹å³ç”Ÿæ•ˆã€‚
* ä½¿ç”¨å·¦å³ç­‰å¼çš„å½¢å¼çš„æ—¶å€™ï¼Œé™¤äº†æŒ‡å®šåˆ—åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šåˆ—å·ã€‚ä½†è¿˜æ˜¯å¿˜è®°å§ï¼ŒæŒ‡å®šåˆ—åæ˜¯ä¸ªå¥½çš„ç¼–ç ä¹ æƒ¯ã€‚
* ä¸ºäº†æ–¹ä¾¿ï¼Œå¦‚æœåªéœ€è¦åˆ é™¤ä¸€åˆ—ï¼Œå¯ä»¥å»æ‰ c(&amp;quot;&amp;quot;)ï¼ŒåªæŒ‡å®šåˆ—åï¼Œåƒè¿™æ ·ï¼š
flights[, delay := NULL]
è¿™å’Œä¸Šé¢çš„æ–¹æ³•æ˜¯ç­‰æ•ˆçš„ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;d-å’Œåˆ†ç»„:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;d) â€œ:=â€å’Œåˆ†ç»„&lt;/h4&gt;

&lt;p&gt;æˆ‘ä»¬å·²ç»åœ¨b)é‡Œé¢å­¦ä¹ äº†å¦‚ä½•è·Ÿå‚æ•°i ä¸€èµ·ä½¿ç”¨ï¼Œç°åœ¨æˆ‘ä»¬æ¥å­¦ä¹ å¦‚ä½•è·Ÿå‚æ•°by ä¸€èµ·ä½¿ç”¨ã€‚
ï¼å¦‚ä½•è¿½åŠ ä¸€åˆ—ï¼Œç”¨æ¥ä¿å­˜æŸå¯¹èµ·é£ï¼åˆ°è¾¾æœºåœºé—´çš„æœ€å¿«é£è¡Œé€Ÿåº¦&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[, max_speed := max(speed), by=.(origin, dest)]
head(flights)
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1    JFK
# 2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3    JFK
# 3: 2014     1   1     1902         2     2224         9         0      AA  N327AA     21    JFK
# 4: 2014     1   1      722        -8     1014       -26         0      AA  N3EHAA     29    LGA
# 5: 2014     1   1     1347         2     1706         1         0      AA  N319AA    117    JFK
# 6: 2014     1   1     1824         4     2145         0         0      AA  N3DEAA    119    EWR
#    dest air_time distance hour min    speed max_speed
# 1:  LAX      359     2475    9  14 413.6490  526.5957
# 2:  LAX      363     2475   11  57 409.0909  526.5957
# 3:  LAX      351     2475   19   2 423.0769  526.5957
# 4:  PBI      157     1035    7  22 395.5414  517.5000
# 5:  LAX      350     2475   13  47 424.2857  526.5957
# 6:  LAX      339     2454   18  24 434.3363  518.4507
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬ç”¨æ“ä½œç¬¦â€œ:=â€è¿½åŠ äº†ä¸€åˆ— max_speedã€‚
* å’Œä¸Šä¸€è®²å­¦ä¹ åˆ°çš„å†…å®¹ä¸€æ ·ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰æ•°æ®è¿›è¡Œåˆ†ç»„ã€‚å¯¹äºæ¯ç»„æ•°æ®ï¼Œè®¡ç®—æœ€å¿«é€Ÿåº¦ã€‚å¯¹äºä¸€å¯¹æœºåœºï¼Œè¿™ä¸ªæœ€å¿«é€Ÿåº¦æ˜¯å”¯ä¸€çš„ã€‚å¾ªç¯å¤åˆ¶è¿™ä¸ªå€¼åˆ°ä¸€ä¸ªlistï¼Œç›´åˆ°è·Ÿè¯¥ç»„æ•°æ®çš„è¡Œæ•°ä¸€æ ·å¤šã€‚èˆªç­ä¿¡æ¯flightsä¼šè¢«å°±åœ°æ›´æ–°ï¼Œä¸ä¼šå› æ‹·è´æµªè´¹å†…å­˜ç©ºé—´ã€‚
* å’Œä¸Šä¸€è®²å­¦ä¹ åˆ°çš„å†…å®¹ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹å‚æ•°byæŒ‡å®šä¸€ä¸ªå­—ç¬¦å‹çš„å‘é‡ï¼Œå½¢å¼æ˜¯è¿™æ ·ï¼š
by = c(&amp;quot;origin&amp;quot;, &amp;quot;dest&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;e-å’Œå¤æ•°åˆ—:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;e) â€œ:=â€å’Œå¤æ•°åˆ—&lt;/h4&gt;

&lt;p&gt;ï¼å¦‚ä½•å†è¿½åŠ ä¸¤åˆ—ï¼Œç”¨äºä¿å­˜æ¯ä¸ªæœˆçš„æœ€å¤§èµ·é£å»¶è¯¯æ—¶é—´dep_delay å’Œåˆ°è¾¾å»¶è¯¯æ—¶é—´arr_delay&lt;br /&gt;
å°æç¤ºï¼šè¦ç”¨åˆ°ä¸Šä¸€è®²å­¦ä¹ åˆ°çš„ .SD&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;in_cols  = c(&amp;quot;dep_delay&amp;quot;, &amp;quot;arr_delay&amp;quot;)
out_cols = c(&amp;quot;max_dep_delay&amp;quot;, &amp;quot;max_arr_delay&amp;quot;)
flights[, c(out_cols) := lapply(.SD, max), by = month, .SDcols = in_cols]
head(flights)
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1    JFK
# 2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3    JFK
# 3: 2014     1   1     1902         2     2224         9         0      AA  N327AA     21    JFK
# 4: 2014     1   1      722        -8     1014       -26         0      AA  N3EHAA     29    LGA
# 5: 2014     1   1     1347         2     1706         1         0      AA  N319AA    117    JFK
# 6: 2014     1   1     1824         4     2145         0         0      AA  N3DEAA    119    EWR
#    dest air_time distance hour min    speed max_speed max_dep_delay max_arr_delay
# 1:  LAX      359     2475    9  14 413.6490  526.5957           973           996
# 2:  LAX      363     2475   11  57 409.0909  526.5957           973           996
# 3:  LAX      351     2475   19   2 423.0769  526.5957           973           996
# 4:  PBI      157     1035    7  22 395.5414  517.5000           973           996
# 5:  LAX      350     2475   13  47 424.2857  526.5957           973           996
# 6:  LAX      339     2454   18  24 434.3363  518.4507           973           996
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* ä¸ºäº†æ›´å¥½çš„å¯è¯»æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å·¦å³ç­‰å¼çš„å½¢å¼ã€‚æˆ‘ä»¬äº‹å…ˆä¿å­˜äº†è¾“å…¥çš„åˆ—ååˆ°å˜é‡in_colsï¼Œä½œä¸º .SDcolsçš„å‚æ•°ã€‚æˆ‘ä»¬è¿˜äº‹å…ˆä¿å­˜äº†è¾“å‡ºçš„åˆ—ååˆ°å˜é‡out_colsï¼Œä½œä¸ºå·¦è¾¹çš„è¡¨è¾¾å¼ã€‚
* æ³¨æ„ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨c)é‡Œé¢è®²è¿‡ï¼Œå¦‚æœåªéœ€è¦è¿½åŠ ä¸€åˆ—ï¼Œé‚£ä¹ˆå¯ä»¥çœç•¥åŒå¼•å·ï¼ŒåªæŒ‡å®šåˆ—åã€‚ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬éœ€è¦æŒ‡å®š c(out_cols) æˆ–è€… (out_cols)ã€‚ 
* å·¦å³ç­‰å¼çš„å½¢å¼ï¼Œå…è®¸æˆ‘ä»¬æ“ä½œå¤æ•°çš„åˆ—ã€‚åœ¨å³è¾¹çš„è¡¨è¾¾å¼é‡Œï¼Œä¸ºäº†å¯¹æŒ‡å®šåœ¨ .SDcols é‡Œçš„åˆ—è®¡ç®—æœ€å¤§å€¼ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†Rçš„åŸºç¡€å‡½æ•° lapply()ã€‚è¿™äº›æˆ‘ä»¬åœ¨ä¸Šä¸€è®²ä¸­éƒ½å­¦ä¹ è¿‡äº†ã€‚å®ƒè¿”å›æœ‰ä¸¤ä¸ªå…ƒç´ çš„listï¼ŒåŒ…å«æ¯ç»„çš„ dep_delay å’Œ arr_delay è¿™ä¸¤åˆ—çš„æœ€å¤§å€¼ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨è¿›è¡Œä¸‹ä¸€èŠ‚çš„å­¦ä¹ ä¹‹å‰ï¼Œè®©æˆ‘ä»¬åˆ é™¤åˆšåˆšè¿½åŠ çš„å‡ åˆ—ï¼šspeed, max_speed, max_dep_delay å’Œ max_arr_delayã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# RHS gets automatically recycled to length of LHS
flights[, c(&amp;quot;speed&amp;quot;, &amp;quot;max_speed&amp;quot;, &amp;quot;max_dep_delay&amp;quot;, &amp;quot;max_arr_delay&amp;quot;) := NULL]
head(flights)
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1    JFK
# 2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3    JFK
# 3: 2014     1   1     1902         2     2224         9         0      AA  N327AA     21    JFK
# 4: 2014     1   1      722        -8     1014       -26         0      AA  N3EHAA     29    LGA
# 5: 2014     1   1     1347         2     1706         1         0      AA  N319AA    117    JFK
# 6: 2014     1   1     1824         4     2145         0         0      AA  N3DEAA    119    EWR
#    dest air_time distance hour min
# 1:  LAX      359     2475    9  14
# 2:  LAX      363     2475   11  57
# 3:  LAX      351     2475   19   2
# 4:  PBI      157     1035    7  22
# 5:  LAX      350     2475   13  47
# 6:  LAX      339     2454   18  24
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;3-å’Œcopy:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;3. â€œ:=â€å’Œcopy()&lt;/h2&gt;

&lt;p&gt;æ“ä½œç¬¦â€œ:=â€ä¼šæ›´æ–°åŸæ•°æ®ã€‚å’Œæˆ‘ä»¬ä¹‹å‰å­¦è¿‡çš„åŠŸèƒ½ä¸åŒï¼Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›æ›´æ–°åŸæ•°æ®ã€‚ä½†æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¸æƒ³æ›´æ–°åŸæ•°æ®ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å‡½æ•° copy()ã€‚&lt;/p&gt;

&lt;h4 id=&#34;a-çš„å‰¯ä½œç”¨:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;a) â€œ:=â€çš„å‰¯ä½œç”¨&lt;/h4&gt;

&lt;p&gt;å¦‚æœæˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè¿”å›æ¯ä¸ªæœˆçš„æœ€å¿«é€Ÿåº¦ã€‚ä½†æ˜¯æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿæƒ³å¯¹ flights è¿½åŠ ä¸€åˆ— speedã€‚å¯ä»¥åƒä¸‹é¢è¿™æ ·åšï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;foo &amp;lt;- function(DT) {
  DT[, speed := distance / (air_time/60)]
  DT[, .(max_speed = max(speed)), by=month]
}
ans = foo(flights)
head(flights)
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1    JFK
# 2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3    JFK
# 3: 2014     1   1     1902         2     2224         9         0      AA  N327AA     21    JFK
# 4: 2014     1   1      722        -8     1014       -26         0      AA  N3EHAA     29    LGA
# 5: 2014     1   1     1347         2     1706         1         0      AA  N319AA    117    JFK
# 6: 2014     1   1     1824         4     2145         0         0      AA  N3DEAA    119    EWR
#    dest air_time distance hour min    speed
# 1:  LAX      359     2475    9  14 413.6490
# 2:  LAX      363     2475   11  57 409.0909
# 3:  LAX      351     2475   19   2 423.0769
# 4:  PBI      157     1035    7  22 395.5414
# 5:  LAX      350     2475   13  47 424.2857
# 6:  LAX      339     2454   18  24 434.3363
head(ans)
#    month max_speed
# 1:     1  535.6425
# 2:     2  535.6425
# 3:     3  549.0756
# 4:     4  585.6000
# 5:     5  544.2857
# 6:     6  608.5714
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æ³¨æ„ä¸€ä¸ªæ–°çš„åˆ— speed è¢«è¿½åŠ åˆ° flight é‡Œäº†ã€‚è¿™æ—¶å› ä¸ºæˆ‘ä»¬ç”¨äº†æ“ä½œç¬¦â€œ:=â€ã€‚æ—¢ç„¶ DT å’Œflightséƒ½æŒ‡å‘å†…å­˜ä¸­åŒä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹ DT çš„æ“ä½œï¼Œä¹Ÿä¼šå¯¹ flights ç”Ÿæ•ˆã€‚
* è¿”å›å€¼ ans åŒ…å«äº†æ¯æœˆçš„æœ€å¿«é€Ÿåº¦ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;b-å‡½æ•°copy:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;b) å‡½æ•°copy()&lt;/h4&gt;

&lt;p&gt;åœ¨å‰é¢ä¸€èŠ‚ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†æ“ä½œç¬¦â€œ:=â€çš„å‰¯ä½œç”¨æ¥æ›´æ–°åŸæ•°æ®ã€‚ä½†æ˜¯ä¸ä¼šä¸€ç›´å¸Œæœ›è¿™æ ·åˆæ˜¯ï¼Œæˆ‘ä»¬å¸Œæœ›ç»™å‡½æ•°ä¼ é€’data.tableå‚æ•°ï¼Œä½¿ç”¨æ“ä½œç¬¦â€œ:=â€çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä¸æƒ³æ”¹å˜åŸæ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å‡½æ•° copy() æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;å‡½æ•° copy() å¯¹è¾“å…¥å‚æ•°è¿›è¡Œæ·±åº¦æ‹·è´ï¼Œå› æ­¤å¯¹å‰¯æœ¬åšçš„æ‰€æœ‰æ›´æ–°æ“ä½œï¼Œéƒ½ä¸ä¼šå¯¹åŸæ•°æ®ç”Ÿæ•ˆã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å‡½æ•° copy() æœ‰ä¸¤ä¸ªä¸å¯æˆ–ç¼ºçš„ç‰¹ç‚¹ï¼š&lt;br /&gt;
1.å’Œå‰ä¸€èŠ‚å†…å®¹çš„æƒ…å½¢ç›¸åï¼Œæˆ‘ä»¬å¯èƒ½ä¸å¸Œæœ›ä¼ é€’çš„å‚æ•°è¢«ä¿®æ”¹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè€ƒè™‘å‰ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¸æƒ³ä¿®æ”¹ flightsçš„å†…å®¹ã€‚&lt;br /&gt;
æˆ‘ä»¬å…ˆåˆ æ‰å‰ä¸€èŠ‚ä¸­ï¼Œè¿½åŠ çš„ speedåˆ—ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[, speed := NULL]   
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·åšï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;foo &amp;lt;- function(DT) {
  DT &amp;lt;- copy(DT)                             ## deep copy
  DT[, speed := distance / (air_time/60)]    ## doesn&#39;t affect &#39;flights&#39;
  DT[, .(max_speed = max(speed)), by=month]
}
ans &amp;lt;- foo(flights)
head(flights)
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1    JFK
# 2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3    JFK
# 3: 2014     1   1     1902         2     2224         9         0      AA  N327AA     21    JFK
# 4: 2014     1   1      722        -8     1014       -26         0      AA  N3EHAA     29    LGA
# 5: 2014     1   1     1347         2     1706         1         0      AA  N319AA    117    JFK
# 6: 2014     1   1     1824         4     2145         0         0      AA  N3DEAA    119    EWR
#    dest air_time distance hour min
# 1:  LAX      359     2475    9  14
# 2:  LAX      363     2475   11  57
# 3:  LAX      351     2475   19   2
# 4:  PBI      157     1035    7  22
# 5:  LAX      350     2475   13  47
# 6:  LAX      339     2454   18  24
head(ans)
#    month max_speed
# 1:     1  535.6425
# 2:     2  535.6425
# 3:     3  549.0756
# 4:     4  585.6000
# 5:     5  544.2857
# 6:     6  608.5714
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* ä½¿ç”¨å‡½æ•° copy() ä¸ä¼šæ›´æ–° flightsã€‚å®ƒç°åœ¨ä¸åŒ…å« speedåˆ—ã€‚
* è¿”å›å€¼ ans åŒ…å«äº†æ¯æœˆçš„æœ€å¿«é€Ÿåº¦ã€‚
ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å½±å­æ‹·è´æ¥ä»£æ›¿æ·±åº¦æ‹·è´ï¼Œæ¥å¤§å¹…åº¦æé«˜è¿™ä¸ªæ“ä½œçš„æ•ˆç‡ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ Data.Tableçš„V1.9.8çš„ç‰ˆæœ¬é‡Œæä¾›è¿™ä¸ªåŠŸèƒ½ã€‚æˆ‘ä»¬ä¼šåœ¨data.tableçš„è®¾è®¡é‡Œé¢ç»§ç»­è®¨è®ºè¿™ä¸ªå†…å®¹ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Data.Table V1.9.8 ç›¸å…³èµ„æ–™ï¼š&lt;br /&gt;
&lt;a href=&#34;https://github.com/Rdatatable/data.table/issues/617&#34;&gt;Copy-on-:= at column level, DT[,list(&amp;hellip;)] shallow copy and add cols to shallow(DT, cols)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2.å½“æˆ‘ä»¬å°†åˆ—åä¿å­˜åœ¨å˜é‡é‡Œçš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼šDT_n = names(DT)ï¼Œç„¶åå†å¯¹ DT æ·»åŠ ï¼æ›´æ–°ï¼åˆ é™¤åˆ—ï¼Œæ“ä½œç¬¦â€œ:=â€ä¹Ÿä¼šæ›´æ–°å˜é‡ DT_nï¼Œé™¤éæˆ‘ä»¬è¿è¡Œ copy(names(DT))ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT = data.table(x=1, y=2)
DT_n = names(DT)
DT_n
# [1] &amp;quot;x&amp;quot; &amp;quot;y&amp;quot;

## add a new column by reference
DT[, z := 3]

## DT_n also gets updated
DT_n
# [1] &amp;quot;x&amp;quot; &amp;quot;y&amp;quot; &amp;quot;z&amp;quot;

## use `copy()`
DT_n = copy(names(DT))
DT[, w := 4]

## DT_n doesn&#39;t get updated
DT_n
# [1] &amp;quot;x&amp;quot; &amp;quot;y&amp;quot; &amp;quot;z&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;æ€»ç»“:e5b9ad2772afb60de67bb09a99ffa4e1&#34;&gt;æ€»ç»“&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;æ“ä½œç¬¦â€œ:=â€
* æ“ä½œç¬¦â€œ:=â€ç”¨äºæ·»åŠ ï¼æ›´æ–°ï¼åˆ é™¤åˆ—ã€‚
* æˆ‘ä»¬ä¹Ÿå­¦ä¹ äº†å¦‚ä½•è·Ÿå‚æ•°iå’Œå‚æ•°byä¸€èµ·ä½¿ç”¨ï¼Œå°±åƒåœ¨ç¬¬ä¸€è®²ä¸­å­¦ä¹ çš„é‚£æ ·ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ keybyï¼Œå¯ä»¥ç”¨æ–¹æ‹¬å· [] å°†æ“ä½œè¿ç»“èµ·æ¥ï¼Œå¯ä»¥ç»™å‚æ•°by æŒ‡å®šè¡¨è¾¾å¼ã€‚
* æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ“ä½œç¬¦â€œ:=â€æ›´æ–°åŸæ•°æ®ï¼Œä¹Ÿå¯ä»¥ç”¨å‡½æ•° copy() æ¥é¿å…æ›´æ–°åŸæ•°æ®ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¥½å¤šå‚æ•°jç›¸å…³çš„çŸ¥è¯†ï¼ŒçŸ¥é“äº†å‚æ•°iã€å‚æ•°jå’Œå‚æ•°byå¦‚ä½•ä¸€èµ·ä½¿ç”¨ã€‚ä¸‹ä¸€è®²&lt;a href=&#34;http://youngspring1.github.io/post/2016-03-22-datatable3/&#34;&gt;ä¸»é”®ã€åŸºäºäºŒåˆ†æ³•æœç´¢çš„subset&lt;/a&gt;ï¼Œæˆ‘ä»¬å°†æ³¨æ„åŠ›å›åˆ°å‚æ•°iä¸Šï¼Œæ¥åšä¸€äº›é€šè¿‡ä¸»é”®çš„è¶…å¿«é€Ÿçš„æ’åºã€‚&lt;/p&gt;
&lt;div class=&#34;footnotes&#34;&gt;

&lt;hr /&gt;

&lt;ol&gt;
&lt;li id=&#34;fn:e5b9ad2772afb60de67bb09a99ffa4e1:1&#34;&gt;&lt;a href=&#34;http://r.789695.n4.nabble.com/speeding-up-perception-td3640920.html#a3646694&#34;&gt;Speeding up perception&lt;/a&gt;
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:e5b9ad2772afb60de67bb09a99ffa4e1:1&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:e5b9ad2772afb60de67bb09a99ffa4e1:2&#34;&gt;&lt;a href=&#34;http://stackoverflow.com/questions/23898969/is-data-really-copied-four-times-in-rs-replacement-functions&#34;&gt;Is data really copied four times in R&amp;rsquo;s replacement functions?&lt;/a&gt;
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:e5b9ad2772afb60de67bb09a99ffa4e1:2&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:e5b9ad2772afb60de67bb09a99ffa4e1:3&#34;&gt;&lt;a href=&#34;http://stackoverflow.com/questions/7033106/why-has-data-table-defined-rather-than-overloading&#34;&gt;Why has data.table defined := rather than overloading &amp;lt;-?&lt;/a&gt;
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:e5b9ad2772afb60de67bb09a99ffa4e1:3&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>data.table æ•™ç¨‹1ï¼ˆæ ¡å¯¹ä¸­ï¼‰</title>
      <link>http://youngspring1.github.io/post/2016/2016-03-13-datatable1/</link>
      <pubDate>Sun, 13 Mar 2016 18:57:40 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-03-13-datatable1/</guid>
      <description>

&lt;p&gt;æœ€è¿‘ä½¿ç”¨data.tableè¿™ä¸ªå¢å¼ºåŒ…ï¼Œæ¥è®¡ç®—æ•°æ®çš„èšåˆä¿¡æ¯ï¼Œæ¯”sqlè¯­å¥ç®€å•æ˜äº†ä¸æ˜¯ä¸€ç‚¹åŠç‚¹ï¼Œäºæ˜¯æƒ³æŠŠdata.tableçš„èµ„æ–™ç¿»è¯‘å‡ºæ¥ã€‚&lt;/p&gt;

&lt;p&gt;ç›®å½•ï¼š&lt;br /&gt;
1) data.table ä»‹ç»&lt;br /&gt;
2) &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-21-datatable2/&#34;&gt;è¯­ä¹‰å¼•ç”¨&lt;/a&gt;&lt;br /&gt;
3) &lt;a href=&#34;http://youngspring1.github.io/post/2016-03-22-datatable3/&#34;&gt;ä¸»é”®ã€åŸºäºäºŒåˆ†æ³•æœç´¢çš„subset&lt;/a&gt;&lt;br /&gt;
4) [äºŒæ¬¡ç´¢å¼•å’Œè‡ªåŠ¨ç´¢å¼•]()&lt;br /&gt;
5) Efficient reshaping using data.tables&lt;/p&gt;

&lt;p&gt;åŸæ–‡åœ°å€ï¼š&lt;br /&gt;
1) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-intro-vignette.html&#34;&gt;Introduction to data.table&lt;/a&gt;&lt;br /&gt;
2) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-reference-semantics.html&#34;&gt;Reference semantics&lt;/a&gt;&lt;br /&gt;
3) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-keys-fast-subset.html&#34;&gt;Keys and fast binary search based subsets&lt;/a&gt;&lt;br /&gt;
4) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-secondary-indices-and-auto-indexing.html&#34;&gt;Secondary indices and auto indexing&lt;/a&gt;&lt;br /&gt;
5) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-reshape.html&#34;&gt;Efficient reshaping using data.tables&lt;/a&gt;&lt;br /&gt;
6) &lt;a href=&#34;https://rawgit.com/wiki/Rdatatable/data.table/vignettes/datatable-faq.html&#34;&gt;Frequently asked questions&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;æœ¬æ•™ç¨‹ä»‹ç»data.tableçš„è¯­æ³•ï¼Œå¤§æ¦‚çš„å½¢å¼ï¼Œå¦‚ä½•subsetè¡Œï¼Œå¦‚ä½•æŒ‰åˆ—selectï¼computeï¼Œå¦‚ä½•åˆ†ç»„èšåˆã€‚ç†Ÿæ‚‰data.frameçš„æ•°æ®ç»“æ„æ˜¯æœ‰å¸®åŠ©çš„ï¼Œä¸è¿‡ä¸ç†Ÿæ‚‰ä¹Ÿæ²¡å…³ç³»ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;ä½¿ç”¨data-tableåˆ†ææ•°æ®:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;ä½¿ç”¨data.tableåˆ†ææ•°æ®&lt;/h2&gt;

&lt;p&gt;æ”¯æŒæ“ä½œæ•°æ®çš„åŠŸèƒ½ï¼Œä¾‹å¦‚subsetã€groupã€updateã€joinç­‰ã€‚&lt;br /&gt;
è¿™äº›åŠŸèƒ½å¯ä»¥è®©æˆ‘ä»¬ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* é€šè¿‡ç®€æ´ä¸€è‡´çš„è¯­æ³•ï¼Œå®è¡Œæƒ³è¦çš„æ“ä½œï¼Œè¾¾åˆ°ç›®çš„ã€‚
* ä»ä¸€ç³»åˆ—å‡½æ•°åˆ°æœ€ç»ˆçš„åˆ†æï¼Œéƒ½æ²¡æœ‰å°†æ‰€æœ‰çš„æ“ä½œéƒ½å¯¹åº”åˆ°å‡½æ•°çš„è´Ÿæ‹…ã€‚èƒ½å¤Ÿæµç•…åœ°æ‰§è¡Œåˆ†æã€‚
* ç²¾ç¡®åœ°çŸ¥é“æ¯æ­¥æ“ä½œæ‰€éœ€è¦çš„æ•°æ®ï¼Œå†…éƒ¨è‡ªåŠ¨ä¼˜åŒ–æ“ä½œï¼Œåœ¨è¿è¡Œé€Ÿåº¦å’Œå†…å­˜å¼€é”€ä¸¤æ–¹é¢éƒ½å¾ˆæœ‰æ•ˆæœã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç®€è¦çš„è®²ï¼Œå¦‚æœä½ å¯¹å‡å°è®¡ç®—å¤æ‚åº¦å’Œè®¡ç®—æ—¶é—´æœ‰ç€è¿«åˆ‡çš„éœ€æ±‚ï¼Œé‚£ä¹ˆè¿™ä¸ªpackageå°±æ˜¯ä¸ºä½ é‡èº«æ‰“é€ çš„ã€‚data.tableå°±æ˜¯å¹²è¿™äº‹å„¿çš„ã€‚æˆ‘ä»¬é€šè¿‡è¿™ä¸€ç³»åˆ—æ•™ç¨‹ï¼Œè¯´æ˜è¿™äº›åŠŸèƒ½ã€‚&lt;/p&gt;

&lt;h2 id=&#34;æ•°æ®:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;æ•°æ®&lt;/h2&gt;

&lt;p&gt;åœ¨è¿™ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨&lt;a href=&#34;https://github.com/arunsrinivasan/flights/wiki/NYC-Flights-2014-data&#34;&gt;NYC-flights14&lt;/a&gt;çš„æ•°æ®ã€‚å®ƒåŒ…å«äº†2014å¹´çº½çº¦æœºåœºå‘å‡ºçš„æ‰€æœ‰èˆªç­ä¿¡æ¯ã€‚è¿™ä»½æ•°æ®åªæœ‰2014å¹´1æœˆåˆ°10æœˆæ˜¯å…¬å¼€çš„ã€‚&lt;br /&gt;
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨data.tableçš„fread()å‡½æ•°ï¼Œç”¨ä¸‹é¢çš„æ–¹å¼ï¼Œå¿«é€Ÿç›´æ¥è¯»å–èˆªç­æ•°æ®ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights &amp;lt;- fread(&amp;quot;https://raw.githubusercontent.com/wiki/arunsrinivasan/    flights/NYCflights14/flights14.csv&amp;quot;)
flights
#         year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight
#      1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1
#      2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3
#      3: 2014     1   1     1902         2     2224         9         0      AA  N327AA     21
#      4: 2014     1   1      722        -8     1014       -26         0      AA  N3EHAA     29
#      5: 2014     1   1     1347         2     1706         1         0      AA  N319AA    117
#     ---                                                                                      
# 253312: 2014    10  31     1459         1     1747       -30         0      UA  N23708   1744
# 253313: 2014    10  31      854        -5     1147       -14         0      UA  N33132   1758
# 253314: 2014    10  31     1102        -8     1311        16         0      MQ  N827MQ   3591
# 253315: 2014    10  31     1106        -4     1325        15         0      MQ  N511MQ   3592
# 253316: 2014    10  31      824        -5     1045         1         0      MQ  N813MQ   3599
#         origin dest air_time distance hour min
#      1:    JFK  LAX      359     2475    9  14
#      2:    JFK  LAX      363     2475   11  57
#      3:    JFK  LAX      351     2475   19   2
#      4:    LGA  PBI      157     1035    7  22
#      5:    JFK  LAX      350     2475   13  47
#     ---                                       
# 253312:    LGA  IAH      201     1416   14  59
# 253313:    EWR  IAH      189     1400    8  54
# 253314:    LGA  RDU       83      431   11   2
# 253315:    LGA  DTW       75      502   11   6
# 253316:    LGA  SDF      110      659    8  24
dim(flights)
# [1] 253316     17
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ—¢ç„¶æ•´ä¸ªæ•™ç¨‹æˆ‘ä»¬éƒ½ä¼šä½¿ç”¨è¿™ä»½æ•°æ®ï¼Œé‚£ä½ ä¸å¦¨å…ˆä¸‹è½½åˆ°ä½ çš„ç”µè„‘ä¸Šï¼Œç„¶åæ¯æ¬¡ä½¿ç”¨çš„æ—¶å€™å†è¯»å–ã€‚&lt;/p&gt;

&lt;h2 id=&#34;ä»‹ç»:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;ä»‹ç»&lt;/h2&gt;

&lt;p&gt;åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ ä¸‹é¢ä¸¤ç‚¹ï¼š&lt;br /&gt;
1. åŸºç¡€ ï¼ ä»€ä¹ˆæ˜¯data.tableï¼Œå®ƒçš„å½¢å¼ï¼Œå¦‚ä½•subsetè¡Œï¼Œå¦‚ä½•selectåˆ—ï¼Œå¦‚ä½•æŒ‰åˆ—è¿›è¡Œè¿ç®—ã€‚&lt;br /&gt;
2. èšåˆ ï¼ æŒ‰ç»„èšåˆçš„æ•ˆæœã€‚&lt;/p&gt;

&lt;h2 id=&#34;1-åŸºç¡€:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;1.åŸºç¡€&lt;/h2&gt;

&lt;h4 id=&#34;a-ä»€ä¹ˆæ˜¯data-table:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;a) ä»€ä¹ˆæ˜¯data.table&lt;/h4&gt;

&lt;p&gt;data.tableæ˜¯Rè¯­è¨€çš„ä¸€ä¸ªåŒ…ï¼Œå®ƒæ˜¯å¯¹data.framesçš„å¢å¼ºã€‚åœ¨ä¸Šæ–‡ï¼ˆè¯»å–èˆªç­ï¼‰â€œæ•°æ®â€çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬é€šè¿‡å‡½æ•°fread()åˆ›å»ºäº†ä¸€ä¸ªdata.tableã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å‡½æ•°data.table()åˆ›å»ºä¸€ä¸ªdata.tableï¼Œæ¯”å¦‚è¿™æ ·ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT = data.table(ID = c(&amp;quot;b&amp;quot;,&amp;quot;b&amp;quot;,&amp;quot;b&amp;quot;,&amp;quot;a&amp;quot;,&amp;quot;a&amp;quot;,&amp;quot;c&amp;quot;), a = 1:6, b = 7:12, c=13:18)
DT
#    ID a  b  c
# 1:  b 1  7 13
# 2:  b 2  8 14
# 3:  b 3  9 15
# 4:  a 4 10 16
# 5:  a 5 11 17
# 6:  c 6 12 18
class(DT$ID)
# [1] &amp;quot;character&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡as.data.table()å°†å·²ç»å­˜åœ¨çš„å¯¹è±¡è½¬åŒ–æˆdata.tableã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;æ³¨æ„ï¼š
* ä¸åŒäºdata.framesï¼Œå­—ç¬¦å‹çš„åˆ—ï¼Œä¸ä¼šè¢«è‡ªåŠ¨è½¬åŒ–æˆå› å­ã€‚
* è¡Œå·åé¢æœ‰ä¸ªå†’å·ï¼Œç”¨äºéš”å¼€ç¬¬ä¸€åˆ—çš„å†…å®¹ã€‚
* å¦‚æœæ•°æ®çš„æ¡ç›®è¶…è¿‡äº†å…¨å±€é€‰é¡¹datatable.print.nrowsæ‰€å®šä¹‰çš„æ•°å€¼ï¼ˆé»˜è®¤æ˜¯100æ¡ï¼‰ï¼Œé‚£ä¹ˆåªä¼šè¾“å‡ºæ•°æ®æœ€å¼€å¤´å’Œæœ€æœ«å°¾çš„5è¡Œã€‚å°±å¦‚åŒä¸Šæ–‡ï¼ˆè¯»å–èˆªç­ï¼‰â€œæ•°æ®â€çš„éƒ¨åˆ†ã€‚

getOption(&amp;quot;datatable.print.nrows&amp;quot;)
# [1] 100

* data.tableä¸èƒ½è®¾ç½®è¡Œçš„åç§°ã€‚æˆ‘ä»¬ä¼šåœ¨ç¬¬ä¸‰è®²ä¸­è¯´æ˜åŸå› ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;b-å½¢å¼-data-tableå¢å¼ºäº†ä»€ä¹ˆ:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;b) å½¢å¼ï¼data.tableå¢å¼ºäº†ä»€ä¹ˆ&lt;/h4&gt;

&lt;p&gt;å’Œdata.frameç›¸åï¼Œæˆ‘ä»¬èƒ½åšçš„å¯ä¸ä»…ä»…å±€é™äºsubsetè¡Œæˆ–è€…selectåˆ—ã€‚é¦–å…ˆä»‹ç»ä¸‹data.tableçš„è¯­æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT[i, j, by]

##   R:      i                 j        by
## SQL:  where   select | update  group by
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚æœä½ æœ‰SQLè¯­å¥çš„åŸºç¡€ï¼Œé‚£ä¹ˆä½ åº”è¯¥èƒ½é©¬ä¸Šæ˜ç™½data.tableçš„è¯­æ³•ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;è¯­æ³•æ˜¯ï¼š
å¯¹äºDTè¿™ä¸ªdata.tableï¼Œä½¿ç”¨ i æ¥subsetè¡Œï¼Œç„¶åè®¡ç®— j ï¼Œæœ€åç”¨ by åˆ†ç»„ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;c-subsetè¡Œ:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;c) subsetè¡Œ&lt;/h4&gt;

&lt;p&gt;ï¼ è·å–å…­æœˆä»½æ‰€æœ‰ä»&amp;rdquo;JFK&amp;rdquo;æœºåœºèµ·é£çš„èˆªç­&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[origin == &amp;quot;JFK&amp;quot; &amp;amp; month == 6L]
head(ans)
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     6   1      851        -9     1205        -5         0      AA  N787AA      1    JFK
# 2: 2014     6   1     1220       -10     1522       -13         0      AA  N795AA      3    JFK
# 3: 2014     6   1      718        18     1014        -1         0      AA  N784AA      9    JFK
# 4: 2014     6   1     1024        -6     1314       -16         0      AA  N791AA     19    JFK
# 5: 2014     6   1     1841        -4     2125       -45         0      AA  N790AA     21    JFK
# 6: 2014     6   1     1454        -6     1757       -23         0      AA  N785AA    117    JFK
#    dest air_time distance hour min
# 1:  LAX      324     2475    8  51
# 2:  LAX      329     2475   12  20
# 3:  LAX      326     2475    7  18
# 4:  LAX      320     2475   10  24
# 5:  LAX      326     2475   18  41
# 6:  LAX      329     2475   14  54
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* é€šè¿‡data.frameçš„frameï¼Ÿï¼Œåˆ—å¯ä»¥åƒå˜é‡ä¸€æ ·è¢«å¼•ç”¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸éœ€è¦åŠ ä¸Š flights$ å‰ç¼€ï¼Œæ¯”å¦‚ flights$dest å’Œ flights$monthï¼Œè€Œæ˜¯ç›´æ¥ç®€å•åœ°å¼•ç”¨ dest å’Œ monthè¿™ä¸¤åˆ—ã€‚
* æ»¡è¶³ origin == &amp;quot;JFK&amp;quot; &amp;amp; month == 6L è¿™ä¸¤ä¸ªæ¡ä»¶çš„è¡Œä¼šè¢«æŠ½å‡ºå‡ºæ¥ã€‚æ—¢ç„¶æˆ‘ä»¬æ²¡æœ‰æŒ‡å®šå…¶ä»–çš„æ¡ä»¶ï¼Œä¸€ä¸ªåŒ…å«åŸæ•°æ®é‡Œé¢æ‰€æœ‰åˆ—çš„data.tableä¼šè¢«è¿”å›ã€‚
* è¯­æ³•é‡Œé¢[i,j,k]çš„é€—å·ä¸æ˜¯å¿…é¡»çš„ï¼Œå½“ç„¶å¦‚æœæŒ‡å®šäº†é€—å·ï¼Œæ¯”å¦‚ flights[dest == &amp;quot;JFK&amp;quot; &amp;amp; month == 6L, ] ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ã€‚ä½†åœ¨data.frameé‡Œé¢ï¼Œé€—å·å´æ˜¯å¿…é¡»çš„ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼ è·å– flights å¼€å¤´çš„ä¸¤è¡Œ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[1:2]
ans
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     1   1      914        14     1238        13         0      AA  N338AA      1    JFK
# 2: 2014     1   1     1157        -3     1523        13         0      AA  N335AA      3    JFK
#    dest air_time distance hour min
# 1:  LAX      359     2475    9  14
# 2:  LAX      363     2475   11  57
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬æ²¡æœ‰æŒ‡å®šä»»ä½•æ¡ä»¶ã€‚è¡Œçš„ç´¢å¼•å·²ç»è‡ªåŠ¨æä¾›ç»™å‚æ•° i äº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªåŒ…å«åŸæ•°æ® flight é‡Œæ‰€æœ‰åˆ—çš„data.tableï¼ˆfor è¿™äº›è¡Œçš„ç´¢å¼•ï¼Ÿï¼‰ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼ æ’åºï¼ˆå…ˆæŒ‰ originåˆ— çš„å‡åºï¼Œå†æŒ‰ dest çš„é™åºæ’åˆ—ï¼‰
æˆ‘ä»¬å¯ä»¥é€šè¿‡Rè¯­è¨€çš„åŸºç¡€å‡½æ•° order() æ¥å®Œæˆè¿™ä¸ªåŠŸèƒ½ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[order(origin, -dest)]
head(ans)
#    year month day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1: 2014     1   5      836         6     1151        49         0      EV  N12175   4419    EWR
# 2: 2014     1   6      833         7     1111        13         0      EV  N24128   4419    EWR
# 3: 2014     1   7      811        -6     1035       -13         0      EV  N12142   4419    EWR
# 4: 2014     1   8      810        -7     1036       -12         0      EV  N11193   4419    EWR
# 5: 2014     1   9      833        16     1055         7         0      EV  N14198   4419    EWR
# 6: 2014     1  13      923        66     1154        66         0      EV  N12157   4419    EWR
#    dest air_time distance hour min
# 1:  XNA      195     1131    8  36
# 2:  XNA      190     1131    8  33
# 3:  XNA      179     1131    8  11
# 4:  XNA      184     1131    8  10
# 5:  XNA      181     1131    8  33
# 6:  XNA      188     1131    9  23
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;å†…ç½®çš„ order() å‡½æ•°
* æˆ‘ä»¬å¯ä»¥å¯¹ä¸€ä¸ªå­—ç¬¦å‹çš„åˆ—ï¼Œä½¿ç”¨å‡å·â€œ-â€ï¼Œæ¥å®ç°é™åºæ’åˆ—ã€‚
* å¦å¤–ï¼Œå‡½æ•° order() å…¶å®è°ƒç”¨äº†data.tableçš„å¿«é€ŸåŸºæ•°æ’åºå‡½æ•° forder()ï¼Œå®ƒæ¯” base::order å¿«å¾ˆå¤šã€‚è¿™æ˜¯ä¸€ä¸ªè¯´æ˜å®ƒä»¬åŸºæœ¬åŒºåˆ«çš„ä¾‹å­ï¼š

odt = data.table(col=sample(1e7))
(t1 &amp;lt;- system.time(ans1 &amp;lt;- odt[base::order(col)]))  ## uses order from base R
#    user  system elapsed 
#   8.610   0.056   8.708
(t2 &amp;lt;- system.time(ans2 &amp;lt;- odt[order(col)]))        ## uses data.table&#39;s forder
#    user  system elapsed 
#   0.526   0.024   0.553
(identical(ans1, ans2))
# [1] TRUE

order() æ¯” base::order å¤§çº¦å¿«äº†16å€ã€‚æˆ‘ä»¬ä¼šåœ¨data.tableçš„å†…éƒ¨æ•™ç¨‹ä¸­è®¨è®ºdata.tableå¿«é€Ÿæ’åºçš„æ›´å¤šç»†èŠ‚ã€‚
* å› æ­¤ï¼Œä½¿ç”¨æˆ‘ä»¬ç†Ÿæ‚‰çš„å‡½æ•°ï¼Œå°±å¯ä»¥æ˜¾è‘—åœ°æé«˜åˆ†ææ•ˆç‡ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;d-selectåˆ—:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;d) selectåˆ—&lt;/h4&gt;

&lt;p&gt;ï¼ é€‰å– arr_delay åˆ—ï¼Œè¿”å›å€¼æ˜¯å‘é‡&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[, arr_delay]
head(ans)
# [1]  13  13   9 -26   1   0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æ—¢ç„¶åˆ—å¯ä»¥ä½œä¸ºå˜é‡è¢«å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¼•ç”¨æˆ‘ä»¬æƒ³é€‰å–çš„åˆ—ã€‚
* æ—¢ç„¶æˆ‘ä»¬æƒ³é€‰å–æ‰€æœ‰çš„è¡Œï¼Œæˆ‘ä»¬æ¯‹éœ€æŒ‡å®šå‚æ•° iã€‚
* è¿”å›äº†æ‰€æœ‰è¡Œçš„ arr_delay åˆ—ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼ é€‰å– arr_delay åˆ—ï¼Œè¿”å›å€¼æ˜¯data.table&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[, list(arr_delay)]
head(ans)
#    arr_delay
# 1:        13
# 2:        13
# 3:         9
# 4:       -26
# 5:         1
# 6:         0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬ç”¨ list() æŠŠåˆ—å arr_delay åŒ…å›´èµ·æ¥ï¼Œå®ƒå¯ä»¥ç¡®ä¿è¿”å›å€¼æ˜¯data.tableã€‚æ­£å¦‚å‰é¢ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœä¸è¿™æ ·åšï¼Œè¿”å›å€¼å°±æ˜¯ä¸€ä¸ªå‘é‡ã€‚
* data.tableä¹Ÿå…è®¸ç”¨ .() æ¥åŒ…å›´åˆ—åï¼Œå®ƒæ˜¯ list() çš„åˆ«åï¼Œå®ƒä»¬çš„æ•ˆæœæ˜¯åŒæ ·çš„ã€‚æ•™ç¨‹åé¢ä¼šä½¿ç”¨ .() æ¥è¯´æ˜ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ³¨æ„ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;åªè¦å‚æ•° j è¿”å›ä¸€ä¸ªlistï¼Œè¿™ä¸ªlistçš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½ä¼šè¢«è½¬æ¢æˆç»“æœdata.tableçš„ä¸€åˆ—ã€‚ä½ é©¬ä¸Šå°±ä¼šå‘ç°ï¼Œè¿™ä¸ªåŠŸèƒ½æ˜¯å¤šä¹ˆå¼ºå¤§ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼ é€‰å– arr_delay åˆ—å’Œ dep_delay åˆ—&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[, .(arr_delay, dep_delay)]
head(ans)
#    arr_delay dep_delay
# 1:        13        14
# 2:        13        -3
# 3:         9         2
# 4:       -26        -8
# 5:         1         2
# 6:         0         4

## alternatively
# ans &amp;lt;- flights[, list(arr_delay, dep_delay)]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* ä½¿ç”¨ .() æˆ–è€… list() éƒ½å¯ä»¥ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼ é€‰å– arr_delay åˆ—å’Œ dep_delay åˆ—ï¼Œå¹¶æŠŠåˆ—åæ”¹ä¸º delay_arr å’Œ delay_dep
æ—¢ç„¶ .() æ˜¯ list() çš„åˆ«åï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»º list çš„æ—¶å€™å¯¹åˆ—å‘½åã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[, .(delay_arr = arr_delay, delay_dep = dep_delay)]
head(ans)
#    delay_arr delay_dep
# 1:        13        14
# 2:        13        -3
# 3:         9         2
# 4:       -26        -8
# 5:         1         2
# 6:         0         4
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å°±æ˜¯è¿™æ ·ã€‚&lt;/p&gt;

&lt;h4 id=&#34;e-åœ¨å‚æ•°jé‡Œè¿ç®—:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;e) åœ¨å‚æ•°jé‡Œè¿ç®—&lt;/h4&gt;

&lt;p&gt;ï¼ æœ‰å¤šå°‘èˆªç­å®Œå…¨æ²¡æœ‰å»¶è¯¯&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[, sum((arr_delay + dep_delay) &amp;lt; 0)]
ans
# [1] 141814
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;åˆšåˆšå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ
* å‚æ•° j èƒ½åšçš„ï¼Œå¯ä¸åªæ˜¯é€‰å–åˆ—è¿™ä¹ˆç®€å•ï¼Œå®ƒèƒ½å¤„ç†è¡¨è¾¾å¼ï¼Œæ¯”å¦‚å¯¹åˆ—è¿›è¡Œè®¡ç®—ã€‚è¿™æ²¡ä»€ä¹ˆå¤§æƒŠå°æ€ªçš„ï¼Œå› ä¸ºåˆ—å¯ä»¥ä½œä¸ºå˜é‡è¢«å¼•ç”¨å˜›ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™äº›å˜é‡è°ƒç”¨å‡½æ•°ã€‚æˆ‘ä»¬åˆšåˆšå°±æ˜¯å¯¹ä¸¤åˆ—æ±‚å’Œ(sum)äº†ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;f-åœ¨å‚æ•°ié‡Œé€‰å–-åœ¨å‚æ•°jé‡Œè¿ç®—:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;f) åœ¨å‚æ•°ié‡Œé€‰å–ï¼Œåœ¨å‚æ•°jé‡Œè¿ç®—&lt;/h4&gt;

&lt;p&gt;ï¼ åœ¨å…­æœˆä»½ï¼Œä»&amp;rdquo;JFK&amp;rdquo;æœºåœºèµ·é£çš„èˆªç­ä¸­ï¼Œè®¡ç®—èµ·é£å’Œåˆ°è¾¾çš„å¹³å‡å»¶è¯¯æ—¶é—´&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[origin == &amp;quot;JFK&amp;quot; &amp;amp; month == 6L, 
           .(m_arr=mean(arr_delay), m_dep=mean(dep_delay))]
ans
#       m_arr    m_dep
# 1: 5.839349 9.807884
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬é¦–å…ˆåœ¨iå‚æ•°é‡Œï¼Œæ‰¾åˆ°æ‰€æœ‰ç¬¦åˆ origin (æœºåœº)æ˜¯&amp;quot;JFK&amp;quot;ï¼Œå¹¶ä¸” month (æœˆä»½)æ˜¯ 6 è¿™æ ·æ¡ä»¶çš„è¡Œã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰subsetæ•´ä¸ªdata.tableã€‚
* ç°åœ¨ï¼Œæˆ‘ä»¬çœ‹çœ‹å‚æ•°jï¼Œå®ƒåªä½¿ç”¨äº†ä¸¤åˆ—ã€‚æˆ‘ä»¬éœ€è¦åˆ†åˆ«è®¡ç®—è¿™ä¸¤åˆ—çš„å¹³å‡å€¼ mean()ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬æ‰subseté‚£äº›ç¬¦åˆiå‚æ•°é‡Œæ¡ä»¶çš„åˆ—ï¼Œç„¶åè®¡ç®—å®ƒä»¬çš„å¹³å‡å€¼ã€‚
å› ä¸ºè¿™ä¸‰ä¸ªå‚æ•°ï¼ˆiï¼Œjå’Œbyï¼‰éƒ½è¢«æŒ‡å®šåœ¨åŒä¸€ä¸ªæ–¹æ‹¬å·ä¸­ï¼Œdata.tableèƒ½åŒæ—¶æ¥å—è¿™ä¸‰ä¸ªå‚æ•°ï¼Œå¹¶åœ¨è®¡ç®—ä¹‹å‰ï¼Œé€‰å–æœ€ä¼˜çš„è®¡ç®—æ–¹æ³•ï¼Œè€Œä¸æ˜¯åˆ†æ­¥éª¤è®¡ç®—ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é¿å…å¯¹æ•´ä¸ªdata.tableè®¡ç®—ï¼ŒåŒæ—¶ï¼Œåœ¨è®¡ç®—é€Ÿåº¦å’Œå†…å­˜ä½¿ç”¨é‡è¿™ä¸¤æ–¹é¢ï¼Œå–å¾—æœ€ä¼˜çš„æ•ˆæœã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼ åœ¨å…­æœˆä»½ï¼Œä»&amp;rdquo;JFK&amp;rdquo;æœºåœºèµ·é£çš„èˆªç­ä¸€å…±æœ‰å¤šå°‘&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[origin == &amp;quot;JFK&amp;quot; &amp;amp; month == 6L, length(dest)]
ans
# [1] 8422
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å‡½æ•° length() éœ€è¦ä¸€ä¸ªå‚æ•°ã€‚æˆ‘ä»¬åªéœ€è¦çŸ¥é“ï¼Œç»“æœé‡Œæœ‰å¤šå°‘è¡Œæ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»»ä½•ä¸€åˆ—ä½œä¸ºå‡½æ•° length() çš„å‚æ•°ã€‚&lt;br /&gt;
è¿™ä¸€ç±»çš„æ“ä½œç‰¹åˆ«é¢‘ç¹ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¸‹ä¸€èŠ‚é‡Œï¼Œå½“æˆ‘ä»¬éœ€è¦åˆ†ç»„çš„æ—¶å€™ï¼Œä¼šè®²åˆ°è¿™ä¸ªç‰¹åˆ«çš„ç¬¦å· .Nã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ç‰¹åˆ«çš„ç¬¦å· .N 
.N æ˜¯ä¸€ä¸ªå†…å»ºçš„å˜é‡ï¼Œå®ƒè¡¨ç¤ºå½“å‰çš„åˆ†ç»„ä¸­ï¼Œå¯¹è±¡çš„æ•°ç›®ã€‚åœ¨ä¸‹ä¸€èŠ‚ï¼Œå½“å®ƒå’Œ by ä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒç‰¹åˆ«æœ‰ç”¨ã€‚è¿˜æ²¡æœ‰æ¶‰åŠåˆ°åˆ†ç»„çš„æ—¶å€™ï¼Œå®ƒåªæ˜¯ç®€å•åœ°è¿”å›è¡Œçš„æ•°ç›®ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ .N æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[origin == &amp;quot;JFK&amp;quot; &amp;amp; month == 6L, .N]
ans
# [1] 8422
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* å†è¯´ä¸€éï¼Œé¦–å…ˆåœ¨iå‚æ•°é‡Œï¼Œæ‰¾åˆ°æ‰€æœ‰ç¬¦åˆ origin (æœºåœº)æ˜¯&amp;quot;JFK&amp;quot;ï¼Œå¹¶ä¸” month (æœˆä»½)æ˜¯ 6 è¿™æ ·æ¡ä»¶çš„è¡Œã€‚   
* åœ¨å‚æ•°jé‡Œï¼Œæˆ‘ä»¬åªæŒ‡å®šäº† .Nï¼Œå…¶ä»–ä»€ä¹ˆä¹Ÿæ²¡æŒ‡å®šã€‚æ‰€ä»¥å®é™…ä¸Šæˆ‘ä»¬ä»€ä¹ˆä¹Ÿæ²¡åšã€‚æˆ‘ä»¬åªæ˜¯è¿”å›äº†ç¬¦åˆæ¡ä»¶çš„è¡Œçš„æ•°ç›®ï¼ˆå°±æ˜¯è¡Œçš„ lengthé•¿åº¦ï¼‰ã€‚   
* æ³¨æ„ï¼Œæˆ‘ä»¬æ²¡æœ‰ç”¨ list() æˆ–è€… .() åŒ…å›´ .Nï¼Œæ‰€ä»¥è¿”å›å€¼æ˜¯ä¸ªå‘é‡ã€‚
æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™æ ·å®Œæˆè¿™ä¸ªä»»åŠ¡ nrow(flights[origin == &amp;quot;JFK&amp;quot; &amp;amp; month == 6L])ã€‚ä½†æ˜¯ï¼Œè¿™ä¼šä»æ•´ä¸ªdata.tableé‡Œé¢subsetç¬¦åˆæ¡ä»¶çš„è¡Œï¼Œç„¶åç”¨ nrow() è¿”å›è¡Œçš„æ•°ç›®ï¼Œè¿™æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œè€Œä¸”æ•ˆç‡ä½ä¸‹ã€‚æˆ‘ä»¬ä¼šåœ¨ data.tableçš„è®¾è®¡ è¿™ä¸ªæ•™ç¨‹é‡Œé¢è¯´æ˜è¿™ä¸€ç‚¹å’Œå…¶ä»–çš„ä¼˜åŒ–æ–¹æ³•ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;g-å¤ªæ£’äº†-ä½†æˆ‘åº”è¯¥å¦‚ä½•ç”¨å‚æ•°jé‡Œé¢çš„åå­—å¼•ç”¨åˆ—-å°±åƒåœ¨data-frameé‚£æ ·:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;g) å¤ªæ£’äº†ï¼ä½†æˆ‘åº”è¯¥å¦‚ä½•ç”¨å‚æ•°jé‡Œé¢çš„åå­—å¼•ç”¨åˆ—ï¼ˆå°±åƒåœ¨data.frameé‚£æ ·ï¼‰&lt;/h4&gt;

&lt;p&gt;ä½ å¯ä»¥ä½¿ç”¨ with = FALSE æ¥å¼•ç”¨åˆ—åã€‚&lt;br /&gt;
ï¼ ç”¨data.frameçš„æ–¹å¼ï¼Œé€‰å– arr_delay å’Œ dep_delay ä¸¤åˆ—&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[, c(&amp;quot;arr_delay&amp;quot;, &amp;quot;dep_delay&amp;quot;), with=FALSE]
head(ans)
#    arr_delay dep_delay
# 1:        13        14
# 2:        13        -3
# 3:         9         2
# 4:       -26        -8
# 5:         1         2
# 6:         0         4
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ä¸ªå‚æ•°å«åš withï¼Œæ˜¯æ ¹æ® Ré‡Œé¢çš„å‡½æ•° with() æ¼”å˜è€Œæ¥çš„ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªdata.frameå«åš DFï¼Œæƒ³è¦subsetæ‰€æœ‰ç¬¦åˆ x&amp;gt;1 çš„è¡Œã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DF = data.frame(x = c(1,1,1,2,2,3,3,3), y = 1:8)

## (1) normal way
DF[DF$x &amp;gt; 1, ] # data.frame needs that &#39;,&#39; as well
#   x y
# 4 2 4
# 5 2 5
# 6 3 6
# 7 3 7
# 8 3 8

## (2) using with
DF[with(DF, x &amp;gt; 1), ]
#   x y
# 4 2 4
# 5 2 5
# 6 3 6
# 7 3 7
# 8 3 8
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* åœ¨ä¸Šé¢çš„ (2) using withé‡Œé¢ï¼Œä½¿ç”¨ with()ï¼Œæˆ‘ä»¬åƒå˜é‡ä¸€æ ·ä½¿ç”¨DFçš„xåˆ—ã€‚
å› æ­¤ï¼Œåœ¨data.tableé‡Œï¼Œæˆ‘ä»¬è®¾ç½® with=FALSEï¼Œä½¿å¾—æˆ‘ä»¬ä¸èƒ½å†åƒå˜é‡ä¸€æ ·å¼•ç”¨åˆ—äº†ï¼Œè¿™è¢«ä¿å­˜åœ¨â€œdata.frame modeâ€ä¸­ã€‚
* æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ - æˆ–è€… ! æ¥æ’é™¤åˆ—ã€‚æ¯”å¦‚ï¼š
## not run

# returns all columns except arr_delay and dep_delay
ans &amp;lt;- flights[, !c(&amp;quot;arr_delay&amp;quot;, &amp;quot;dep_delay&amp;quot;), with=FALSE]
# or
ans &amp;lt;- flights[, -c(&amp;quot;arr_delay&amp;quot;, &amp;quot;dep_delay&amp;quot;), with=FALSE]

* Rè¯­è¨€ä»V1.9.5ç‰ˆå¼€å§‹ï¼Œå¯ä»¥æŒ‡å®šå¼€å§‹å’Œç»“æŸçš„åˆ—åï¼Œæ¯”å¦‚é€šè¿‡æŒ‡å®š year:day æ¥é€‰æ‹©å‰ä¸‰åˆ—ã€‚
## not run

# returns year,month and day
ans &amp;lt;- flights[, year:day, with=FALSE]
# returns day, month and year
ans &amp;lt;- flights[, day:year, with=FALSE]
# returns all columns except year, month and day
ans &amp;lt;- flights[, -(year:day), with=FALSE]
ans &amp;lt;- flights[, !(year:day), with=FALSE]

è¿™åœ¨äº¤äº’å¼çš„å·¥ä½œä¸­ç‰¹åˆ«æ–¹ä¾¿ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;with=FALSE æ˜¯data.tableçš„é»˜è®¤å€¼ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥é€šè¿‡å‚æ•°jè¡¨è¾¾å¼ï¼Œæ¥åšæ›´å¤šçš„äº‹ï¼Œç‰¹åˆ«æ˜¯æ¥ä¸‹æ¥ä¸€èŠ‚æˆ‘ä»¬è¦è®²åˆ°çš„ï¼Œå’Œ by çš„è”åˆã€‚&lt;/p&gt;

&lt;h2 id=&#34;2-èšåˆ:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;2.èšåˆ&lt;/h2&gt;

&lt;p&gt;åœ¨å‰é¢ä¸€èŠ‚ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†å‚æ•°iå’Œjï¼ŒçŸ¥é“äº†data.tableçš„åŸºæœ¬è¯­æ³•ã€‚åœ¨è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å­¦ä¹ å¦‚ä½•è·Ÿ by ç›¸ç»“åˆï¼Œåšä¸€äº›åˆ†ç»„çš„æ“ä½œã€‚å…ˆæ¥çœ‹çœ‹å‡ ä¸ªä¾‹å­ã€‚&lt;/p&gt;

&lt;h4 id=&#34;a-ç”¨byåˆ†ç»„:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;a) ç”¨byåˆ†ç»„&lt;/h4&gt;

&lt;p&gt;ï¼ å¦‚ä½•è·å–æ¯ä¸ªæœºåœºèµ·é£çš„èˆªç­æ•°&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[, .(.N), by=.(origin)]
ans
#    origin     N
# 1:    JFK 81483
# 2:    LGA 84433
# 3:    EWR 87400

## or equivalently using a character vector in &#39;by&#39;
# ans &amp;lt;- flights[, .(.N), by=&amp;quot;origin&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬çŸ¥é“ .N è¡¨ç¤ºå½“å‰çš„åˆ†ç»„ä¸­ï¼Œå¯¹è±¡çš„æ•°ç›®ã€‚å…ˆæŒ‰ç…§ origin åˆ—åˆ†ç»„ï¼Œå†ç”¨ .N è·å–æ¯ç»„çš„æ•°ç›®ã€‚
* é€šè¿‡ head(flights)ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœé‡Œé¢ï¼Œæœºåœºæ˜¯æŒ‰ç…§â€œJFKâ€, â€œLGAâ€ ç„¶å â€œEWRâ€ çš„é¡ºåºæ’åˆ—çš„ã€‚åŸå§‹æ•°æ®é‡Œï¼Œè¢«åˆ†ç»„çš„é‚£ä¸€åˆ—å˜é‡çš„é¡ºåºï¼Œä¹Ÿä½“ç°åœ¨ç»“æœé‡Œé¢ã€‚   
* æ—¢ç„¶æˆ‘ä»¬æ²¡æœ‰åœ¨å‚æ•°jé‡Œé¢æŒ‡å®šåˆ—åï¼Œé‚£è¿™ä¸€åˆ—å°±è‡ªç„¶æ˜¯ N äº†ã€‚
* by ä¹Ÿæ¥å—ä¸€ä¸ªåŒ…å«åˆ—åçš„å­—ç¬¦å‘é‡ä½œä¸ºå‚æ•°ã€‚è¿™åœ¨å†™ä»£ç çš„æ—¶å€™ç‰¹åˆ«æœ‰ç”¨ï¼Œæ¯”å¦‚è®¾è®¡ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„å‚æ•°æ˜¯è¦è¢«åˆ†ç»„çš„åˆ—ã€‚
* å½“å‚æ•°jå’Œbyé‡Œé¢åªæœ‰ä¸€åˆ—ï¼Œæˆ‘ä»¬å¯ä»¥çœç•¥ .()ï¼Œè¿™å®åœ¨å¾ˆæ–¹ä¾¿ã€‚åˆšåˆšçš„ä»»åŠ¡æˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š
ans &amp;lt;- flights[, .N, by=origin]
ans
#    origin     N
# 1:    JFK 81483
# 2:    LGA 84433
# 3:    EWR 87400

åªè¦å…è®¸ï¼Œæˆ‘ä»¬å°±ä¼šä½¿ç”¨è¿™ç§æ–¹ä¾¿çš„å½¢å¼ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼ å¦‚ä½•è·å–ç¾èˆªï¼ˆcarrier codeä»£ç æ˜¯â€œAAâ€ï¼‰åœ¨æ¯ä¸ªæœºåœºèµ·é£çš„èˆªç­æ•°
èˆªç©ºå…¬å¸ä»£ç â€œAAâ€ä»£è¡¨ç¾èˆªã€‚æ¯ä¸ªèˆªç©ºå…¬å¸çš„ä»£ç éƒ½æ˜¯å”¯ä¸€çš„ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[carrier == &amp;quot;AA&amp;quot;, .N, by=origin]
ans
#    origin     N
# 1:    JFK 11923
# 2:    LGA 11730
# 3:    EWR  2649
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬é¦–å…ˆé€šè¿‡å‚æ•°iï¼ŒæŒ‡å®šè¡¨è¾¾å¼ carrier == &amp;quot;AA&amp;quot;ï¼Œé€‰å–ç¬¦åˆæ¡ä»¶çš„è¡Œã€‚
* å¯¹äºè¿™äº›è¡Œï¼Œæˆ‘ä»¬å†æŒ‰ origin åˆ†ç»„ï¼Œè·å–æ¯ç»„çš„æ•°ç›®ã€‚å†æ¬¡å£°æ˜ï¼Œå®é™…ä¸Šæ²¡æœ‰åˆ—è¢«é‡æ–°åˆ›å»ºï¼Œå› ä¸ºå‚æ•°jè¡¨è¾¾å¼ä¸éœ€è¦è·å–åˆ—ï¼Œå› æ­¤åœ¨è®¡ç®—é€Ÿåº¦å’Œå†…å­˜ä½¿ç”¨é‡è¿™ä¸¤æ–¹é¢ï¼Œå–å¾—æœ€ä¼˜çš„æ•ˆæœã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼ å¦‚ä½•è·å–ç¾èˆªåœ¨æ‰€æœ‰æœºåœºçš„èµ·ï¼é™çš„æ•°ç›®&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[carrier == &amp;quot;AA&amp;quot;, .N, by=.(origin,dest)]
head(ans)
#    origin dest    N
# 1:    JFK  LAX 3387
# 2:    LGA  PBI  245
# 3:    EWR  LAX   62
# 4:    JFK  MIA 1876
# 5:    JFK  SEA  298
# 6:    EWR  MIA  848

## or equivalently using a character vector in &#39;by&#39;
# ans &amp;lt;- flights[carrier == &amp;quot;AA&amp;quot;, .N, by=c(&amp;quot;origin&amp;quot;, &amp;quot;dest&amp;quot;)]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* å‚æ•°by å¯ä»¥æ¥å—å¤šä¸ªåˆ—ã€‚æˆ‘ä»¬å¯ä»¥æŒ‡å®šæ‰€æœ‰æˆ‘ä»¬æƒ³åˆ†ç»„çš„åˆ—ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼ å¦‚ä½•è·å–ç¾èˆªåœ¨æ‰€æœ‰æœºåœºçš„èµ·ï¼é™çš„å¹³å‡å»¶è¯¯æ—¶é—´&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[carrier == &amp;quot;AA&amp;quot;, 
    .(mean(arr_delay), mean(dep_delay)), 
    by=.(origin, dest, month)]
ans
#      origin dest month         V1         V2
#   1:    JFK  LAX     1   6.590361 14.2289157
#   2:    LGA  PBI     1  -7.758621  0.3103448
#   3:    EWR  LAX     1   1.366667  7.5000000
#   4:    JFK  MIA     1  15.720670 18.7430168
#   5:    JFK  SEA     1  14.357143 30.7500000
#  ---                                        
# 196:    LGA  MIA    10  -6.251799 -1.4208633
# 197:    JFK  MIA    10  -1.880184  6.6774194
# 198:    EWR  PHX    10  -3.032258 -4.2903226
# 199:    JFK  MCO    10 -10.048387 -1.6129032
# 200:    JFK  DCA    10  16.483871 15.5161290
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬æ²¡æœ‰åœ¨å‚æ•°jè¡¨è¾¾å¼ä¸­æŒ‡å®šåˆ—åï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨å‘½åä¸º(V1, V2)ã€‚    * å†æ¬¡å£°æ˜ï¼ŒåŸæ•°æ®é‡Œé¢çš„é¡ºåºï¼Œä¼šåæ˜ åœ¨ç»“æœä¸­ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®©ç»“æœæŒ‰ç…§ origin, dest å’Œ month æ’åºå‘¢ï¼Ÿ&lt;/p&gt;

&lt;h4 id=&#34;b-å‚æ•°keyby:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;b) å‚æ•°keyby&lt;/h4&gt;

&lt;p&gt;data.tableæœ¬èº«å°±è¢«è®¾è®¡æˆèƒ½ä¿æŒåŸæ•°æ®çš„é¡ºåºã€‚åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œå¿…é¡»ä¿æŒåŸæ¥çš„é¡ºåºã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶æˆ‘ä»¬å¸Œæœ›è‡ªåŠ¨æ ¹æ®åˆ†ç»„çš„å˜é‡æ’åºã€‚&lt;/p&gt;

&lt;p&gt;ï¼ å¦‚ä½•æŒ‰ç…§åˆ†ç»„çš„å˜é‡æ’åº&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[carrier == &amp;quot;AA&amp;quot;, 
    .(mean(arr_delay), mean(dep_delay)), 
    keyby=.(origin, dest, month)]
ans
#      origin dest month         V1         V2
#   1:    EWR  DFW     1   6.427673 10.0125786
#   2:    EWR  DFW     2  10.536765 11.3455882
#   3:    EWR  DFW     3  12.865031  8.0797546
#   4:    EWR  DFW     4  17.792683 12.9207317
#   5:    EWR  DFW     5  18.487805 18.6829268
#  ---                                        
# 196:    LGA  PBI     1  -7.758621  0.3103448
# 197:    LGA  PBI     2  -7.865385  2.4038462
# 198:    LGA  PBI     3  -5.754098  3.0327869
# 199:    LGA  PBI     4 -13.966667 -4.7333333
# 200:    LGA  PBI     5 -10.357143 -6.8571429
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬åšçš„ï¼Œåªæ˜¯æŠŠ by æ”¹ä¸ºäº† keybyã€‚è¿™ä¼šè‡ªåŠ¨çš„å°†ç»“æœæŒ‰ç…§å‡åºæ’åˆ—ã€‚æ³¨æ„ keyby() åœ¨å®Œæˆæ“ä½œåç”Ÿæ•ˆï¼Œä¾‹å¦‚ï¼Œåœ¨è®¡ç®—ç»“æœåå†æ’åºã€‚   
keysï¼šå®é™…ä¸Š keyby åšçš„ä¸åªæ˜¯æ’åºã€‚å®ƒåœ¨æ’åºä¹‹åï¼Œè®¾ç½®ä¸€ä¸ªå«åšsortedçš„å±æ€§ã€‚æˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€æ•™ç¨‹å­¦ä¹ æ›´å¤šå…³äº keysçš„å†…å®¹ã€‚   
ç°åœ¨ï¼Œä½ éœ€è¦çŸ¥é“çš„ï¼Œå°±æ˜¯ä½¿ç”¨ keyby è‡ªåŠ¨æ’åºã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;c-chainingè¡¨è¾¾å¼:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;c) chainingè¡¨è¾¾å¼&lt;/h4&gt;

&lt;p&gt;è®©æˆ‘ä»¬å†æ¥è€ƒè™‘ä¸‹â€œè·å–ç¾èˆªåœ¨æ‰€æœ‰æœºåœºçš„èµ·ï¼é™çš„æ•°ç›®â€çš„é—®é¢˜ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[carrier == &amp;quot;AA&amp;quot;, .N, by = .(origin, dest)]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼ å¦‚ä½•è®© ans æŒ‰originçš„å‡åºã€æŒ‰destçš„é™åºæ’åˆ—
æˆ‘ä»¬å¯ä»¥å°†ä¸­é—´ç»“æœä¿å­˜ä¸ºä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œå†å¯¹è¿™ä¸ªå˜é‡ä½¿ç”¨ order(origin, -dest) æ’åºã€‚è¿™çœ‹ä¸Šå»è¿˜æŒºç®€æ´æ˜äº†çš„ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- ans[order(origin, -dest)]
head(ans)
#    origin dest    N
# 1:    EWR  PHX  121
# 2:    EWR  MIA  848
# 3:    EWR  LAX   62
# 4:    EWR  DFW 1618
# 5:    JFK  STT  229
# 6:    JFK  SJU  690
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* å›å¿†ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨å‡½æ•° order()ä¸­ï¼Œå¯¹ä¸€ä¸ªå­—ç¬¦å‹çš„åˆ—ä½¿ç”¨ &amp;quot;-&amp;quot; æ¥é™åºæ’åˆ—ã€‚ç”±äºdata.tableçš„å†…éƒ¨æŸ¥è¯¢ä¼˜åŒ–(internal query optimisation)ï¼Œè¿™æ ·åšæ˜¯å¯è¡Œçš„ã€‚
* å†å›å¿†ä¸€ä¸‹ order(...)å·²ç»é€šè¿‡data.tableå†…éƒ¨çš„å¿«é€ŸåŸºæ•°æ’åºå‡½æ•° forder()ä¼˜åŒ–è¿‡äº†ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­ä½¿ç”¨ç†Ÿæ‚‰çš„Rçš„åŸºç¡€å‡½æ•°ï¼Œè€Œä¸æ˜¯è€ƒè™‘ä½¿ç”¨data.tableæä¾›çš„é€Ÿåº¦å¿«å†…å­˜æ¶ˆè€—å°‘çš„æ’åºæ–¹æ³•ã€‚æˆ‘ä»¬ä¼šåœ¨data.table internalsçš„æ•™ç¨‹ä¸­è¯´æ˜æ›´å¤šç»†èŠ‚ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½†æ˜¯è¿™ä¹ˆåšä¼šç”Ÿæˆä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œç„¶åå†ä¿®æ”¹è¿™ä¸ªä¸´æ—¶å˜é‡ã€‚å…¶å®æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ chainingè¡¨è¾¾å¼ï¼Œé¿å…ç”Ÿæˆä¸´æ—¶å˜é‡ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[carrier == &amp;quot;AA&amp;quot;, .N, by=.(origin, dest)][order(origin, -dest)]
head(ans, 10)
#     origin dest    N
#  1:    EWR  PHX  121
#  2:    EWR  MIA  848
#  3:    EWR  LAX   62
#  4:    EWR  DFW 1618
#  5:    JFK  STT  229
#  6:    JFK  SJU  690
#  7:    JFK  SFO 1312
#  8:    JFK  SEA  298
#  9:    JFK  SAN  299
# 10:    JFK  ORD  432
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬å¯ä»¥ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ·»åŠ è¡¨è¾¾å¼ï¼Œåšä¸€ç³»åˆ—æ“ä½œï¼Œå°±åƒè¿™æ ·ï¼šDT[...][...][...]ã€‚
* æˆ–è€…ä½ å¯ä»¥æ¢è¡Œå†™ï¼š
DT[...
 ][...
 ][...
 ]
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;d-byè¡¨è¾¾å¼:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;d) byè¡¨è¾¾å¼&lt;/h4&gt;

&lt;p&gt;ï¼ å‚æ•°byä¹Ÿå¯ä»¥æ¥å—è¡¨è¾¾å¼å—ï¼Ÿè¿˜æ˜¯åªèƒ½æŒ‡å®šåˆ—&lt;br /&gt;
å½“ç„¶å¯ä»¥æ¥å—è¡¨è¾¾å¼ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦çŸ¥é“ï¼Œæœ‰å¤šå°‘èˆªç­èµ·é£å»¶è¯¯ä½†å´æå‰ï¼å‡†æ—¶åˆ°è¾¾çš„ï¼Œæœ‰å¤šå°‘èˆªç­èµ·é£å’Œåˆ°è¾¾éƒ½å»¶è¯¯äº†â€¦â€¦&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[, .N, .(dep_delay&amp;gt;0, arr_delay&amp;gt;0)]
ans
#    dep_delay arr_delay      N
# 1:      TRUE      TRUE  72836
# 2:     FALSE      TRUE  34583
# 3:     FALSE     FALSE 119304
# 4:      TRUE     FALSE  26593
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æœ€åä¸€è¡Œï¼Œæ»¡è¶³ dep_delay &amp;gt; 0 = TRUE ä¸” arr_delay &amp;gt; 0 = FALSE çš„æ¡ä»¶ã€‚æˆ‘ä»¬çŸ¥é“æœ‰26593æ¬¡èˆªç­èµ·é£å»¶è¯¯ä½†å´æå‰ï¼å‡†æ—¶åˆ°è¾¾äº†ã€‚
* æ³¨æ„ï¼Œæˆ‘ä»¬æ²¡æœ‰åœ¨byè¡¨è¾¾å¼é‡Œé¢æŒ‡å®šä»»ä½•åˆ—åã€‚ç„¶è€Œç»“æœé‡Œé¢ï¼Œåˆ—åè¿˜æ˜¯è‡ªåŠ¨çš„ç”Ÿæˆäº†ã€‚
* æˆ‘ä»¬å¯ä»¥åœ¨è¡¨è¾¾å¼é‡Œé¢æŒ‡å®šå…¶ä»–çš„åˆ—ï¼Œæ¯”å¦‚ï¼šDT[, .N, by=.(a, b&amp;gt;0)]ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;e-åœ¨å‚æ•°jé‡Œé¢æŒ‡å®šå¤šä¸ªåˆ—:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;e) åœ¨å‚æ•°jé‡Œé¢æŒ‡å®šå¤šä¸ªåˆ—&lt;/h4&gt;

&lt;p&gt;ï¼ å¿…é¡»åˆ†åˆ«å¯¹æ¯åˆ—æŒ‡å®š mean() å‡½æ•°å—
å½“ç„¶ä¸å¿…åˆ†åˆ«å¯¹æ¯åˆ—è¾“å…¥ mean(myCol) äº†ã€‚è¦æ˜¯æˆ‘ä»¬æœ‰100åˆ—è¦è®¡ç®—å¹³å‡å€¼ï¼Œä¸å°±æƒ¨äº†å—ã€‚&lt;br /&gt;
å¦‚ä½•é«˜æ•ˆåœ°è®¡ç®—å‘¢ã€‚è®°ä¸è®°å¾—è¿™ä¸ªå°è´´å£«-â€œåªè¦å‚æ•°j è¿”å›ä¸€ä¸ªlistï¼Œè¿™ä¸ªlistçš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½ä¼šè¢«è½¬æ¢æˆç»“æœdata.tableçš„ä¸€åˆ—ã€‚â€å‡è®¾æˆ‘ä»¬åˆ†ç»„çš„æ—¶å€™ï¼Œå¯ä»¥åƒå˜é‡ä¸€æ ·ï¼Œå¼•ç”¨æ¯ä¸ªåˆ†ç»„çš„æ•°æ®ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾ªç¯å¯¹æ‰€æœ‰çš„åˆ—åº”ç”¨å‡½æ•° lapply() ï¼Œè€Œä¸éœ€è¦å­¦ä¹ æ–°çš„å‡½æ•°ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ç‰¹æ®Šçš„è¯­æ³• .SD:
data.tableæä¾›ä¸€ä¸ªç‰¹æ®Šçš„è¯­æ³•ï¼Œå½¢å¼æ˜¯ .SDã€‚å®ƒæ˜¯ Subset of Data çš„ç¼©å†™ã€‚å®ƒè‡ªèº«å°±æ˜¯ä¸€ä¸ªdata.tableï¼ŒåŒ…å«é€šè¿‡by åˆ†ç»„åçš„æ¯ä¸€ç»„ã€‚
å›å¿†ä¸€ä¸‹ï¼Œä¸€ä¸ªdata.tableæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªlistï¼Œå®ƒä»¬çš„åˆ—åŒ…å«çš„å…ƒç´ ä¸ªæ•°éƒ½ç›¸åŒï¼ˆå…¶å®å°±æ˜¯è¡Œæ•°ï¼‰ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è®©æˆ‘ä»¬ç”¨ä¹‹å‰çš„ä¸€ä¸ªdata.table DTæ¥çœ‹çœ‹ .SD æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT
#    ID a  b  c
# 1:  b 1  7 13
# 2:  b 2  8 14
# 3:  b 3  9 15
# 4:  a 4 10 16
# 5:  a 5 11 17
# 6:  c 6 12 18

DT[, print(.SD), by=ID]
#    a b  c
# 1: 1 7 13
# 2: 2 8 14
# 3: 3 9 15
#    a  b  c
# 1: 4 10 16
# 2: 5 11 17
#    a  b  c
# 1: 6 12 18
# Empty data.table (0 rows) of 1 col: ID
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* .SD åŒ…å«é™¤äº†åˆ†ç»„ä¾æ®çš„é‚£ä¸€åˆ—ä»¥å¤–çš„æ‰€æœ‰åˆ—ã€‚
* è¿”å›å€¼ä¾æ—§ä¿æŒäº†åŸæ•°æ®çš„é¡ºåºã€‚é¦–å…ˆæ‰“å°å‡ºæ¥çš„æ˜¯ ID=â€œbâ€ çš„æ•°æ®ï¼Œç„¶åæ˜¯ ID=â€œaâ€ çš„ï¼Œæœ€åæ˜¯  ID=â€œcâ€ çš„ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸ºäº†å¯¹å¤æ•°çš„åˆ—è¿›è¡Œè®¡ç®—ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨å‡½æ•° lapply()ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT[, lapply(.SD, mean), by=ID]
#    ID   a    b    c
# 1:  b 2.0  8.0 14.0
# 2:  a 4.5 10.5 16.5
# 3:  c 6.0 12.0 18.0 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* .SD åˆ†åˆ«åŒ…å«äº†IDæ˜¯ aã€bã€cçš„æ‰€æœ‰è¡Œï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº”äº†å„è‡ªçš„ç»„ã€‚æˆ‘ä»¬åº”ç”¨å‡½æ•° lapply() å¯¹æ¯åˆ—è®¡ç®—å¹³å‡å€¼ã€‚
* æ¯ä¸€ç»„è¿”å›åŒ…å«ä¸‰ä¸ªå¹³å‡æ•°çš„listï¼Œè¿™äº›æ„æˆäº†æœ€ç»ˆè¿”å›çš„data.tableã€‚
* æ—¢ç„¶å‡½æ•° lapply() è¿”å› listï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦åœ¨å¤–é¢å¤šåŠ  .() äº†ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å·®ä¸å¤šå¯ä»¥äº†ï¼Œå†è¡¥å……ä¸€ç‚¹ã€‚åœ¨ flights è¿™ä¸ª data.tableé‡Œé¢ï¼Œæˆ‘ä»¬æ‰§è¡Œè®¡ç®— arr_delay å’Œ dep_delay è¿™ä¸¤åˆ—çš„å¹³å‡å€¼ã€‚ä½†æ˜¯ï¼Œ.SD é»˜è®¤åŒ…å«ç”¨äºåˆ†ç»„çš„æ‰€æœ‰åˆ—çš„å¹³å‡å€¼ã€‚&lt;/p&gt;

&lt;p&gt;ï¼å¦‚ä½•æŒ‡å®šå¸Œæœ›è®¡ç®—å¹³å‡å€¼çš„åˆ—&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.SDcols
ä½¿ç”¨å‚æ•° .SDcolsã€‚å®ƒæ¥å—åˆ—åæˆ–è€…åˆ—ç´¢å¼•ã€‚æ¯”å¦‚ï¼Œ.SDcols = c(&amp;quot;arr_delay&amp;quot;, &amp;quot;dep_delay&amp;quot;)èƒ½ç¡®ä¿.SDä¹‹åŒ…å« arr_delay å’Œ dep_delay è¿™ä¸¤åˆ—ã€‚
å’Œ with = FALSE ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ - æˆ–è€… ! æ¥ç§»é™¤åˆ—ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬æŒ‡å®š !(colA:colB) æˆ–è€… -(colA:colB)è¡¨ç¤ºç§»é™¤ä» colA åˆ° colB çš„æ‰€æœ‰åˆ—ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç°åœ¨è®©æˆ‘ä»¬è¯•ç€ç”¨ .SD å’Œ .SDcols æ¥è·å– arr_delay å’Œ dep_delay è¿™ä¸¤åˆ—çš„å¹³å‡å€¼ï¼Œå¹¶ä¸”æŒ‰ç…§ origin, dest å’Œ month æ¥åˆ†ç»„ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flights[carrier == &amp;quot;AA&amp;quot;,                     ## Only on trips with carrier &amp;quot;AA&amp;quot;
        lapply(.SD, mean),                   ## compute the mean
        by=.(origin, dest, month),           ## for every &#39;origin,dest,month&#39;
        .SDcols=c(&amp;quot;arr_delay&amp;quot;, &amp;quot;dep_delay&amp;quot;)] ## for just those specified in .SDcols
#      origin dest month  arr_delay  dep_delay
#   1:    JFK  LAX     1   6.590361 14.2289157
#   2:    LGA  PBI     1  -7.758621  0.3103448
#   3:    EWR  LAX     1   1.366667  7.5000000
#   4:    JFK  MIA     1  15.720670 18.7430168
#   5:    JFK  SEA     1  14.357143 30.7500000
#  ---                                        
# 196:    LGA  MIA    10  -6.251799 -1.4208633
# 197:    JFK  MIA    10  -1.880184  6.6774194
# 198:    EWR  PHX    10  -3.032258 -4.2903226
# 199:    JFK  MCO    10 -10.048387 -1.6129032
# 200:    JFK  DCA    10  16.483871 15.5161290
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;f-å¯¹æ¯ç»„subset-sd:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;f) å¯¹æ¯ç»„subset .SD&lt;/h4&gt;

&lt;p&gt;ï¼ å¦‚ä½•è¿”å›æ¯ä¸ªæœˆçš„å‰ä¸¤è¡Œ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans &amp;lt;- flights[, head(.SD, 2), by=month]
head(ans)
#    month year day dep_time dep_delay arr_time arr_delay cancelled carrier tailnum flight origin
# 1:     1 2014   1      914        14     1238        13         0      AA  N338AA      1    JFK
# 2:     1 2014   1     1157        -3     1523        13         0      AA  N335AA      3    JFK
# 3:     2 2014   1      859        -1     1226         1         0      AA  N783AA      1    JFK
# 4:     2 2014   1     1155        -5     1528         3         0      AA  N784AA      3    JFK
# 5:     3 2014   1      849       -11     1306        36         0      AA  N784AA      1    JFK
# 6:     3 2014   1     1157        -3     1529        14         0      AA  N787AA      3    JFK
#    dest air_time distance hour min
# 1:  LAX      359     2475    9  14
# 2:  LAX      363     2475   11  57
# 3:  LAX      358     2475    8  59
# 4:  LAX      358     2475   11  55
# 5:  LAX      375     2475    8  49
# 6:  LAX      368     2475   11  57
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* .SD åŒ…å«äº†æ¯ç»„çš„æ‰€æœ‰è¡Œã€‚æˆ‘ä»¬å¯ä»¥ç®€å•çš„subsetå„ç»„æ•°æ®çš„å‰ä¸¤è¡Œã€‚
* å¯¹æ¯ç»„æ•°æ®ï¼Œhead(.SD, 2)è¿”å›çš„data.tableåŒæ—¶ä¹Ÿæ˜¯ä¸ªlistã€‚æ‰€ä»¥ä¸éœ€è¦ç”¨ .() åŒ…å›´èµ·æ¥ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;g-ä¸ºä»€ä¹ˆå‚æ•°jè¿™ä¹ˆçµæ´»:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;g) ä¸ºä»€ä¹ˆå‚æ•°jè¿™ä¹ˆçµæ´»&lt;/h4&gt;

&lt;p&gt;è¿™æ ·ï¼Œæˆ‘ä»¬æœ‰äº†ç¬¦åˆRè¯­è¨€é£æ ¼çš„è¯­æ³•ï¼Œæˆ‘ä»¬ä¹Ÿä½¿ç”¨Rè¯­è¨€é‡Œé¢æ—¢å­˜çš„å‡½æ•°å®šä¹‰ï¼Œè€Œä¸æ˜¯å®šä¹‰æ–°çš„å‡½æ•°ã€‚æˆ‘ä»¬ç”¨æ•™ç¨‹ä¸€å¼€å§‹åˆ›å»ºçš„DTæ¥è¯´æ˜ã€‚&lt;/p&gt;

&lt;p&gt;ï¼å¦‚ä½•ä¿å­˜æŒ‰ç…§IDåˆ†ç»„åæ•°æ®ä¸­çš„ aåˆ—å’Œ båˆ— çš„ä¿¡æ¯&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT
#    ID a  b  c
# 1:  b 1  7 13
# 2:  b 2  8 14
# 3:  b 3  9 15
# 4:  a 4 10 16
# 5:  a 5 11 17
# 6:  c 6 12 18

DT[, .(val = c(a,b)), by=ID]
#     ID val
#  1:  b   1
#  2:  b   2
#  3:  b   3
#  4:  b   7
#  5:  b   8
#  6:  b   9
#  7:  a   4
#  8:  a   5
#  9:  a  10
# 10:  a  11
# 11:  c   6
# 12:  c  12
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* å°±è¿™æ ·ï¼Œä¸éœ€è¦ç‰¹æ®Šçš„è¯­æ³•ã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“çš„ï¼Œå°±æ˜¯ç”¨å‡½æ•° c() æŒ‡å®šéœ€è¦è¿ç»“çš„å‘é‡ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ï¼ å¦‚ä½•å°†åˆšåˆšçš„æ•°æ®ï¼Œä½œä¸ºä¸€åˆ—è¿”å›&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT[, .(val = list(c(a,b))), by=ID]
#    ID         val
# 1:  b 1,2,3,7,8,9
# 2:  a  4, 5,10,11
# 3:  c        6,12
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* æˆ‘ä»¬é¦–å…ˆç”¨ c(a,b) è¿ç»“äº†æ¯ç»„çš„å€¼ï¼Œç„¶åç”¨ list() åŒ…å›´èµ·æ¥ã€‚é‚£ä¹ˆå¯¹äºæ¯ç»„æ•°æ®ï¼Œæˆ‘ä»¬è¿”å›ä¸€ä¸ªæ‰€æœ‰è¿ç»“åçš„å€¼çš„ listã€‚
* æ³¨æ„ï¼Œé‚£äº›é€—å·éƒ½æ˜¯ç”¨æ¥è¾…åŠ©æ˜¾ç¤ºçš„ã€‚ä¸€ä¸ªlistä¸­çš„å…ƒç´ å¯ä»¥åŒ…å«ä»»ä½•å¯¹è±¡ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå®ƒä»¬çš„é•¿åº¦éƒ½ä¸ç›¸åŒã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸€æ—¦ä½ å¯¹å‚æ•°jçš„ç”¨æ³•äº§ç”Ÿäº†å…´è¶£ï¼Œä½ ä¼šå‘ç°è¯­æ³•æ˜¯å¤šä¹ˆå¼ºå¤§ã€‚ç†è§£è¿™äº›çš„ä¸€ä¸ªæœ‰æ•ˆçš„æ–¹æ³•å°±æ˜¯ï¼Œåœ¨ print() çš„å¸®åŠ©ä¸‹ï¼Œå¤šå¤šä½¿ç”¨ã€‚&lt;br /&gt;
ä¾‹å¦‚ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;## (1) look at the difference between
DT[, print(c(a,b)), by=ID]
# [1] 1 2 3 7 8 9
# [1]  4  5 10 11
# [1]  6 12
# Empty data.table (0 rows) of 1 col: ID

## (2) and
DT[, print(list(c(a,b))), by=ID]
# [[1]]
# [1] 1 2 3 7 8 9
# 
# [[1]]
# [1]  4  5 10 11
# 
# [[1]]
# [1]  6 12
# Empty data.table (0 rows) of 1 col: ID
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨(1)é‡Œé¢ï¼Œæ¯ç»„è¿”å›ä¸€ä¸ªå‘é‡ï¼Œå®ƒä»¬çš„é•¿åº¦åˆ†åˆ«æ˜¯6ï¼Œ4ï¼Œ2.ä½†æ˜¯(2)é‡Œé¢ï¼Œæ¯ç»„è¿”å›ä¸€ä¸ªé•¿åº¦éƒ½ä¸º1çš„listï¼Œå®ƒä»¬çš„ç¬¬ä¸€ä¸ªå…ƒç´ åŒ…å«äº†é•¿åº¦ä¸º6ï¼Œ4ï¼Œ2çš„å‘é‡ã€‚å› æ­¤ï¼Œ(1)çš„ç»“æœçš„é•¿åº¦æ˜¯6+4+2=12ï¼Œ(2)çš„ç»“æœçš„é•¿åº¦æ˜¯1+1+1=3ã€‚&lt;/p&gt;

&lt;h2 id=&#34;æ€»ç»“:3d5b18c834d19c525ed890cfd64b400c&#34;&gt;æ€»ç»“&lt;/h2&gt;

&lt;p&gt;data.tableçš„è¯­æ³•å½¢å¼æ˜¯ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DT[i, j, by]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æŒ‡å®šå‚æ•°iï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* ç±»ä¼¼äºdata.frameï¼Œæˆ‘ä»¬å¯ä»¥subsetè¡Œï¼Œé™¤éä¸éœ€è¦é‡å¤åœ°ä½¿ç”¨ DT$ï¼Œæ—¢ç„¶æˆ‘ä»¬èƒ½å°†åˆ—å½“åšå˜é‡æ¥å¼•ç”¨ã€‚ 
* æˆ‘ä»¬å¯ä»¥ä½¿ç”¨order()æ’åºã€‚ä¸ºäº†å¾—åˆ°æ›´å¿«é€Ÿçš„æ•ˆæœï¼Œorder()å‡½æ•°å†…éƒ¨ä½¿ç”¨äº†data.tableçš„å¿«é€Ÿæ’åºã€‚ 
æˆ‘ä»¬å¯ä»¥é€šè¿‡å‚æ•°iåšæ›´å¤šçš„äº‹ï¼Œå¾—åˆ°æ›´å¿«é€Ÿçš„é€‰å–å’Œè¿ç»“ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ•™ç¨‹â€œKeys and fast binary search based subsetsâ€å’Œâ€œJoins and rolling joinsâ€ä¸­å­¦åˆ°è¿™äº›ã€‚ 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æŒ‡å®šå‚æ•°jï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* ä»¥data.tableçš„å½¢å¼é€‰å–åˆ—ï¼šDT[, .(colA, colB)]ã€‚
* ä»¥data.frameçš„å½¢å¼é€‰å–åˆ—ï¼šDT[, c(&amp;quot;colA&amp;quot;, &amp;quot;colB&amp;quot;), with=FALSE]ã€‚
* æŒ‰åˆ—è¿›è¡Œè®¡ç®—ï¼šDT[, .(sum(colA), mean(colB))]ã€‚
* å¦‚æœéœ€è¦ï¼šDT[, .(sA =sum(colA), mB = mean(colB))]ã€‚
* å’Œiå…±åŒä½¿ç”¨ï¼šDT[colA &amp;gt; value, sum(colB)]ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æŒ‡å®šå‚æ•°byï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;* é€šè¿‡byï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šåˆ—ï¼Œæˆ–è€…åˆ—åï¼Œç”šè‡³è¡¨è¾¾å¼ï¼Œè¿›è¡Œåˆ†ç»„ã€‚å‚æ•°jå¯ä»¥å¾ˆçµæ´»åœ°é…ç½®å‚æ•°iå’Œbyå®ç°å¼ºå¤§çš„åŠŸèƒ½ã€‚
* byå¯ä»¥æŒ‡å®šå¤šä¸ªåˆ—ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šè¡¨è¾¾å¼ã€‚
* æˆ‘ä»¬å¯ä»¥ç”¨ keybyï¼Œå¯¹åˆ†ç»„çš„ç»“æœè‡ªåŠ¨æ’åºã€‚
* æˆ‘ä»¬å¯ä»¥åœ¨å‚æ•°jä¸­æŒ‡å®š .SD å’Œ .SDcolsï¼Œå¯¹å¤æ•°çš„åˆ—è¿›è¡Œæ“ä½œã€‚ä¾‹å¦‚ï¼š   
  1.æŠŠå‡½æ•°fun åº”ç”¨åˆ°æ‰€æœ‰ .SDcolsæŒ‡å®šçš„åˆ—ä¸Šï¼ŒåŒæ—¶å¯¹å‚æ•°byæŒ‡å®šçš„åˆ—è¿›è¡Œåˆ†ç»„ï¼šDT[, lapply(.SD, fun), by=., .SDcols=...]ã€‚ 
  2.è¿”å›æ¯ç»„å†Œå‰ä¸¤è¡Œï¼šDT[, head(.SD, 2), by=.]ã€‚
  3.ä¸‰ä¸ªå‚æ•°è”åˆä½¿ç”¨ï¼šDT[col &amp;gt; val, head(.SD, 1), by=.]ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å°æç¤ºï¼š&lt;br /&gt;
åªè¦jè¿”å›ä¸€ä¸ªlistï¼Œè¿™ä¸ªlistçš„æ¯ä¸ªå…ƒç´ éƒ½ä¼šæ˜¯ç»“æœdata.tableçš„ä¸€åˆ—ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹ä¸€è®²ï¼Œæˆ‘ä»¬å­¦ä¹ å¦‚ä½•ç”¨referenceæ¥addï¼updateï¼deleteæŸä¸€åˆ—ï¼Œå¦‚ä½•é€šè¿‡iå’Œbyåˆå¹¶å®ƒä»¬ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Rè¯­è¨€ä¸­çš„class()ã€mode()å’Œtypeof()çš„åŒºåˆ«</title>
      <link>http://youngspring1.github.io/post/2016/2016-03-08-r-class/</link>
      <pubDate>Tue, 08 Mar 2016 22:52:12 +0800</pubDate>
      
      <guid>http://youngspring1.github.io/post/2016/2016-03-08-r-class/</guid>
      <description>

&lt;p&gt;ä»Šå¤©å¯¹Rè¯­è¨€ä¸­çš„è¿™ä¸‰ä¸ªå‡½æ•°äº§ç”Ÿäº†ç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆæœ‰æ—¶å€™å®ƒä»¬çš„è¿è¡Œç»“æœä¸€æ ·ï¼Œæœ‰æ—¶å€™å´åˆä¸ä¸€æ ·ï¼Ÿ&lt;/p&gt;

&lt;h3 id=&#34;å®šä¹‰:4392bb40a36ba9fbdbf9a9669f2b4fbf&#34;&gt;å®šä¹‰&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;mode&lt;/strong&gt;&lt;br /&gt;
&amp;emsp;The (Storage) Mode of an Object&lt;br /&gt;
&lt;strong&gt;Description&lt;/strong&gt;&lt;br /&gt;
&amp;emsp;Get or set the type or storage mode of an object.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;typeof&lt;/strong&gt;&lt;br /&gt;
&amp;emsp;The Type of an Object&lt;br /&gt;
&lt;strong&gt;Description&lt;/strong&gt;&lt;br /&gt;
&amp;emsp;typeof determines the (R internal) type or storage mode of any object&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;class&lt;/strong&gt;&lt;br /&gt;
&amp;emsp;Object Classes&lt;br /&gt;
&lt;strong&gt;Description&lt;/strong&gt;&lt;br /&gt;
&amp;emsp;R possesses a simple generic function mechanism which can be used for an object-oriented style of programming.&lt;br /&gt;
&amp;emsp;Method dispatch takes place based on the class of the first argument to the generic function.&lt;/p&gt;

&lt;h3 id=&#34;è§£é‡Š:4392bb40a36ba9fbdbf9a9669f2b4fbf&#34;&gt;è§£é‡Š&lt;/h3&gt;

&lt;p&gt;åœ¨Ré‡Œé¢ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªmodeå’Œä¸€ä¸ªclassã€‚&lt;br /&gt;
å‰è€…è¡¨ç¤ºå¯¹è±¡åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•å­˜å‚¨çš„ã€‚ (numeric, character, list and function)&lt;br /&gt;
åè€…è¡¨ç¤ºå¯¹è±¡çš„æŠ½è±¡ç±»å‹ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;d &amp;lt;- data.frame(V1=c(1,2))
class(d)
# [1] &amp;quot;data.frame&amp;quot;
mode(d)
# [1] &amp;quot;list&amp;quot;
typeof(d)
# list

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œdata frameè¿™ç§ç±»å‹ï¼Œåœ¨å†…å­˜ä¸­ä½œä¸ºlistè¢«å­˜å‚¨ï¼Œä½†æ˜¯å®ƒä»¬è¢«åŒ…è£…æˆdata frameã€‚&lt;br /&gt;
å¯¹äºæŸä¸ªå‡½æ•°çš„å‚æ•°ï¼Œå®ƒçš„ç±»å‹æ˜¯data frameï¼Œå´ä¸èƒ½è¯´æ˜¯listã€‚&lt;/p&gt;

&lt;p&gt;å†æ¥çœ‹modeå’Œtypeofã€‚&lt;br /&gt;
modeå’Œtypeofé€šå¸¸è¿”å›åŒæ ·çš„å€¼ï¼Œä½†ä¹Ÿæœ‰ä¾‹å¤–ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;typeof(c(1,2))
# [1] &amp;quot;double&amp;quot;
mode(c(1,2))
# [1] &amp;quot;numeric&amp;quot;

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å†å²åŸå› å•¦ã€‚Rè¯­è¨€ç”±Sè¯­è¨€å‘å±•è€Œæ¥ã€‚&lt;br /&gt;
modeï¼Œä¸ºäº†å’ŒSè¯­è¨€å…¼å®¹ï¼Œè¿”å›Rçš„å¯¹è±¡çš„æ¨¡å¼ã€‚&lt;br /&gt;
typeofæ˜¯Rè¯­è¨€ç‰¹æœ‰çš„ï¼Œè¿”å›ä¸€ä¸ªRçš„å¯¹è±¡çš„ç±»å‹ã€‚ï¼ˆå“å‘€ï¼Œè§£é‡Šä¸æ¸…æ¥šå•¦ï¼‰&lt;/p&gt;

&lt;h3 id=&#34;å‚è€ƒ:4392bb40a36ba9fbdbf9a9669f2b4fbf&#34;&gt;å‚è€ƒ&lt;/h3&gt;

&lt;p&gt;1.&lt;a href=&#34;http://stackoverflow.com/questions/6258004/r-types-and-classes-of-variables&#34;&gt;http://stackoverflow.com/questions/6258004/r-types-and-classes-of-variables&lt;/a&gt;&lt;br /&gt;
2.&lt;a href=&#34;http://stats.stackexchange.com/questions/3212/mode-class-and-type-of-r-objects&#34;&gt;http://stats.stackexchange.com/questions/3212/mode-class-and-type-of-r-objects&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>